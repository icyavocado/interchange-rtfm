<!doctype html public "-//W30//DTD W3 HTML 2.0//EN">

<HTML>

<!-- This file was generated using SDF 2.001 by
     Ian Clatworthy (ianc@mincom.com). SDF is freely
     available from http://www.mincom.com/mtr/sdf. -->

<HEAD>
<TITLE>Interchange Tags Reference</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="docs.css">
</HEAD>
<BODY BGCOLOR="ffffff" LINK="993333">

<DIV CLASS="header">
<DIV CLASS="navigate">
<P ALIGN="Center"><A HREF="index.html" TARGET="_top">Documentation Index</A></P>
</DIV>
</DIV>
<DIV CLASS="title">
<P><IMG SRC="iclogo2002.gif" ALIGN="Right"></P>
<H1 CLASS="doc-title">Interchange Tags Reference</H1>
<ADDRESS CLASS="doc-author"></ADDRESS>
<BR CLEAR="All">
</DIV>
<DIV CLASS="contents">
<HR>
<H2>Table of Contents</H2>
<UL>
<A HREF="#Interchange Tag Reference">1. Interchange Tag Reference</A>
<BR>
<A HREF="#Tag Syntax">2. Tag Syntax</A><UL>
<A HREF="#Standard Syntax">2.1. Standard Syntax</A>
<BR>
<A HREF="#HTML-Comment">2.2. HTML-Comment</A>
<BR>
<A HREF="#parameters">2.3. Named vs. Positional Parameters</A>
<BR>
<A HREF="#attributes">2.4. Universal Attributes</A>
<BR>
<A HREF="#Tag-specific Attributes">2.5. Tag-specific Attributes</A>
<BR>
<A HREF="#attr_array_hash">2.6. Attribute Arrays and Hashes</A></UL>
<BR>
<A HREF="#Looping tags and Sub-tags">3. Looping tags and Sub-tags</A><UL>
<A HREF="#PREFIX-accessories">3.1. PREFIX-accessories</A>
<BR>
<A HREF="#PREFIX-alternate">3.2. PREFIX-alternate</A>
<BR>
<A HREF="#PREFIX-calc">3.3. PREFIX-calc</A>
<BR>
<A HREF="#PREFIX-change">3.4. PREFIX-change</A>
<BR>
<A HREF="#PREFIX-code">3.5. PREFIX-code</A>
<BR>
<A HREF="#PREFIX-data">3.6. PREFIX-data</A>
<BR>
<A HREF="#PREFIX-description">3.7. PREFIX-description</A>
<BR>
<A HREF="#PREFIX-discount">3.8. PREFIX-discount</A>
<BR>
<A HREF="#PREFIX-discount-subtotal">3.9. PREFIX-discount-subtotal</A>
<BR>
<A HREF="#PREFIX-field">3.10. PREFIX-field</A>
<BR>
<A HREF="#PREFIX-increment">3.11. PREFIX-increment</A>
<BR>
<A HREF="#PREFIX-last">3.12. PREFIX-last</A>
<BR>
<A HREF="#PREFIX-line">3.13. PREFIX-line</A>
<BR>
<A HREF="#PREFIX-modifier">3.14. PREFIX-modifier</A>
<BR>
<A HREF="#PREFIX-next">3.15. PREFIX-next</A>
<BR>
<A HREF="#PREFIX-param">3.16. PREFIX-param</A>
<BR>
<A HREF="#PREFIX-pos">3.17. PREFIX-pos</A>
<BR>
<A HREF="#PREFIX-price">3.18. PREFIX-price</A>
<BR>
<A HREF="#PREFIX-quantity">3.19. PREFIX-quantity</A>
<BR>
<A HREF="#PREFIX-subtotal">3.20. PREFIX-subtotal</A>
<BR>
<A HREF="#if-PREFIX-data">3.21. if-PREFIX-data</A>
<BR>
<A HREF="#if-PREFIX-field">3.22. if-PREFIX-field</A>
<BR>
<A HREF="#modifier-name">3.23. modifier-name</A>
<BR>
<A HREF="#quantity-name">3.24. quantity-name</A></UL>
<BR>
<A HREF="#Tags">4. Tags</A><UL>
<A HREF="#accessories">4.1. accessories</A>
<BR>
<A HREF="#and">4.2. and</A>
<BR>
<A HREF="#area">4.3. area</A>
<BR>
<A HREF="#assign">4.4. assign</A>
<BR>
<A HREF="#attr-list">4.5. attr-list</A>
<BR>
<A HREF="#banner">4.6. banner</A>
<BR>
<A HREF="#bounce">4.7. bounce</A>
<BR>
<A HREF="#calc">4.8. calc</A>
<BR>
<A HREF="#calcn">4.9. calcn</A>
<BR>
<A HREF="#cart">4.10. cart</A>
<BR>
<A HREF="#catch">4.11. catch</A>
<BR>
<A HREF="#cgi">4.12. cgi</A>
<BR>
<A HREF="#checked">4.13. checked</A>
<BR>
<A HREF="#control">4.14. control</A>
<BR>
<A HREF="#control_set">4.15. control_set</A>
<BR>
<A HREF="#counter">4.16. counter</A>
<BR>
<A HREF="#currency">4.17. currency</A>
<BR>
<A HREF="#data">4.18. data</A>
<BR>
<A HREF="#default">4.19. default</A>
<BR>
<A HREF="#description">4.20. description</A>
<BR>
<A HREF="#discount">4.21. discount</A>
<BR>
<A HREF="#dump">4.22. dump</A>
<BR>
<A HREF="#ecml">4.23. ecml</A>
<BR>
<A HREF="#either">4.24. either</A>
<BR>
<A HREF="#error">4.25. error</A>
<BR>
<A HREF="#export">4.26. export</A>
<BR>
<A HREF="#field">4.27. field</A>
<BR>
<A HREF="#file">4.28. file</A>
<BR>
<A HREF="#filter">4.29. filter</A>
<BR>
<A HREF="#flag">4.30. flag</A>
<BR>
<A HREF="#fly-list">4.31. fly-list</A>
<BR>
<A HREF="#fly-tax">4.32. fly-tax</A>
<BR>
<A HREF="#goto">4.33. goto</A>
<BR>
<A HREF="#handling">4.34. handling</A>
<BR>
<A HREF="#harness">4.35. harness</A>
<BR>
<A HREF="#href">4.36. href</A>
<BR>
<A HREF="#html-table">4.37. html-table</A>
<BR>
<A HREF="#if">4.38. if</A>
<BR>
<A HREF="#import">4.39. import</A>
<BR>
<A HREF="#include">4.40. include</A>
<BR>
<A HREF="#index">4.41. index</A>
<BR>
<A HREF="#item-list">4.42. item-list</A>
<BR>
<A HREF="#label">4.43. label</A>
<BR>
<A HREF="#log">4.44. log</A>
<BR>
<A HREF="#loop">4.45. loop</A>
<BR>
<A HREF="#mail">4.46. mail</A>
<BR>
<A HREF="#mvasp">4.47. mvasp</A>
<BR>
<A HREF="#nitems">4.48. nitems</A>
<BR>
<A HREF="#options">4.49. options</A>
<BR>
<A HREF="#or">4.50. or</A>
<BR>
<A HREF="#order">4.51. order</A>
<BR>
<A HREF="#page">4.52. page</A>
<BR>
<A HREF="#perl">4.53. perl</A>
<BR>
<A HREF="#price">4.54. price</A>
<BR>
<A HREF="#process">4.55. process</A>
<BR>
<A HREF="#process-search">4.56. process-search</A>
<BR>
<A HREF="#query">4.57. query</A>
<BR>
<A HREF="#read-cookie">4.58. read-cookie</A>
<BR>
<A HREF="#restrict">4.59. restrict</A>
<BR>
<A HREF="#row">4.60. row</A>
<BR>
<A HREF="#salestax">4.61. salestax</A>
<BR>
<A HREF="#scratch">4.62. scratch</A>
<BR>
<A HREF="#scratchd">4.63. scratchd</A>
<BR>
<A HREF="#search-list">4.64. search-list</A>
<BR>
<A HREF="#search-region">4.65. search-region</A>
<BR>
<A HREF="#selected">4.66. selected</A>
<BR>
<A HREF="#set">4.67. set</A>
<BR>
<A HREF="#set-cookie">4.68. set-cookie</A>
<BR>
<A HREF="#seti">4.69. seti</A>
<BR>
<A HREF="#setlocale">4.70. setlocale</A>
<BR>
<A HREF="#shipping">4.71. shipping</A>
<BR>
<A HREF="#shipping-desc">4.72. shipping-desc</A>
<BR>
<A HREF="#soap">4.73. soap</A>
<BR>
<A HREF="#strip">4.74. strip</A>
<BR>
<A HREF="#subtotal">4.75. subtotal</A>
<BR>
<A HREF="#tag">4.76. tag</A>
<BR>
<A HREF="#time">4.77. time</A>
<BR>
<A HREF="#timed-build">4.78. timed-build</A>
<BR>
<A HREF="#tmp">4.79. tmp</A>
<BR>
<A HREF="#tmpn">4.80. tmpn</A>
<BR>
<A HREF="#total-cost">4.81. total-cost</A>
<BR>
<A HREF="#tree">4.82. tree</A>
<BR>
<A HREF="#try">4.83. try</A>
<BR>
<A HREF="#update">4.84. update</A>
<BR>
<A HREF="#userdb">4.85. userdb</A>
<BR>
<A HREF="#value">4.86. value</A>
<BR>
<A HREF="#value-extended">4.87. value-extended</A></UL>
<BR>
<A HREF="#User-defined Tags">5. User-defined Tags</A><UL>
<A HREF="#Alias">5.1. Alias</A>
<BR>
<A HREF="#attrAlias">5.2. attrAlias</A>
<BR>
<A HREF="#CanNest">5.3. CanNest</A>
<BR>
<A HREF="#HasEndTag">5.4. HasEndTag</A>
<BR>
<A HREF="#Implicit">5.5. Implicit</A>
<BR>
<A HREF="#Interpolate">5.6. Interpolate</A>
<BR>
<A HREF="#InvalidateCache">5.7. InvalidateCache</A>
<BR>
<A HREF="#Order">5.8. Order</A>
<BR>
<A HREF="#PosRoutine">5.9. PosRoutine</A>
<BR>
<A HREF="#Routine">5.10. Routine</A></UL>
<BR>
<A HREF="#Standard Usertags">6. Standard Usertags</A><UL>
<A HREF="#bar_button">6.1. bar_button</A>
<BR>
<A HREF="#button">6.2. button</A>
<BR>
<A HREF="#convert_date">6.3. convert_date</A>
<BR>
<A HREF="#db_date">6.4. db_date</A>
<BR>
<A HREF="#delete_cart">6.5. delete_cart</A>
<BR>
<A HREF="#email">6.6. email</A>
<BR>
<A HREF="#email_raw">6.7. email_raw</A>
<BR>
<A HREF="#fedex_query">6.8. fedex_query</A>
<BR>
<A HREF="#formel">6.9. formel</A>
<BR>
<A HREF="#fortune">6.10. fortune</A>
<BR>
<A HREF="#get-url">6.11. get-url</A>
<BR>
<A HREF="#load_cart">6.12. load_cart</A>
<BR>
<A HREF="#loc">6.13. loc</A>
<BR>
<A HREF="#rand">6.14. rand</A>
<BR>
<A HREF="#reconfig">6.15. reconfig</A>
<BR>
<A HREF="#reconfig_time">6.16. reconfig_time</A>
<BR>
<A HREF="#reconfig_wait">6.17. reconfig_wait</A>
<BR>
<A HREF="#save_cart">6.18. save_cart</A>
<BR>
<A HREF="#summary">6.19. summary</A>
<BR>
<A HREF="#table_organize">6.20. table_organize</A>
<BR>
<A HREF="#title_bar">6.21. title_bar</A>
<BR>
<A HREF="#ups_query">6.22. ups_query</A>
<BR>
<A HREF="#usertrack">6.23. usertrack</A>
<BR>
<A HREF="#var">6.24. var</A>
<BR>
<A HREF="#xml-generator">6.25. xml-generator</A></UL>
<BR>
<A HREF="#Template Parsing Order">A. Template Parsing Order</A><UL>
<A HREF="#Standard Parsing">A.1. Standard Parsing</A>
<BR>
<A HREF="#Nonstandard parsing within the admin interface">A.2. Nonstandard parsing within the admin interface</A>
<BR>
<A HREF="#Nonstandard parsing of Subtags">A.3. Nonstandard parsing of Subtags</A></UL>
<BR>
<A HREF="#Search and Form Variables">B. Search and Form Variables</A><UL>
<A HREF="#Variable Names">B.1. Variable Names</A>
<BR>
<A HREF="#Abbreviations">B.2. Abbreviations</A></UL></UL>
</DIV>
<DIV CLASS="main">
<HR>
<H1><A NAME="Interchange Tag Reference">1. Interchange Tag Reference</A></H1>
<P>Interchange functions are accessed via the Interchange Tag Language (ITL). The pages in a catalog may be mostly HTML, but they will use ITL tags to provide access to Interchange's functions. ITL is a superset of MML, or Minivend Markup Language. Minivend was the predecessor to Interchange.</P>
<P>These tags perform various display and modification operations for the user session. There nearly 100 standard predefined tags, and the <TT>UserTag</TT> facility allows you to create tags that perform your own functions and can be just as powerful as the built-in tags.</P>
<P>This document covers Interchange versions 4.7 through 4.9.</P>
<HR>
<H1><A NAME="Tag Syntax">2. Tag Syntax</A></H1>
<P>ITL tags are similar to HTML in syntax, in that they accept parameters or attributes and that there are both <I>standalone</I> and <I>container</I> tags.</P>
<P>We will call an attribute a <I>parameter</I> if it may be called positionally or if it must be included (see the <A HREF="#parameters">parameter</A> and <A HREF="#attributes">attribute</A> sections below).</P>
<P>A standalone tag has no ending element, e.g.:</P>
<PRE>
    [<A HREF="#value">value name</A>]
</PRE>
<P>This tag will insert the user's name, providing they have given it to you in a form. A container tag has both a beginning and an ending element, as in:</P>
<PRE>
    [<A HREF="#if">if</A> value name]
    You have a name. It is [<TT>value</TT> name].
    [/if]
</PRE>
<H2><A NAME="Standard Syntax">2.1. Standard Syntax</A></H2>
<P>The most common syntax is to enclose the tag with its parameters and attributes in <TT>[square brackets]</TT>. If the tag has an end tag, the tag and its end tag will delimit contained body text:</P>
<PRE>
  [<B>tagname</B> <I>parameters</I> <I>attributes</I>]Contained Body Text[/tagname]
</PRE>
<P><HR WIDTH="80%" ALIGN="Left">
<STRONG>Caveat&nbsp;-- macros: </STRONG>Some macros look like tags or end tags. For example, [<A HREF="#page">/page</A>] is a macro for &lt;/A&gt;. This allows you to conveniently write [<A HREF="#page">page</A>&nbsp;<I>href</I>]Target[<TT>/page</TT>], but 'Target' is not treated as contained body text.</P>
<P><HR WIDTH="80%" ALIGN="Left"></P>
<P>When using the [<TT>tagname</TT> ...] syntax, there must be no whitespace between the left bracket ('[') and the tagname.</P>
<P>If a tag name includes an underscore or dash, as in [<A HREF="#item-list">item_list</A>], a dash is just as appropriate (i.e. <TT>[item-list]</TT>). The two forms are interchangeable, except that an ending tag must match the tag (i.e., don't use <TT>[item-list]&nbsp;list&nbsp;[/item_list]</TT>).</P>
<H2><A NAME="HTML-Comment">2.2. HTML-Comment</A></H2>
<P>ITL also allows you to use '&lt;!--[' and ']--&gt;' as interchangeable alternatives to plain square brackets: <TT>[tagname]</TT> and <TT>&lt;!--[tagname]--&gt;</TT> are equivalent.</P>
<P>This allows you make your raw tags appear as comments to HTML browsers or editors. You might want to do this if your editor has trouble with ITL tags when editing Interchange page templates, or alternatively, if you want to use one .html file both as an Interchange template and as a static page delivered directly by your web server, without Interchange processing.</P>
<P>To properly HTML-comment contained body text, place your comment-style brackets appropriately, for example:</P>
<PRE>
 &lt;!--[tagname] Contained Body Text [/tagname]--&gt;
</PRE>
<P>Note that you must include whitespace between the HTML comment delimiters and the square brackets if you wish to actually comment out tag output in the browser. For example, if [<A HREF="#value">value</A>&nbsp;name] expands to 'Bill':</P>
<PRE>
 '&lt;!--[value name]--&gt;'  becomes  'Bill'
 '&lt;!-- [value name] --&gt;'  becomes  '&lt;!-- Bill --&gt;'
</PRE>
<H3><A NAME="Technical notes">2.2.1. Technical notes</A></H3>
<P>While '&lt;!--[' and '[' are completely interchangeable, the Interchange parser does not replace ']--&gt;' with ']' unless it also sees '&lt;!--[' at least once somewhere on the page. (This is a small parsing speed optimization.)</P>
<P>See the <A HREF="#Template Parsing Order">Template Parsing Order</A> appendix if you are modifying the special administrative interface pages and intend to use this syntax.</P>
<H2><A NAME="parameters"> </A>2.3. <A NAME="parameters">Named vs. Positional Parameters</A></H2>
<P>There are two styles of supplying parameters to a tag: named and positional.</P>
<P>In the named style you supply a parameter name=value pair just as most HTML tags use:</P>
<PRE>
    [<A HREF="#value">value</A> name=&quot;foo&quot;]
</PRE>
<P>The positional-style tag that accomplishes the same thing looks like this:</P>
<PRE>
    [value foo]
</PRE>
<P>The parameter <TT>name</TT> is the first positional parameter for the <TT>[<A HREF="#value">value</A>]</TT> tag. Some people find positional usage simpler for common tags, and Interchange interprets them somewhat faster. If you wish to avoid ambiguity you can always use named calling.</P>
<P>In most cases, tag parameters specified in the positional fashion work the same as named parameters. However, there are a few situations where you need to use named parameters:</P>
<OL>
<LI>If you want to specify a parameter that comes positionally after a parameter that you want to omit, e.g. omit the first parameter but specify the second. The parser would have no way of knowing which is which, so you just specify the second by name. This is rare, though, because the first positional parameters are usually required for a given tag anyway.
<LI>When there is some ambiguity as to which parameter is which, usually due to whitespace.
<LI>When you need to use the output of a tag as the parameter or attribute for another tag.</OL>
<H3><A NAME="Interpolating parameters">2.3.1. Interpolating parameters</A></H3>
<P>If you wish to use the value of a tag within a parameter of another tag, you cannot use a positional call. You must also double-quote the argument containing the tag you wish to have expanded. For example, this will not work:</P>
<PRE>
    [<A HREF="#page">page</A> scan se=[<A HREF="#scratch">scratch</A> somevar]]
</PRE>
<P>To get the output of the <TT>[scratch somevar]</TT> interpreted, you must place it within a named and quoted attribute:</P>
<PRE>
    [<A HREF="#page">page</A> href=scan arg=&quot;se=[<A HREF="#scratch">scratch</A> somevar]&quot;]
</PRE>
<P>Note that the argument to <B>href</B> ('scan') did not need to be quoted; only the argument to <B>arg</B>, which contained a tag, needed the quotes.</P>
<H2><A NAME="attributes"> </A>2.4. <A NAME="attributes">Universal Attributes</A></H2>
<P>Universal attributes apply to all tags, though each tag specifies its own default for the attribute. The code implementing universal attributes is external to the core routines that implement specific tags.</P>
<H3><A NAME="attr_interpolate"> </A>2.4.1. <A NAME="attr_interpolate">interpolate</A></H3>
<P>This attribute behaves differently depending upon whether the tag is a <I>container</I> or <I>standalone</I> tag. A container tag is one which has an end tag, i.e. <TT>[tag] stuff [/tag]</TT>. A standalone tag has no end tag, as in [<A HREF="#area">area</A>&nbsp;href=somepage]. (Note that [<A HREF="#page">page</A> ...] and [<A HREF="#order">order</A> ..] are <B>not</B> container tags.)</P>
<P><I>For container tags (interpolated)</I></P>
<UL>
<LI>If true (&quot;interpolate=1&quot;), the Interchange server will first process any tags within the body text before passing it to the enclosing tag.
<LI>If false (&quot;interpolate=0&quot;), the enclosing tag will receive the raw body text.</UL>
<P><I>For standalone tags (reparsed)</I></P>
<UL>
<LI>If true, the server will process the <I>output</I> of the tag. This is identical to the behavior of the <A HREF="#attr_reparse">reparse</A> attribute (see below for explanation and examples).</UL>
<P>(Note: The mixing of 'interpolate' and 'reparse' logic occurred because 'interpolate' already worked this way when 'reparse' was added to Interchange. This may be fixed in a later release...)</P>
<P>Most standalone tags are not reparsed by default (i.e., interpolate=0 by default). There are some exceptions, such as the [<A HREF="#include">include</A>] tag.</P>
<P>Interpolation example:</P>
<P>Assuming that <TT>name</TT> is 'Kilroy',</P>
<PRE>
   [<A HREF="#log">log</A> interpolate=1][<A HREF="#value">value</A><TT> name</TT>] was here[/log]
   [<A HREF="#log">log</A> interpolate=0][<A HREF="#value">value</A><TT> name</TT>] was here[/log]
</PRE>
<P>the first line logs 'Kilroy was here' to <I>catalog_root</I>/etc/log, while the second logs '[value&nbsp;name] was here'.</P>
<P>Reparsing example:</P>
<P>Suppose we set a scratch variable called 'now' as follows:</P>
<PRE>
   [<A HREF="#set">set</A> name=now interpolate=0][<A HREF="#time">time</A>]%A, %B %d, %Y[/time][/set]
</PRE>
<P>If today is Monday, January 1, 2001,</P>
<PRE>
   [<A HREF="#scratch">scratch</A> name=now interpolate=0]
   [<A HREF="#scratch">scratch</A> name=now interpolate=1]
</PRE>
<P>the first line yields</P>
<PRE>
   [<A HREF="#time">time</A>]%A, %B %d, %Y[/time]
</PRE>
<P>while the second yields</P>
<PRE>
   Monday, January 1, 2001
</PRE>
<H3><A NAME="attr_reparse"> </A>2.4.2. <A NAME="attr_reparse">reparse</A></H3>
<P>If true (&quot;reparse=1&quot;), the server will process any tags in the text output by the reparsed tag.</P>
<P>Reparse applies only to container tags (those with an end tag). The <TT>interpolate</TT> attribute controls reparsing of the output of standalone tags (see above).</P>
<P>Most container tags will have their output re-parsed for more Interchange tags by default. If you wish to inhibit this behavior, you must explicitly set the attribute <B>reparse</B> to 0. Note that you will almost always want the default action. The only container ITL tag that doesn't have reparse set by default is <TT>[<A HREF="#mvasp">mvasp</A>]</TT>.</P>
<P>Example:</P>
<P>Assuming that <TT>name</TT> is 'Kilroy',</P>
<PRE>
  1.   [<A HREF="#perl">perl</A> reparse=0]
          my $tagname = 'value';
          return &quot;[$tagname name] was here\n&quot;
       [/perl]

  2.   [<A HREF="#perl">perl</A> reparse=1]
          my $tagname = 'value';
          return &quot;[$tagname name] was here\n&quot;
       [/perl]
</PRE>
<P>expands to</P>
<PRE>
  1.   [<A HREF="#value">value</A><TT> name</TT>] was here

  2.   Kilroy was here
</PRE>
<H3><A NAME="attr_send"> </A>2.4.3. <A NAME="attr_send">send</A></H3>
<P>Deprecated</P>
<H2><A NAME="Tag-specific Attributes">2.5. Tag-specific Attributes</A></H2>
<P>Each tag may accept additional named attributes which vary from tag to tag. Please see the entry for the tag in question for details about tag-specific attributes.</P>
<H2><A NAME="attr_array_hash"> </A>2.6. <A NAME="attr_array_hash">Attribute Arrays and Hashes</A></H2>
<P>Some tags allow you to pass an array or hash as the value of an attribute. For an ordinary tag, the syntax is as follows:</P>
<PRE>
    attribute.<I>n</I>=value

    attribute.hashkey=value
</PRE>
<P>where <I>n</I> is an integer array index. Note that you cannot use both an array and a hash with the same attribute&nbsp;-- if you use <B>attribute.<I>n</I></B>, you cannot also use <B>attribute.key</B> for the same attribute.</P>
<P>Here is an example of an attribute array:</P>
<PRE>
    search.0=&quot;se=hammer
              fi=products
              sf=description&quot;
    search.1=&quot;se=plutonium
              fi=products
              sf=comment&quot;
</PRE>
<P>The [<A HREF="#page">page</A>] tag, for example, treats a search specification array as a joined search, automatically adding the other relevant search fields, including the 'co=yes' to indicate a combined search (<A HREF="icdatabase.html#Coordinated and Joined Searching">joined searches</A> are described in the Interchange database documentation).</P>
<P>Note that it is up to the tag to handle an array or hash value properly. See the documentation for the specific tag before passing it an attribute array or hash value.</P>
<H3><A NAME="Perl calls">2.6.1. Perl calls</A></H3>
<P>Before passing attributes to a tag, the Interchange parser would convert the above example to an anonymous array reference. It would use the resulting arrayref as the value for the 'search' attribute in this example.</P>
<P>If you were passing the above example directly to a tag routine within a [<A HREF="#perl">perl</A>] block or a <A HREF="#User-defined Tags">usertag</A>, you must actually pass an anonymous array as the value of the attribute as follows:</P>
<PRE>
    my $arrayref = [ &quot;se=hammer/fi=products/sf=description&quot;,
                     &quot;se=plutonium/fi=products/sf=description&quot;, ];

    $Tag-&gt;<I>routine</I>( { search =&gt; $arrayref, } );
</PRE>
<P>Similarly to use a hash reference for the 'entry' attribute:</P>
<PRE>
    my $hashref = { name   =&gt; &quot;required&quot;,
                    date   =&gt; 'default=&quot;%B %d, %Y&quot;', };

    $Tag-&gt;<I>routine</I>( { entry =&gt; $hashref } );
</PRE>
<HR>
<H1><A NAME="Looping tags and Sub-tags">3. Looping tags and Sub-tags</A></H1>
<P><A NAME="subtags"></A>Certain tags are not standalone; these are the ones that are interpreted as part of a surrounding looping tag like [<A HREF="#loop">loop</A>], [<A HREF="#item-list">item-list</A>], [<A HREF="#query">query</A>], or [<A HREF="#search-region">search-region</A>].</P>
<UL>
[<A HREF="#PREFIX-accessories">PREFIX-accessories</A>]
<BR>
[<A HREF="#PREFIX-alternate">PREFIX-alternate</A>]
<BR>
[<A HREF="#PREFIX-calc">PREFIX-calc</A>]
<BR>
[<A HREF="#PREFIX-change">PREFIX-change</A>]
<BR>
[<A HREF="#PREFIX-code">PREFIX-code</A>]
<BR>
[<A HREF="#PREFIX-data">PREFIX-data</A>]
<BR>
[<A HREF="#PREFIX-description">PREFIX-description</A>] (Note <TT>safe-data</TT> and <TT>ed()</TT> escape)
<BR>
[<A HREF="#PREFIX-discount">PREFIX-discount</A>]
<BR>
[<A HREF="#PREFIX-discount-subtotal">PREFIX-discount-subtotal</A>]
<BR>
<TT>[if-PREFIX-exec]</TT>
<BR>
[<A HREF="#PREFIX-field">PREFIX-field</A>] (Optimization note-- one query per field if you use this; we optimize around this if only one products table)
<BR>
<TT>[if-PREFIX-filter]</TT>
<BR>
[<A HREF="#PREFIX-increment">PREFIX-increment</A>]
<BR>
[<A HREF="#PREFIX-last">PREFIX-last</A>]
<BR>
[<A HREF="#PREFIX-line">PREFIX-line</A>] (tab-delimited list of parameters returned)
<BR>
<TT>[if-PREFIX-match]</TT>
<BR>
[<A HREF="#PREFIX-modifier">PREFIX-modifier</A>]
<BR>
[<A HREF="#PREFIX-next">PREFIX-next</A>]
<BR>
<TT>[if-PREFIX-options]</TT>
<BR>
[<A HREF="#PREFIX-param">PREFIX-param</A>]
<BR>
[<A HREF="#PREFIX-pos">PREFIX-pos</A>]
<BR>
[<A HREF="#PREFIX-price">PREFIX-price</A>]
<BR>
[<A HREF="#PREFIX-quantity">PREFIX-quantity</A>]
<BR>
<TT>[if-PREFIX-sub]</TT>
<BR>
[<A HREF="#PREFIX-subtotal">PREFIX-subtotal</A>]
<BR>
[<A HREF="#if-PREFIX-data">if-PREFIX-data</A>]
<BR>
[<A HREF="#if-PREFIX-field">if-PREFIX-field</A>]
<BR>
<TT>[if-PREFIX-modifier]</TT> (hash list only)
<BR>
<TT>[if-PREFIX-param]</TT>
<BR>
<TT>[if-PREFIX-pos]</TT>
<BR>
[<A HREF="#modifier-name">modifier-name</A>]
<BR>
[<A HREF="#quantity-name">quantity-name</A>]</UL>
<P>PREFIX represents the prefix that is used in that looping tag. They are only interpreted within their container and only accept positional parameters. The default prefixes:</P>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD>
<STRONG>Tag</STRONG>
</TD>
<TD>
<STRONG>Prefix</STRONG>
</TD>
<TD>
<STRONG>Examples</STRONG>
</TD>
</TR>
<TR>
<TD>
[<A HREF="#loop">loop</A>]
</TD>
<TD>
loop
</TD>
<TD>
[loop-code], [loop-field price], [loop-increment]
</TD>
</TR>
<TR>
<TD>
[<A HREF="#item-list">item-list</A>]
</TD>
<TD>
item
</TD>
<TD>
[item-code], [item-field price], [item-increment]
</TD>
</TR>
<TR>
<TD>
[<A HREF="#search-list">search-list</A>]
</TD>
<TD>
item
</TD>
<TD>
[item-code], [item-field price], [item-increment]
</TD>
</TR>
<TR>
<TD>
[<A HREF="#query">query</A>]
</TD>
<TD>
sql
</TD>
<TD>
[sql-code], [sql-field price], [sql-increment]
</TD>
</TR>
</TABLE>

<P>Sub-tag behavior is consistent among the looping tags. Subtags are parsed during evaluation of the enclosing loop, <I>before</I> any regular tags within the loop.</P>
<P>There are two types of looping lists: ARRAY and HASH.</P>
<P>An array list is the normal output of a [<A HREF="#query">query</A>], a search, or a [<A HREF="#loop">loop</A>] tag. It returns from 1 to N <TT>return fields</TT>, defined in the <TT>mv_return_fields</TT> or <TT>rf</TT> variable or implicitly by means of a SQL field list. The two queries below are essentially identical:</P>
<PRE>
    [query sql=&quot;select foo, bar from products&quot;]
    [/query]

    [loop search=&quot;
                    ra=yes
                    fi=products
                    rf=foo,bar
    &quot;]
</PRE>
<P>Both will return an array of arrays consisting of the <TT>foo</TT> column and the <TT>bar</TT> column. The Perl data structure would look like:</P>
<PRE>
    [
        ['foo0', 'bar0'],
        ['foo1', 'bar1'],
        ['foo2', 'bar2'],
        ['fooN', 'barN'],
    ]
</PRE>
<P>A hash list is the normal output of the [item-list] tag. It returns the value of all return fields in an array of hashes. A normal [item-list] return might look like:</P>
<PRE>
    [
        {
            code     =&gt; '99-102',
            quantity =&gt; 1,
            size     =&gt; 'XL',
            color    =&gt; 'blue',
            mv_ib    =&gt; 'products',
        },
        {
            code     =&gt; '00-341',
            quantity =&gt; 2,
            size     =&gt; undef,
            color    =&gt; undef,
            mv_ib    =&gt; 'products',
        },

    ]
</PRE>
<P>You can also return hash lists in queries:</P>
<PRE>
    [query sql=&quot;select foo, bar from products&quot; type=hashref]
    [/query]
</PRE>
<P>Now the data structure will look like:</P>
<PRE>
    [
        { foo =&gt; 'foo0', bar =&gt; 'bar0' },
        { foo =&gt; 'foo1', bar =&gt; 'bar1' },
        { foo =&gt; 'foo2', bar =&gt; 'bar2' },
        { foo =&gt; 'fooN', bar =&gt; 'barN' },
    ]
</PRE>
<H2><A NAME="PREFIX-accessories">3.1. PREFIX-accessories</A></H2>
<PRE>
   [PREFIX-accessories arglist]
</PRE>
<P>Except for the usual differences that apply to all subtags (such as parsing order), these are more or less equivalent for an array-type list:</P>
<PRE>
    [accessories code=<I>current_item_code</I> arg=<I>arglist</I>]
    [item-accessories <I>arglist</I>]
</PRE>
<P>See the [<A HREF="#accessories">accessories</A>] tag for more detail. Note that you must use the comma-delimited list to set attributes&nbsp;-- you cannot set named attributes with the usual 'attribute=value' syntax.</P>
<P>If the list is a hash list, i.e. an [<A HREF="#item-list">item-list</A>], then the value of the current item hash is passed so that a value default can be established.</P>
<H2><A NAME="PREFIX-alternate">3.2. PREFIX-alternate</A></H2>
<PRE>
   [PREFIX-alternate N] DIVISIBLE [else] NOT DIVISIBLE [/else][/PREFIX-alternate]
</PRE>
<P>Set up an alternation sequence. If the item-increment is divisible by `N', the text will be displayed. If an `[else]NOT DIVISIBLE TEXT[/else]' is present, then the NOT DIVISIBLE TEXT will be displayed.</P>
<P>For example:</P>
<PRE>
    [item-alternate 2]EVEN[else]ODD[/else][/item-alternate]
    [item-alternate 3]BY 3[else]NOT by 3[/else][/item-alternate]
</PRE>
<H2><A NAME="PREFIX-calc">3.3. PREFIX-calc</A></H2>
<PRE>
   [PREFIX-calc] 2 + [item-field price] [/PREFIX-calc]
</PRE>
<P>Executes Perl code in the tag body. This is equivalent to the [<A HREF="#calc">calc</A>] ... [/calc] tag pair, except it's calculated at loop time instead of later when the rest of the page is parsed.</P>
<H2><A NAME="PREFIX-change">3.4. PREFIX-change</A></H2>
<PRE>
   [PREFIX-change][condition] ... [/condition] TEXT [/PREFIX-change]
</PRE>
<P>Sets up a breaking sequence that occurs when the contents of [condition] [/condition] change. The most common one is a category break to nest or place headers.</P>
<P>The region is only output when a field or other repeating value between [condition] and [/condition] changes its value. This allows indented lists similar to database reports to be easily formatted. The repeating value must be a tag interpolated in the search process, such as [<A HREF="#PREFIX-field">PREFIX-field</A>] or [<A HREF="#PREFIX-field">PREFIX-field</A><TT> database field</TT>]. If you need access to ITL tags, you can use [<A HREF="#PREFIX-calc">PREFIX-calc</A>] with a <TT>$Tag-</TT>foo()&gt; call.</P>
<P>Of course, this will only work as you expect when the search results are properly sorted.</P>
<P>The value to be tested is contained within a <TT>[condition]value[/condition]</TT> tag pair. The [<TT>PREFIX-change</TT>] tag also processes an <TT>[else] [/else]</TT> pair for output when the value does not change.</P>
<P>Here is a simple example for a search list that has a field <TT>category</TT> and <TT>subcategory</TT> associated with each item:</P>
<PRE>
 &lt;TABLE&gt;
 &lt;TR&gt;&lt;TH&gt;Category&lt;/TH&gt;&lt;TH&gt;Subcategory&lt;/TH&gt;&lt;TH&gt;Product&lt;/TH&gt;&lt;/TR&gt;
 [search-list]
 &lt;TR&gt;
    &lt;TD&gt;
         [item-change cat]

         [condition][item-field category][/condition]

                 [item-field category]
         [else]
                 &amp;nbsp;
         [/else]
         [/item-change cat]
    &lt;/TD&gt;
    &lt;TD&gt;
         [item-change sub]

         [condition][item-field subcategory][/condition]

                 [item-field subcategory]
         [else]
                 &amp;nbsp;
         [/else]
         [/item-change sub]
    &lt;/TD&gt;
    &lt;TD&gt; [item-field name] &lt;/TD&gt;
 [/search-list]
 &lt;/TABLE&gt;
</PRE>
<P>The above should put out a table that only shows the category and subcategory once, while showing the name for every product. (The <TT>&amp;nbsp;</TT> will prevent blanked table cells if you use a border.)</P>
<H2><A NAME="PREFIX-code">3.5. PREFIX-code</A></H2>
<PRE>
   [PREFIX-code]
</PRE>
<P>The key or code of the current loop. In an [<A HREF="#item-list">item-list</A>] this is always the product code; in a loop list it is the value of the current argument; in a search it is whatever you have defined as the first <TT>mv_return_field</TT> (<TT>rf</TT>).</P>
<H2><A NAME="PREFIX-data">3.6. PREFIX-data</A></H2>
<PRE>
   [PREFIX-data table field]
</PRE>
<P>Calls the column <TT>field</TT> in database table <TT>table</TT> for the current [<A HREF="#PREFIX-code">PREFIX-code</A>] This may or may not be equivalent to [<A HREF="#PREFIX-field">PREFIX-field</A> field] depending upon whether your search table is defined as one of the <A HREF="icconfig.html#ProductFiles">ProductFiles</A>.</P>
<H2><A NAME="PREFIX-description">3.7. PREFIX-description</A></H2>
<PRE>
   [PREFIX-description]
</PRE>
<P>The description of the current item, as defined in the <TT>catalog.cfg</TT> directive <TT>DescriptionField</TT>. In the demo, it would be the value of the field <TT>description</TT> in the table <TT>products</TT>.</P>
<P>If the list is a hash list, and the lookup of <TT>DescriptionField</TT> fails, then the attribute <TT>description</TT> will be substituted. This is useful to supply shopping cart descriptions for on-the-fly items.</P>
<H2><A NAME="PREFIX-discount">3.8. PREFIX-discount</A></H2>
<PRE>
   [PREFIX-discount]
</PRE>
<P>The price of the current item is calculated, and the difference between that price and the list price (quantity one) price is output. This may have different behavior than you expect if you set the [<A HREF="#discount">discount</A>] tag along with quantity pricing.</P>
<H2><A NAME="PREFIX-discount-subtotal">3.9. PREFIX-discount-subtotal</A></H2>
<PRE>
   [PREFIX-discount-subtotal]
</PRE>
<P>Inserts the discounted subtotal of the ordered items.</P>
<H2><A NAME="PREFIX-field">3.10. PREFIX-field</A></H2>
<PRE>
   [PREFIX-field]
</PRE>
<P>Looks up a field value for the current item in one of several places, in this order:</P>
<PRE>
    1. The first ProductFiles entry.
    2. Additional ProductFiles in the order they occur.
    3. The attribute value for the item in a hash list.
    4. Blank
</PRE>
<P>A common user error is to do this:</P>
<PRE>
    [loop search=&quot;
                    fi=foo
                    se=bar
                &quot;]

    [loop-field foo_field]
    [/loop]
</PRE>
<P>In this case, you are searching the table <TT>foo</TT> for a string of <TT>bar</TT>. When it is found, you wish to display the value of <TT>foo_field</TT>. Unless <TT>foo</TT> is in <A HREF="icconfig.html#ProductFiles">ProductFiles</A> and the code is not present in a previous product file, you will get a blank or some value you don't want. What you really want is [<A HREF="#PREFIX-data">loop-data</A><TT> foo field</TT>], which specifically addresses the table <TT>foo</TT>. See also [<A HREF="#PREFIX-param">PREFIX-param</A>] and [<A HREF="#PREFIX-pos">PREFIX-pos</A>].</P>
<H2><A NAME="PREFIX-increment">3.11. PREFIX-increment</A></H2>
<PRE>
   [PREFIX-increment]
</PRE>
<P>The current count on the list, starting from either 1 in a zero-anchored list like [<A HREF="#loop">loop</A>] or [<A HREF="#item-list">item-list</A>], or from the match count in a search list.</P>
<P>If you skip items with [<A HREF="#PREFIX-last">PREFIX-last</A>] or [<A HREF="#PREFIX-next">PREFIX-next</A>], the count is NOT adjusted.</P>
<H2><A NAME="PREFIX-last">3.12. PREFIX-last</A></H2>
<PRE>
   [PREFIX-last] CONDITION [/PREFIX-last]
</PRE>
<P>If CONDITION evaluates true (a non-whitespace value that is not specifically zero) then this will be the last item displayed.</P>
<H2><A NAME="PREFIX-line">3.13. PREFIX-line</A></H2>
<PRE>
   [PREFIX-line start_column]
</PRE>
<P>Returns all array values from the current looping row in a single string, with each value separated by a tab, roughly equivalent to this:</P>
<PRE>
  [PREFIX-pos 0](tab)[PREFIX-pos 1](tab)[PREFIX-pos 2](tab)[...]
</PRE>
<P>for however many fields were returned in that row.</P>
<P>This is useful as a quick way to see all your results at a glance and verify your search specification.</P>
<P>If the optional <TT>start_column</TT> attribute is given, the output starts with that column instead of column 0.</P>
<H2><A NAME="PREFIX-modifier">3.14. PREFIX-modifier</A></H2>
<PRE>
   [PREFIX-modifier attribute]
</PRE>
<P>If the item is a hash list (i.e. [<A HREF="#item-list">item-list</A>]), this will return the value of the <TT>attribute</TT>.</P>
<H2><A NAME="PREFIX-next">3.15. PREFIX-next</A></H2>
<PRE>
   [PREFIX-next] CONDITION [/PREFIX-next]
</PRE>
<P>If CONDITION evaluates true (a non-whitespace value that is not specifically zero) then this item is skipped.</P>
<H2><A NAME="PREFIX-param">3.16. PREFIX-param</A></H2>
<PRE>
   [PREFIX-param name]
</PRE>
<P>Returns the value of the column name associated with the looping tag row. Each looping list returns an array of <TT>return fields</TT>, set in searches with <TT>mv_return_field</TT> or <TT>rf</TT>. The default is only to return the code of the search result, but by setting those parameters you can return whichever columns you wish.</P>
<P>In a [<A HREF="#query">query</A>] ITL tag you can select multiple return fields with something like:</P>
<PRE>
    [query prefix=prefix sql=&quot;select foo, bar from baz where foo='buz'&quot;]
        [prefix-code]  [prefix-param foo]  [prefix-param bar]
    [/query]
</PRE>
<P>In this case, [<A HREF="#PREFIX-code">prefix-code</A>] and [prefix-param foo] are synonyms, as <TT>foo</TT> is the first returned parameter and becomes the code for this row. Another synonym is [<A HREF="#PREFIX-pos">prefix-pos</A> 0].</P>
<P>Note that the following code is invalid:</P>
<PRE>
    [query prefix=prefix sql=|
        SELECT  table1.foo,
                table2.bar
        FROM    table1, table2
        WHERE   table1.code = table2.code
        AND     table1.foo = 'buz'
    |]
        [prefix-param table1.foo] [prefix-param table2.bar]
    [/query]
</PRE>
<P>The problem with the above code is that DBI doesn't support column names such as <TT>table1.foo</TT> in its resultsets.  The following query syntax is fully supported by DBI and therefore by Interchange:</P>
<PRE>
    [query prefix=prefix sql=|
        SELECT  table1.foo AS foo,
                table2.bar AS bar
        FROM    table1, table2
        WHERE   table1.code = table2.code
        AND     table1.foo = 'buz'
    |]
        [prefix-param foo] [prefix-param bar]
    [/query]
</PRE>
<H2><A NAME="PREFIX-pos">3.17. PREFIX-pos</A></H2>
<PRE>
   [PREFIX-pos N]
</PRE>
<P>Returns the value of the array parameter associated with the looping tag row. Each looping list returns an array of <TT>return fields</TT>, set in searches with <TT>mv_return_field</TT> or <TT>rf</TT>. The default is only to return the code of the search result, but by setting those parameters you can return whichever columns you wish.</P>
<P>[PREFIX-pos N] outputs the data from the <I>N</I>th column as returned (starting with zero). [<A HREF="#PREFIX-param">PREFIX-param</A>] lets you access the data by column name instead of by number.</P>
<P>In a [query ...] ITL tag you can select multiple return fields with something like:</P>
<PRE>
    [query prefix=prefix sql=&quot;select foo, bar from baz where foo='buz'&quot;]
        [prefix-code]  [prefix-param foo]  [prefix-param bar]
    [/query]
</PRE>
<P>In this case, [<A HREF="#PREFIX-code">prefix-code</A>] and [<A HREF="#PREFIX-param">prefix-param</A> foo] are synonyms, as <TT>foo</TT> is the first returned parameter and becomes the code for this row. Another synonym is [prefix-pos 0].  [prefix-pos 1] is the same as [<A HREF="#PREFIX-param">prefix-param</A> bar].  The following code will produce exactly the same output as the above:</P>
<PRE>
    [query prefix=prefix sql=&quot;select foo, bar from baz where foo='buz'&quot;]
        [prefix-pos 0]  [prefix-pos 0]  [prefix-pos 1]
    [/query]
</PRE>
<P>Note that if you use the [PREFIX-pos] tag, you may have to review your column numbers whenever you modify the columns you select.  For this reason, queries that make use of the [<A HREF="#PREFIX-param">PREFIX-param</A>] tag may be easier to maintain and will be less prone to future surprises.</P>
<H2><A NAME="PREFIX-price">3.18. PREFIX-price</A></H2>
<PRE>
   [PREFIX-price]
</PRE>
<P>The price of the product identified by the current code, formatted for currency. If Interchange's pricing routines cannot determine the price (i.e. it is not a valid product or on-the-fly item) then zero is returned. If the list is a hash list, the price will be modified by its <TT>quantity</TT> or other applicable attributes (like <TT>size</TT> in the demo).</P>
<H2><A NAME="PREFIX-quantity">3.19. PREFIX-quantity</A></H2>
<PRE>
   [PREFIX-quantity]
</PRE>
<P>The value of the <TT>quantity</TT> attribute in a hash list. Most commonly used to display the quantity of an item in a shopping cart [<A HREF="#item-list">item-list</A>].</P>
<H2><A NAME="PREFIX-subtotal">3.20. PREFIX-subtotal</A></H2>
<PRE>
   [PREFIX-subtotal]
</PRE>
<P>The [<A HREF="#PREFIX-quantity">PREFIX-quantity</A>] times the [<A HREF="#PREFIX-price">PREFIX-price</A>]. This does take discounts into account.</P>
<H2><A NAME="if-PREFIX-data">3.21. if-PREFIX-data</A></H2>
<PRE>
   [if-PREFIX-data table field] IF text [else] ELSE text [/else] [/if-PREFIX-data]
</PRE>
<P>Examines the data field, i.e. [PREFIX-data table field], and if it is non-blank and non-zero then the <TT>IF text</TT> will be returned. If it is false, i.e. blank or zero, the <TT>ELSE text</TT> will be returned to the page.</P>
<P>This is much more efficient than the otherwise equivalent [<A HREF="#if">if</A> <TT>type=data term=table::field::</TT>[<A HREF="#PREFIX-code">PREFIX-code</A>]].</P>
<P>You cannot place a condition; i.e. <TT>[if-PREFIX-data table field eq 'something']</TT>. Use [<A HREF="#if">if</A><TT> type=data</TT> ...] for that.</P>
<P>Careful, a space is not a false value!</P>
<H2><A NAME="if-PREFIX-field">3.22. if-PREFIX-field</A></H2>
<PRE>
   [if-PREFIX-field field] IF text [else] ELSE text [/else] [/if-PREFIX-field]
</PRE>
<P>Same as [<A HREF="#if-PREFIX-data">if-PREFIX-data</A> ...] except uses the same data rules as [<A HREF="#PREFIX-field">PREFIX-field</A>].</P>
<H2><A NAME="modifier-name">3.23. modifier-name</A></H2>
<PRE>
   [modifier-name attribute]
</PRE>
<P>Outputs a variable name which will set an appropriate variable name for setting the attribute in a form (usually a shopping cart). Outputs for successive items in the list:</P>
<PRE>
    1. attribute0
    2. attribute1
    3. attribute2
</PRE>
<P>etc.</P>
<P><TT>[modifier-name] quantity</TT> would be the same as [<A HREF="#quantity-name">quantity-name</A>].</P>
<H2><A NAME="quantity-name">3.24. quantity-name</A></H2>
<PRE>
   [quantity-name]
</PRE>
<P>Outputs for successive items in the list:</P>
<PRE>
    1. quantity0
    2. quantity1
    3. quantity2
</PRE>
<P>etc.</P>
<P>[<A HREF="#modifier-name">modifier-name</A><TT> quantity</TT>] would be the same as <TT>[quantity-name]</TT>.</P>
<HR>
<H1><A NAME="Tags">4. Tags</A></H1>
<P>Each ITL tag is show below. Calling information is defined for the main tag, sub-tags are described in <A HREF="#Looping tags and Sub-tags">Looping tags and Sub-tags</A>.</P>
<H2><A NAME="accessories">4.1. accessories</A></H2>
<P>A Swiss-army-knife widget builder, this provides access to Interchange's product option attributes (e.g., to choose or access product options such as a shirt's size or color).</P>
<P>Can build selection objects (radio, check, select boxes, etc), forms or hyperlinks, or can simply return a value.</P>
<P>Or more&nbsp;-- see also <A HREF="#Looping tags and Sub-tags">Looping tags and Sub-tags</A>.</P>
<H3><A NAME="Summary">4.1.1. Summary</A></H3>
<PRE>
    [<B>accessories</B> code arg]
    [<B>accessories</B> code=os28044 arg=&quot;size, radio, ... &quot; <I>other_named_attributes</I>] <I>deprecated</I>
    [<B>accessories</B> code=os28044 attribute=size type=radio ... <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_code">code</A>
</TD>
<TD VALIGN='Top'>
Value of the master key in the product (or specified other) table
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_arg">arg</A>
</TD>
<TD VALIGN='Top'>
Positionally interpreted comma-delimited list of values for the following attributes:
<UL>
&quot;attribute, type, column, table, name, outboard, passed&quot;</UL>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_attribute">attribute</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_type">type</A>
<UL>
One of select, value, text, textarea, hidden, password, combo, move_combo, reverse_combo, show, options, labels, checkbox, radio, links</UL>
</TD>
<TD VALIGN='Top'>
select
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_column">column</A>
</TD>
<TD VALIGN='Top'>
<I>attribute</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_table">table</A>
</TD>
<TD VALIGN='Top'>
products
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_name">name</A>
</TD>
<TD VALIGN='Top'>
mv_order_<I>attribute</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_outboard">outboard</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_passed">passed</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_code">key</A> (alias for code)
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_code">row</A> (alias for code)
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_table">base</A> (alias for <TT>table</TT>)
</TD>
<TD VALIGN='Top'>
products
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_table">database</A> (alias for <TT>table</TT>)
</TD>
<TD VALIGN='Top'>
products
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_table">db</A> (alias for <TT>table</TT>)
</TD>
<TD VALIGN='Top'>
products
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_column">col</A> (alias for <TT>column</TT>
</TD>
<TD VALIGN='Top'>
<I>attribute</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_column">field</A> (alias for <TT>column</TT>
</TD>
<TD VALIGN='Top'>
<I>attribute</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_delimiter">delimiter</A>
</TD>
<TD VALIGN='Top'>
comma (',')
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_prepend">prepend</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_append">append</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_extra">extra</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_js">js</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_rows">rows</A>
</TD>
<TD VALIGN='Top'>
<I>varies with </I><TT>type</TT><I>; often</I> 4
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_cols">cols</A>
</TD>
<TD VALIGN='Top'>
<I>varies with </I><TT>type</TT><I>; often</I> 40
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_width">width</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_default">default</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_price">price</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_price_data">price_data</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_contains">contains</A> (<TT>type</TT>=radio or check)
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_joiner">joiner</A> (<TT>type</TT>=links)
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_href">href</A> (<TT>type</TT>=links)
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_template">template</A> (<TT>type</TT>=links)
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_form">form</A> (<TT>type</TT>=links)
</TD>
<TD VALIGN='Top'>
<TT>mv_action=return</TT>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_empty">empty</A> (<TT>type</TT>=links)
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_secure">secure</A> (<TT>type</TT>=links)
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#accessories_new">new</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate</A> (reparse)
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [accessories os28044 size]
---
    &lt;SELECT NAME=&quot;mv_order_size&quot;&gt;&lt;OPTION VALUE=&quot;10oz&quot;&gt;10oz\
    &lt;OPTION VALUE=&quot;15oz&quot;&gt;15oz&lt;OPTION VALUE=&quot;20oz&quot;&gt;20oz&lt;/SELECT&gt;
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;accessories(  { code   =&gt; <TT>'[[EXAMPLE_SKU]]'</TT>,
                          arg    =&gt; <TT>'color, radio'</TT>
                          table  =&gt; <TT>'special_products'</TT>, }  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;accessories($code, $arg, $attribute_hash_reference);
</PRE>
<H4><A NAME="See Also">4.1.1.1. See Also</A></H4>
<P><A HREF="#Looping tags and Sub-tags">Looping tags and Sub-tags</A>.</P>
<H3><A NAME="Description">4.1.2. Description</A></H3>
<P>This is the swiss-army-knife widget builder for providing access to Interchange's product option attributes (e.g., to choose or access product options such as a shirt's size or color).</P>
<P>Interchange allows you to choose item attribute values for each ordered item&nbsp;-- you can attach a size, color, or other modifier to a line item in the shopping cart. You can also resubmit previous attribute values via hidden fields on a form.</P>
<P>The <TT>catalog.cfg</TT> file directive <A HREF="icconfig.html#UseModifier">UseModifier</A> is used to set the name of the modifier or modifiers. For example</P>
<PRE>
    <A HREF="icconfig.html#UseModifier">UseModifier</A>        size color
</PRE>
<P>will attach both a size and color attribute to each item code that is ordered.</P>
<P><HR WIDTH="80%" ALIGN="Left">
<STRONG>Important Note -- </STRONG>You may not use the following names for attributes:</P>
<P>item  group  quantity  code  mv_ib  mv_mi  mv_si</P>
<P><HR WIDTH="80%" ALIGN="Left"></P>
<P>You can also set modifier names with the mv_UseModifier scratch variable&nbsp;-- [<A HREF="#set">set</A>&nbsp;mv_UseModifier] size color [/set] has the same effect as above. This allows multiple options to be set for products. Whichever one is in effect at order time will be used. Be careful; you cannot set it more than once on the same page. Setting the <TT>mv_separate_items</TT> or global directive <I>SeparateItems</I> places each ordered item on a separate line, simplifying attribute handling. The scratch setting for <TT>mv_separate_items</TT> has the same effect.</P>
<P>The modifier value is accessed in the [<A HREF="#item-list">item-list</A>] loop with the [<A HREF="#PREFIX-param">item-param</A><TT> attribute</TT>] tag, and form input fields are placed with the [<A HREF="#modifier-name">modifier-name</A><TT> attribute</TT>] tag. This is similar to the way that quantity is handled.</P>
<P><HR WIDTH="80%" ALIGN="Left">
<STRONG>Note: </STRONG>You must be sure that no fields in your forms have digits appended to their names if the variable is the same name as the attribute name you select, as the [<A HREF="#modifier-name">modifier-name</A><TT> size</TT>] variables will be placed in the user session as the form variables size0, size1, size2, etc.</P>
<P><HR WIDTH="80%" ALIGN="Left"></P>
<P>Interchange will automatically generate the select boxes when the [<A HREF="#accessories">accessories</A> <TT>code=</TT>&quot;os28044&quot;&nbsp;<TT>attribute=</TT>&quot;size&quot;] or [<A HREF="#PREFIX-accessories">item-accessories</A><TT> size</TT>] tags are called. They have the syntax:</P>
<PRE>
    [item-accessories attribute, type, column, table, name, outboard, passed]

    [accessories code=sku
                attribute=modifier
                type=select
                column=db_table_column_name
                table=db_table
                name=varname
                outboard=key
                passed=&quot;value=label, value2*, value3=label 3&quot;]

    [accessories js=| onChange=&quot;set_description(simple_options, variant)&quot;; |
                type=select
                name=&quot;[item-param o_group]&quot;
                passed=&quot;=--choose--,[item-param o_value]&quot;]
</PRE>
<P><HR WIDTH="80%" ALIGN="Left">
<STRONG>Notes: </STRONG></P>
<OL>
<LI>The '<A HREF="#accessories_attribute">attribute</A>' attribute is required.
<LI>See the <A HREF="#accessories_type">type</A> attribute for a list of types.
<LI>The trailing '*' in value2 will mark it as the default ('SELECTED') value in the select widget (see below).</OL>
<P><HR WIDTH="80%" ALIGN="Left"></P>
<P>When called with an attribute, the database is consulted and looks for a comma-separated list of item attribute options. They take the form:</P>
<PRE>
   name_a=Label Text1, default_name=Default Label Text*, name_b, <I>etc.</I>
</PRE>
<P>The label text is optional&nbsp;-- if none is given, the <B>name</B> will be used (as in 'name_b' above).</P>
<P>If an asterisk is the last character of the label text, the item is the default selection. If no default is specified, the first will be the default. An example:</P>
<PRE>
    [item-accessories color]
</PRE>
<P>This will search the product database for a field named &quot;color&quot;. If an entry &quot;beige=Almond, gold=Harvest Gold, White*, green=Avocado&quot; is found, a select box like this will be built:</P>
<PRE>
    &lt;SELECT NAME=&quot;mv_order_color&quot;&gt;
    &lt;OPTION VALUE=&quot;beige&quot;&gt;Almond
    &lt;OPTION VALUE=&quot;gold&quot;&gt;Harvest Gold
    &lt;OPTION SELECTED&gt;White
    &lt;OPTION VALUE=&quot;green&quot;&gt;Avocado
    &lt;/SELECT&gt;
</PRE>
<P>In combination with the <TT>mv_order_item</TT> and <TT>mv_order_quantity</TT> session variables, you can use this to allow a customer to enter an item attribute during an order.</P>
<P>If used in an item list, and the user has changed the value, the generated select box will automatically retain the current value the user has selected.</P>
<P>The value can then be displayed with [<A HREF="#PREFIX-modifier">item-modifier</A> color] on the order report, order receipt, or any other page containing an [<A HREF="#item-list">item-list</A>].</P>
<H4><A NAME="Emulating with a loop">4.1.2.1. Emulating with a loop</A></H4>
<P>You can also build widgets directly, without using the <TT>accessories</TT> tag. You may have to do so if you need more control of the content than the tag offers. Below is a fragment from a shopping basket display form which shows a selectable size with &quot;sticky&quot; setting and a price that changes based upon the modifier setting. (Note that this example would normally be contained within the [<A HREF="#item-list">item-list</A>]<TT>[/item-list]</TT> pair.)</P>
<PRE>
    &lt;SELECT NAME=&quot;[modifier-name size]&quot;&gt;
    [loop option=&quot;[modifier-name size]&quot; list=&quot;S, M, L, XL&quot;]
    &lt;OPTION&gt; [loop-code] -- [price code=&quot;[item-code]&quot; size=&quot;[loop-code]&quot;]
    [/loop]
    &lt;/SELECT&gt;
</PRE>
<P>The output of the above would be similar to the output of [item-accessories size, select] if the product database field <TT>size</TT> contained the value <TT>S, M, L, XL</TT>. The difference is that the options in the loop emulation show the adjusted price in addition to the size within each option value.</P>
<H4><A NAME="accessories_hash_lists E&lt;emdash&gt; Technical Note"> </A>4.1.2.2. <A NAME="accessories_hash_lists">Hash Lists</A> -- Technical Note</H4>
<P>As a technical note, some of the features of this tag work differently depending upon whether it was called with an '$item' hash reference, for example, as [<TT>item-accessories</TT>] within an [<A HREF="#item-list">item-list</A>].</P>
<P>In this context, the tag will have access to ancillary data from the item (including, perhaps, a user's chosen item attribute value). For example, if building a TEXTAREA widget within an [<A HREF="#item-list">item-list</A>], the widget will show the chosen item attribute value. On the other hand, within an array list such as a [<A HREF="#search-list">search-list</A>] in a [<A HREF="#search-region">search-region</A>], the widget would be empty.</P>
<P>If you really know what you're doing, you can pass it the item hash reference within a [<A HREF="#perl">perl</A>] tag like this:</P>
<PRE>
   $Tag-&gt;accessories( $code,
                      <B>undef</B>,              <I># 'arg' parameter value</I>
                      $named_attribute_hashref,
                      $item_hashref );
</PRE>
<P>See also <A HREF="#Looping tags and Sub-tags">Looping tags and Sub-tags</A> for information about hash-context and array-context in looping tags.</P>
<H4><A NAME="accessories_code"> </A>4.1.2.3. <A NAME="accessories_code">code</A></H4>
<P>This is the master key of the specified table (commonly sku in a product table). If no table is specified, the tag uses the products table by default.</P>
<P>You should not specify a <TT>code</TT> when looping on [item_accessories] because it internally sets '<TT>code</TT>' to the key for the current item in the loop.</P>
<H4><A NAME="accessories_arg"> </A>4.1.2.4. <A NAME="accessories_arg">arg</A></H4>
<P><B>Deprecated after Interchange 4.6</B></P>
<P>This allows you to pass values for some of the more commonly used attributes in the manner of the [<A HREF="#PREFIX-accessories">item-accessories</A>] tag, as a comma-delimited positional list:</P>
<PRE>
  <B>arg</B>=&quot;attribute, type, column, table, name, outboard, passed&quot;
</PRE>
<P>Whitespace within the list is optional.</P>
<P>If you leave out one or more of the above attributes, be sure to keep the comma(s) if you are setting anything after it in the list:</P>
<PRE>
  <B>arg</B>=&quot;attribute, type, , table&quot;
</PRE>
<P>The above examples show the attribute names for clarity; you would actually use the values. Hence, the previous example might actually be something like the following:</P>
<PRE>
  <B>arg</B>=&quot;color, radio, , products&quot;
</PRE>
<P>Although you must use such a comma-delimited list to pass attributes to the [<A HREF="#PREFIX-accessories">item-accessories</A>] tag, please use named attributes instead for the [<A HREF="#accessories">accessories</A>] tag. The '<TT>arg</TT>' attribute is deprecated.</P>
<P>For detail about a specific attribute, please see its subheading below.</P>
<H4><A NAME="accessories_attribute"> </A>4.1.2.5. <A NAME="accessories_attribute">attribute</A></H4>
<P>Despite the name, this has nothing to do with tag attributes. You can set attributes for <I>items</I> in a database table (typically the products table) with the <A HREF="icconfig.html#UseModifier">UseModifier</A> configuration directive. Typical are <TT>size</TT> or <TT>color</TT>.</P>
<P>This selects the item attribute the tag will work with.</P>
<H4><A NAME="accessories_type"> </A>4.1.2.6. <A NAME="accessories_type">type</A></H4>
<P>This determines the action to be taken. One of:</P>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Action</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
select
</TD>
<TD VALIGN='Top'>
Builds a dropdown &lt;SELECT&gt; menu for the item attribute, with the default item attribute value SELECTED. The <TT>accessories</TT> tag builds a select widget by default if <TT>type</TT> is not set.
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
display
</TD>
<TD VALIGN='Top'>
Shows the label text for *only the selected option* if called in <A HREF="#accessories_hash_lists">Hash List</A> context (e.g., within an [<A HREF="#item-list">item-list</A>]). Ignored otherwise (i.e., the tag will build the default &lt;SELECT&gt; menu).
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
show
</TD>
<TD VALIGN='Top'>
Returns the list of possible attributes for the item (without labels or any HTML widget). For example, if sku os28044 is available in several sizes:
<UL>
[accessories os28044 size,show]
<BR>
-----------------------------------------
<BR>
Sm=10oz, Med=15oz*, Lg=20oz</UL>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
options
</TD>
<TD VALIGN='Top'>
This shows the attribute options as a newline delimited list:
<UL>
[accessories os28044 size,options]
<BR>
-----------------------------------------
<BR>
Sm
<BR>
Med
<BR>
Lg</UL>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
labels
</TD>
<TD VALIGN='Top'>
This shows the attribute option labels:
<UL>
[accessories os28044 size,options]
<BR>
-----------------------------------------
<BR>
10oz
<BR>
15oz*
<BR>
20oz</UL>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
radio
</TD>
<TD VALIGN='Top'>
Builds a radio box group for the item, with spaces separating the elements.
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
radio nbsp
</TD>
<TD VALIGN='Top'>
Builds a radio box group for the item, with &amp;nbsp; separating the elements.
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
radio break
</TD>
<TD VALIGN='Top'>
Builds a radio box group for the item, with '&lt;br&gt;' separating the radio button/label pairs from one another.
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
radio left n
</TD>
<TD VALIGN='Top'>
Builds a radio box group for the item, inside a table, with the checkbox on the left side. If &quot;n&quot; is present and is a digit from 2 to 9, it will align the options in that many columns.
<P>You can also set FONT SIZE like this:</P>
<PRE>
  type=&quot;radio left <I>n</I> fontsize<I>m</I>&quot;
</PRE>
<P>where -9 &lt;= <I>m</I> &lt;= 9</P>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
radio right n
</TD>
<TD VALIGN='Top'>
Builds a radio box group for the item, inside a table, with the checkbox on the right side. If &quot;n&quot; is present and is a digit from 2 to 9, it will align the options in that many columns.
<P>You can also set FONT SIZE like this:</P>
<PRE>
  type=&quot;radio right <I>n</I> fontsize<I>m</I>&quot;
</PRE>
<P>where -9 &lt;= <I>m</I> &lt;= 9</P>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
check
</TD>
<TD VALIGN='Top'>
Builds a checkbox group for the item, with spaces separating the elements.
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
check nbsp
</TD>
<TD VALIGN='Top'>
Builds a checkbox group for the item, with '&amp;nbsp;' separating the checkbox/label pairs from one another.
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
check break
</TD>
<TD VALIGN='Top'>
Builds a checkbox group for the item, with '&lt;br&gt;' separating the checkbox/label pairs from one another.
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
check left <I>n</I>
</TD>
<TD VALIGN='Top'>
Builds a checkbox group for the item, inside a table, with the checkbox on the left side. If &quot;n&quot; is present and is a digit from 2 to 9, it will align the options in that many columns.
<P>You can also set FONT SIZE like this:</P>
<PRE>
  type=&quot;check left <I>n</I> fontsize<I>m</I>&quot;
</PRE>
<P>where -9 &lt;= <I>m</I> &lt;= 9</P>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
check right n
</TD>
<TD VALIGN='Top'>
Builds a checkbox group for the item, inside a table, with the checkbox on the right side. If &quot;n&quot; is present and is a digit from 2 to 9, it will align the options in that many columns.
<P>You can also set FONT SIZE like this:</P>
<PRE>
  type=&quot;check right <I>n</I> fontsize<I>m</I>&quot;
</PRE>
<P>where -9 &lt;= <I>m</I> &lt;= 9</P>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
textarea_XX_YY
</TD>
<TD VALIGN='Top'>
A textarea with XX columns and YY rows. The textarea will contain the selected item attribute value if used in <A HREF="#accessories_hash_lists">Hash List</A> context (e.g., within an [<A HREF="#item-list">item-list</A>]).
<P>If you simply use '<TT>type</TT>=textarea', the size will default to 4 rows by 40 columns, unless you have set the <A HREF="#accessories_rows">rows</A> or <A HREF="#accessories_cols">cols</A> tag attributes.</P>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
text_YY
</TD>
<TD VALIGN='Top'>
A text box with YY width in characters. The HTML tag's VALUE will be set to the selected item attribute value if used in <A HREF="#accessories_hash_lists">Hash List</A> context (e.g., within an [<A HREF="#item-list">item-list</A>]).
<P>If you simply use '<TT>type</TT>=text', the width will default to 60, unless you have set the <A HREF="#accessories_cols">cols</A> tag attribute.</P>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
combo
</TD>
<TD VALIGN='Top'>
Special type, used with nullselect filter, for selecting from a list or inputting a new value
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
reverse_combo
</TD>
<TD VALIGN='Top'>
Special type, used with last_non_null filter, for selecting from a list or inputting a new value&nbsp;-- differs from combo in order of presentation
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
move_combo
</TD>
<TD VALIGN='Top'>
Special type, used with null_to_space or null_to_comma filter, for selecting multiple non-ordered values from a list or inputting into a textarea
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
links
</TD>
<TD VALIGN='Top'>
Produces a series of links based on the option values. The base form value is passed via the form parameter, just like in an [area ...] or [page ...] tag, and the value is named with the passed NAME attribute.
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
value
</TD>
<TD VALIGN='Top'>
Returns the selected value if called in <A HREF="#accessories_hash_lists">Hash List</A> context (e.g., within an [<A HREF="#item-list">item-list</A>]), or nothing otherwise.
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
hidden
</TD>
<TD VALIGN='Top'>
Creates a hidden form field. The hidden field's VALUE will be set to the selected item attribute value if used in <A HREF="#accessories_hash_lists">Hash List</A> context (e.g., within an [<A HREF="#item-list">item-list</A>]).
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
password_YY
</TD>
<TD VALIGN='Top'>
A password box with YY width in characters. The HTML tag's VALUE will be set to the selected item attribute value if used in <A HREF="#accessories_hash_lists">Hash List</A> context (e.g., within an [<A HREF="#item-list">item-list</A>]).
<P>If you simply use '<TT>type</TT>=password', the width will default to 12, unless you have set the <A HREF="#accessories_cols">cols</A> tag attribute.</P>
</TD>
</TR>
</TABLE>

<P>The default is 'select', which builds an HTML select form entry for the attribute.</P>
<P>Some types build widgets that use the ROWS=<I>m</I>, COLS=<I>n</I>, or certain other HTML attributes. For these, you can define widget rows and columns within the string that sets the type; for example, <TT>type</TT>=&quot;textarea_6_33_wrap=virtual&quot; specifies a TEXTAREA widget with ROWS=6, COLS=33, and WRAP=virtual. You should resort to this only when you cannot use the named parameters, for example within an [<A HREF="#PREFIX-accessories">item-accessories</A>] tag. Otherwise, use the <A HREF="#accessories_rows">rows</A>=<I>m</I> and <A HREF="#accessories_cols">cols</A>=<I>n</I> tag attributes instead.</P>
<P>The result of setting conflicting values in the <A HREF="#accessories_type">type</A> string and the <TT>rows</TT> or <TT>cols</TT> attributes is undefined.</P>
<P>The following list shows syntax for type strings, where <I>rows</I> is the number of rows and <I>cols</I> is the number of columns.</P>
<UL>
<LI><B>text</B><UL>
<LI>textarea   <I>(default is 4 rows, 40 columns, like 'textarea_4_40')</I>
<LI>textarea_<I>rows</I>_<I>cols</I>
<LI>text_<I>cols</I>
<LI>textarea rows=<I>rows</I> cols=<I>cols</I> wrap=<I>WRAP value</I></UL>
<LI><B>password</B><UL>
<LI>password   <I>(default is 12 columns, like 'password_12')</I>
<LI>password_<I>cols</I></UL>
<LI><B>combo</B> (similarly for <B>reverse_combo</B> and <B>move_combo</B>)<UL>
<LI>combo   <I>(default is 1 row, 16 columns, like 'combo_1_16')</I></UL></UL>
<P>In any of the option building types, you can append the string <TT>ranges</TT> and a special option processing will be done -- any option matching the pattern [A-Za-z0-0]..[A-Za-z0-0] will be expanded into a comma separated range between the bounds. The same behavior is accomplished by passing the accessories tag option <TT>ranges</TT>. For example:</P>
<PRE>

    [accessories name=foo type=select ranges=1 &quot;A..C,1..5,10,20&quot;]
      and
    [accessories name=foo type=&quot;select ranges&quot; passed=&quot;A..C,1..5,10,20&quot;]

      will both output:

    &lt;select NAME=&quot;foo&quot;&gt;
    &lt;option VALUE=&quot;A&quot;&gt;A
    &lt;option VALUE=&quot;B&quot;&gt;B
    &lt;option VALUE=&quot;C&quot;&gt;C
    &lt;option VALUE=&quot;1&quot;&gt;1
    &lt;option VALUE=&quot;2&quot;&gt;2
    &lt;option VALUE=&quot;3&quot;&gt;3
    &lt;option VALUE=&quot;4&quot;&gt;4
    &lt;option VALUE=&quot;5&quot;&gt;5
    &lt;option VALUE=&quot;10&quot;&gt;10
    &lt;option VALUE=&quot;15&quot;&gt;15
    &lt;option VALUE=&quot;20&quot;&gt;20
    &lt;/select&gt;
</PRE>
<P>The above applies to any of the option building types -- <TT>check</TT>, <TT>combo</TT>, <TT>combo_move</TT>, <TT>labels</TT>, <TT>multiple</TT>, <TT>options</TT>, <TT>radio</TT>, <TT>reverse_combo</TT>, and <TT>select</TT>. It will refuse to produce more than 5000 options -- that limit can be changed with <TT>Limit option_list N</TT> in <TT>catalog.cfg</TT>, where N is an integer greater than 0.</P>
<H4><A NAME="accessories_column"> </A>4.1.2.7. <A NAME="accessories_column">column</A></H4>
<P>The column of the table corresponding to the attribute will traditionally have the same name as the attribute, though it need not.</P>
<P>This specifies the table column that contains an item's attribute values. The tag will find item attribute names and values in a comma-delimited list of name=value pairs stored in this field of an item's table entry. If unspecified, the column name will default to the name given for the '<A HREF="#accessories_attribute">attribute</A>' attribute.</P>
<P>For example, if an item in the products table has a '<TT>size</TT>' attribute, and each item's comma-delimited list of available sizes is stored in the '<TT>how_big</TT>' column, then you would need to specify &quot;<TT>column=how_big</TT>&quot; because the tag's default column choice (<TT>size</TT>) would be missing or used for some other purpose.</P>
<H4><A NAME="accessories_table"> </A>4.1.2.8. <A NAME="accessories_table">table</A></H4>
<P>This is the database table containing the item's attribute values. It defaults to the first products file where the item code is found.</P>
<P>If you have configured your database so that the attributes are kept in a different table from other item data, '<A HREF="#accessories_code">code</A>' should be set to the master key in this table. See '<A HREF="#accessories_outboard">outboard</A>') if you are using [<A HREF="#PREFIX-accessories">item-accessories</A>] and cannot specify <TT>code=key</TT>.</P>
<H4><A NAME="accessories_name"> </A>4.1.2.9. <A NAME="accessories_name">name</A></H4>
<P>This sets the name of the form variable to use if appropriate for the widget being built. Defaults to 'mv_order_<B>attribute</B>'&nbsp;-- i.e. if the attribute is <B>size</B>, the form variable will be named <B>mv_order_size</B>.</P>
<P>If the variable is set in the user session, the widget will &quot;remember&quot; its previous setting. In other words, [<A HREF="#value">value</A> <I>name</I>] will contain the previous setting, which the widget will use as its default setting. See also the <A HREF="#default">default</A> attribute.</P>
<H4><A NAME="accessories_outboard"> </A>4.1.2.10. <A NAME="accessories_outboard">outboard</A></H4>
<P>If calling the item-accessories tag, and you wish to select from an outboard database table whose master key is different from the item <A HREF="#accessories_code">code</A>, you can pass the key the tag should use to find the accessory data.</P>
<H4><A NAME="accessories_passed"> </A>4.1.2.11. <A NAME="accessories_passed">passed</A></H4>
<P>You can use this to pass your own values to the widget the tag will build. If you have set <TT>passed</TT> to a list of widget options, then the tag will simply build a widget of the specified <A HREF="#accessories_type">type</A> with your values instead of fetching an attribute value list from the database.</P>
<P>For example, to generate a select box with a blank option (perhaps forcing a select), the value of <TT>blue</TT> with a label of <B>Blue</B>, and the value of <TT>green</TT> with a label of <B>Sea Green</B>, do:</P>
<PRE>
    [accessories type=select
                 name=color
               passed=&quot;=--select--*, blue=Blue, green=Sea Green&quot;]
</PRE>
<P>This will generate:</P>
<PRE>
    &lt;SELECT NAME=&quot;color&quot;&gt;&lt;OPTION VALUE=&quot;&quot; SELECTED&gt;--select--\
    &lt;OPTION VALUE=&quot;blue&quot;&gt;Blue\
    &lt;OPTION VALUE=&quot;green&quot;&gt;Sea Green&lt;/SELECT&gt;
</PRE>
<P>Note: trailing backslashes ('\') in the above example indicate line continuation and are not part of the tag output.</P>
<H4><A NAME="accessories_delimiter"> </A>4.1.2.12. <A NAME="accessories_delimiter">delimiter</A></H4>
<P>The list of attribute values will be a delimited string. This allows you to specify an alternative delimiter if the list is not comma-delimited (the default).</P>
<H4><A NAME="accessories_prepend"> </A>4.1.2.13. <A NAME="accessories_prepend">prepend</A></H4>
<P>You can set a string to prepend to the returned output of the tag. Note that this is <I>not</I> a list to prepend to the fetched <A HREF="#accessories_attribute">attribute</A> value list, which is treated within the tag.</P>
<P>For example,</P>
<PRE>
    [accessories code=os28044
                 type=select
            attribute=size
               append=&quot;Append Me&lt;br&gt;&quot;
              prepend=&quot;Prepend Me&quot;]
---
    Prepend Me&lt;SELECT NAME=&quot;mv_order_size&quot;&gt;\
    &lt;OPTION VALUE=&quot;10oz&quot;&gt;10oz\
    &lt;OPTION VALUE=&quot;15oz&quot;&gt;15oz\
    &lt;OPTION VALUE=&quot;20oz&quot;&gt;20oz&lt;/SELECT&gt;<B>Append Me</B>&lt;br&gt;
</PRE>
<H4><A NAME="accessories_append"> </A>4.1.2.14. <A NAME="accessories_append">append</A></H4>
<P>You can set a string to append to the returned output of the tag. Note that this is <I>not</I> a list to append to the fetched <A HREF="#accessories_attribute">attribute</A> value list, which is treated within the tag.</P>
<H4><A NAME="accessories_extra"> </A>4.1.2.15. <A NAME="accessories_extra">extra</A></H4>
<P>Setting the '<TT>extra</TT>' attribute appends its value as the last attribute of the HTML output tag. The following example illustrates the <TT>append</TT>, <TT>extra</TT> and <TT>js</TT> options:</P>
<PRE>
    [accessories code=os28044
                 type=select
            attribute=size
               append=&quot;Append Me&lt;br&gt;&quot;
                extra=&quot;Last=Extra&quot;
                   js=&quot;javascript_here&quot;]
---
    &lt;SELECT NAME=&quot;mv_order_size&quot; javascript_here Last=Extra&gt;\
    &lt;OPTION VALUE=&quot;10oz&quot;&gt;10oz\
    &lt;OPTION VALUE=&quot;15oz&quot;&gt;15oz\
    &lt;OPTION VALUE=&quot;20oz&quot;&gt;20oz&lt;/SELECT&gt;Append Me&lt;br&gt;
</PRE>
<H4><A NAME="accessories_js"> </A>4.1.2.16. <A NAME="accessories_js">js</A></H4>
<P>This allows you to place javascript within the start tag of the HTML output. See the example given above for <TT>extra</TT>.</P>
<P><TT>js</TT> has no default, except when '<A HREF="#accessories_type">type</A>=move_combo', where the default is:</P>
<PRE>
  onChange=&quot;addItem(this.form.X<I>name</I>,this.form.<I>name</I>)&quot;
</PRE>
<H4><A NAME="accessories_rows"> </A>4.1.2.17. <A NAME="accessories_rows">rows</A></H4>
<P>The tag will pass the number you choose through to the HTML 'ROWS=<I>n</I>' attribute in HTML widgets that accept it.</P>
<P>For some types, you can also define widget rows and columns within the string that sets the <A HREF="#accessories_type">type</A>; for example, <A HREF="#accessories_type">type</A>=&quot;textarea_6_33_wrap=virtual&quot; specifies a TEXTAREA widget with ROWS=6, COLS=33, and WRAP=virtual. You should resort to this only when you cannot use the named parameters, for example within an [<A HREF="#PREFIX-accessories">item-accessories</A>] tag.</P>
<P>The result of setting conflicting values in the <A HREF="#accessories_type">type</A> string and the <TT>rows</TT>=<I>n</I> attribute is undefined.</P>
<H4><A NAME="accessories_cols"> </A>4.1.2.18. <A NAME="accessories_cols">cols</A></H4>
<P>The tag will pass the number you choose through to the HTML 'COLS=<I>n</I>' attribute in HTML widgets that accept it.</P>
<P>See also '<A HREF="#accessories_rows">rows</A>' above.</P>
<H4><A NAME="accessories_width"> </A>4.1.2.19. <A NAME="accessories_width">width</A></H4>
<P>This is a quasi-alias for '<A HREF="#accessories_cols">cols</A>' that only works with the '<TT>text</TT>' and '&lt;password&gt;' types. Use '<A HREF="#accessories_cols">cols</A>' instead.</P>
<H4><A NAME="accessories_default"> </A>4.1.2.20. <A NAME="accessories_default">default</A></H4>
<P>Sets the default attribute option in the widget returned by the tag. This will override a default indicated with a trailing '*' in the database or '<A HREF="#accessories_passed">passed</A>' string. This will also override the default of a user's previous selection when the tag would otherwise have preserved it.</P>
<P>For example the following selects blue by default rather than green as it would otherwise have done,</P>
<PRE>
    [accessories type=select
                 name=color
               passed=&quot;blue=blue, green=Sea Green*&quot;
              default=&quot;blue&quot;]
---
    &lt;SELECT NAME=&quot;color&quot;&gt;&lt;OPTION VALUE=&quot;blue&quot; SELECTED&gt;blue\
    &lt;OPTION VALUE=&quot;green&quot;&gt;Sea Green&lt;/SELECT&gt;
---
</PRE>
<P>Obscure technical note: the tag ignores the '<TT>default</TT>' attribute if it has an item hash reference&nbsp;-- see <A HREF="#accessories_hash_lists">Hash Lists</A> above.</P>
<H4><A NAME="accessories_price"> </A>4.1.2.21. <A NAME="accessories_price">price</A></H4>
<P>When combined with the <TT>price_data</TT> tag attribute, this allows you to force prices for item attributes. You probably do not want to use this; just let the tag pick up prices from your database table(s) when appropriate.</P>
<P>If you are passing attribute values, you can use this to control the displayed price in the widget.</P>
<PRE>
    [accessories type=check
                 name=color
                price=1
           price_data=&quot;blue=20, green=50&quot;
               passed=&quot;blue=Blue, green=Sea Green*&quot;]
---
    &lt;INPUT TYPE=&quot;checkbox&quot; NAME=&quot;color&quot; VALUE=&quot;blue&quot; &gt;&amp;nbsp;Blue&amp;nbsp;($20.00)
    &lt;INPUT TYPE=&quot;checkbox&quot; NAME=&quot;color&quot; VALUE=&quot;green&quot; CHECKED&gt;&amp;nbsp;Sea Green&amp;nbsp;($50.00)
</PRE>
<H4><A NAME="accessories_price_data"> </A>4.1.2.22. <A NAME="accessories_price_data">price_data</A></H4>
<H4><A NAME="accessories_contains"> </A>4.1.2.23. <A NAME="accessories_contains">contains</A></H4>
<P>Requires '<A HREF="#accessories_type">type</A>=radio' or '<TT>type</TT>=check'.</P>
<P>Used to determine whether a substring match of the value will cause a radio box or check box to be selected. If true, the match will happen whether the value is on a word boundary or not -- if false, the value must be on a word boundary. (When we speak of a word boundary, it is in the Perl sense -- a word character [A-Za-z0-9_] followed or preceded by a non-word character, or beginning or end of the string.)</P>
<H4><A NAME="accessories_joiner"> </A>4.1.2.24. <A NAME="accessories_joiner">joiner</A></H4>
<P>Requires '<A HREF="#accessories_type">type</A>=links'.</P>
<P>With <TT>type=links</TT>, the accessories tag returns a link for each option. This allows you to override the default string ('&lt;BR&gt;') that joins these links. You can use Perl's metacharacter escapes, such as '\n' for newline or '\t' for tab.</P>
<H4><A NAME="accessories_href"> </A>4.1.2.25. <A NAME="accessories_href">href</A></H4>
<P>Requires '<A HREF="#accessories_type">type</A>=links'.</P>
<P>This sets the base HREF for the link in a <TT>links</TT> type. Default is the current page.</P>
<H4><A NAME="accessories_template"> </A>4.1.2.26. <A NAME="accessories_template">template</A></H4>
<P>Requires '<A HREF="#accessories_type">type</A>=links'.</P>
<P>Allows you to override the standard Interchange template for a hyperlink. You probably don't need to use this&nbsp;-- grep the code to grok it if you do (see 'sub build_accessory_links').</P>
<H4><A NAME="accessories_form"> </A>4.1.2.27. <A NAME="accessories_form">form</A></H4>
<P>Requires '<A HREF="#accessories_type">type</A>=links'.</P>
<P>This sets the base value for the form in a <TT>links</TT> type. Default is <TT>mv_action=return</TT>, which will simply set the variable value in the link.</P>
<P>For example, to generate a series of links&nbsp;-- one per item attribute value passed&nbsp;-- that set the variable &quot;color&quot; to the corresponding <A HREF="#accessories_passed">passed</A> value (blank, blue, or green), do this:</P>
<PRE>
    [accessories type=links
                 name=color
               passed=&quot;=--select--, blue=Blue, green=Sea Green&quot;]
</PRE>
<P>This will generate something like the following:</P>
<PRE>
    &lt;A HREF=&quot;VENDURL/MV_PAGE?<B>mv_action=return</B>&amp;color=blue&quot;&gt;Blue&lt;/A&gt;&lt;BR&gt;
    &lt;A HREF=&quot;VENDURL/MV_PAGE?<B>mv_action=return</B>&amp;color=green&quot;&gt;Sea Green&lt;/A&gt;
</PRE>
<P>where VENDURL is your Interchange URL for the catalog MV_PAGE is the current page.</P>
<P>If you want the empty &quot;--select--&quot; option to show up, pass an empty=1 parameter.</P>
<H4><A NAME="accessories_empty"> </A>4.1.2.28. <A NAME="accessories_empty">empty</A></H4>
<P>Requires '<A HREF="#accessories_type">type</A>=links'.</P>
<P>Setting '<TT>empty=1</TT>' includes a hyperlink for the empty &quot;--select--&quot; option. See the example in <TT>form</TT> above; if <TT>empty=1</TT> had been specified, three links would have been generated.</P>
<H4><A NAME="accessories_secure"> </A>4.1.2.29. <A NAME="accessories_secure">secure</A></H4>
<P>Requires '<A HREF="#accessories_type">type</A>=links'.</P>
<P>Setting <TT>secure</TT>=1 causes the generated link(s) to point to your secure Interchange URL.</P>
<H4><A NAME="accessories_new"> </A>4.1.2.30. <A NAME="accessories_new">new</A></H4>
<P>Requires '<A HREF="#accessories_type">type</A>=combo' or 'reverse_combo'.</P>
<P>You can use this to set a value in place of the 'New' or 'Current' option in a combo box. For example, if item 'os28044' has size attribute values of &quot;Sm=10oz,&nbsp;Med=15oz,&nbsp;Lg=20oz&quot;:</P>
<PRE>
    [accessories code=os28044 attribute=size type=combo new=&quot;my_new_value&quot;]
---
    &lt;INPUT TYPE=text NAME=&quot;mv_order_size&quot; SIZE=16 VALUE=&quot;&quot;&gt;
    &lt;SELECT NAME=&quot;mv_order_size&quot; SIZE=&quot;1&quot;&gt;
    &lt;OPTION VALUE=&quot;my_new_value&quot;&gt;my_new_value
    &lt;OPTION VALUE=&quot;Sm&quot;&gt;10oz
    &lt;OPTION VALUE=&quot;Med&quot;&gt;15oz
    &lt;OPTION VALUE=&quot;Lg&quot;&gt;20oz&lt;/SELECT&gt;
</PRE>
<P>Or, with the default new value:</P>
<PRE>
    [accessories code=os28044 attribute=size type=combo]
---
    &lt;INPUT TYPE=text NAME=&quot;mv_order_size&quot; SIZE=16 VALUE=&quot;&quot;&gt;
    &lt;SELECT NAME=&quot;mv_order_size&quot; SIZE=&quot;1&quot;&gt;
    &lt;OPTION VALUE=&quot;&quot;&gt;&amp;lt;-- New
    &lt;OPTION VALUE=&quot;Sm&quot;&gt;10oz
    &lt;OPTION VALUE=&quot;Med&quot;&gt;15oz
    &lt;OPTION VALUE=&quot;Lg&quot;&gt;20oz&lt;/SELECT&gt;
</PRE>
<P>Default is no VALUE with option text set to '&amp;lt;-- New' for a combo box or 'Current --&amp;gt;' for a reverse_combo box.</P>
<H2><A NAME="and">4.2. and</A></H2>
<H3><A NAME="Summary">4.2.1. Summary</A></H3>
<P>Parameters: <B>type term op compare</B></P>
<P>Pass attribute hash as last to subroutine: <B>no</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>Invalidates cache: <B>no</B></P>
<P><HR WIDTH="80%" ALIGN="Left">
<STRONG>Note: </STRONG>This tag has special positional parameter handling.
<HR WIDTH="80%" ALIGN="Left"></P>
<PRE>
    [<B>and</B> type term op compare]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#and_type">base</A>
</TD>
<TD VALIGN='Top'>
Alias for type
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#and_compare">comp</A>
</TD>
<TD VALIGN='Top'>
Alias for compare
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#and_compare">compare</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#and_op">op</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#and_op">operator</A>
</TD>
<TD VALIGN='Top'>
Alias for op
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#and_term">term</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#and_type">type</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>no</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [value name=fname set=&quot;Mike&quot; hide=1]
    [value name=lname set=&quot;&quot; hide=1]

    ...

    [if value fname]
    [and value lname]
        Both first and last name are present.
    [else]
        Missing one of &quot;fname&quot; and &quot;lname&quot; from $Values.
    [/else]
    [/if]
---
    Missing one of &quot;fname&quot; and &quot;lname&quot; from $Values.
</PRE>
<P><B>ASP-like Perl call:</B></P>
<P>Not applicable. The [<TT>and</TT> ...] tag only is used with [<A HREF="#if">if</A> ...], and Perl logic obviates the [<A HREF="#if">if</A> ...] tag.</P>
<H3><A NAME="Description">4.2.2. Description</A></H3>
<P>The [and ...] tag is only used in conjunction with [<A HREF="#if">if</A> ...].  Example:</P>
<PRE>
        [if value fname]
        [and value lname]
        Both first and last name are present.
        [else]
        Missing one of &quot;fname&quot; and &quot;lname&quot; from $Values.
        [/else]
        [/if]
</PRE>
<P>See the description of the [<A HREF="#if">if</A>] tag.</P>
<H4><A NAME="and_compare"> </A>4.2.2.1. <A NAME="and_compare">compare</A></H4>
<H4><A NAME="and_op"> </A>4.2.2.2. <A NAME="and_op">op</A></H4>
<H4><A NAME="and_term"> </A>4.2.2.3. <A NAME="and_term">term</A></H4>
<H4><A NAME="and_type"> </A>4.2.2.4. <A NAME="and_type">type</A></H4>
<H2><A NAME="area">4.3. area</A></H2>
<P>Alias:  <B>href</B></P>
<P>Expands to the URL for an Interchange page or action, including the Interchange session ID and supplied arguments. This is very similar to the <A HREF="#page">page</A> tag&nbsp;-- these are equivalent:</P>
<PRE>
    [page href=dir/page arg=mv_arg]TargetName&lt;/A&gt;
    &lt;A HREF=&quot;[area href=dir/page arg=mv_arg]&quot;&gt;TargetName&lt;/A&gt;
</PRE>
<H3><A NAME="Summary">4.3.1. Summary</A></H3>
<PRE>
    [<B>area</B> href arg]
    [<B>area</B> href=dir/page arg=page_arguments <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
href
</TD>
<TD VALIGN='Top'>
Path to Interchange page or action
<UL>
<I>Special arguments</I><UL>
<LI>'<A HREF="#area_search">scan</A>' links to a search (using search arguments in <B>arg</B>)
<LI>'http://...' external link (requires <B>form</B> attribute)</UL></UL>
</TD>
<TD VALIGN='Top'>
process
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
arg
</TD>
<TD VALIGN='Top'>
Interchange arguments to page or action
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#area_form">form</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#area_search">search</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#area_secure">secure</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Macro
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has end tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [area href=dir/page.html arg=&quot;arg1=AA/arg2=BB&quot;]

    www.here.com/cgi-bin/mycatalog/page.html?mv_session_id=6CZ2whqo&amp;\
    mv_pc=1&amp;mv_arg=arg1%3dAA/arg2%3dBB
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;area(  { href =&gt; <TT>&quot;dir/page&quot;</TT>,
                   arg  =&gt; <TT>&quot;arguments&quot;</TT>, }  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;area($href, $arg, $attribute_hash_reference);
</PRE>
<H4><A NAME="See Also">4.3.1.1. See Also</A></H4>
<P><A HREF="#page">page</A></P>
<H3><A NAME="Description">4.3.2. Description</A></H3>
<P>The <TT>area</TT> tag is very similar to the [<A HREF="#page">page</A>] tag. It produces the URL to call an Interchange page, but it differs from <TT>page</TT> in that it does not supply the surrounding &lt;A&nbsp;HREF&nbsp;...&gt; notation. This can be used to get control of your HREF items, perhaps to place an ALT string or a Javascript construct.</P>
<P>It was originally named <TT>area</TT> because it also can be used in a client-side image map.</P>
<P>The <TT>area</TT> tag has an alias of <TT>href</TT>. The two links below are identical in operation:</P>
<PRE>
   &lt;A HREF=&quot;[area href=catalog]&quot; ALT=&quot;Main catalog page&quot;&gt;Catalog Home&lt;/A&gt;
   &lt;A HREF=&quot;[href href=catalog]&quot; ALT=&quot;Main catalog page&quot;&gt;Catalog Home&lt;/A&gt;
</PRE>
<P>The optional <I>arg</I> is used just as in the <A HREF="#page">page</A> tag.</P>
<H4><A NAME="area_form"> </A>4.3.2.1. <A NAME="area_form">form</A></H4>
<P>The optional <TT>form</TT> argument allows you to encode a form in the link.</P>
<PRE>
   &lt;A HREF=&quot;[area form=&quot;mv_order_item=os28044
                        mv_order_size=15oz
                        mv_order_quantity=1
                        mv_separate_items=1
                        mv_todo=refresh&quot;]&quot;&gt; Order 15oz Framing Hammer&lt;/A&gt;
</PRE>
<P>See the description of the [<A HREF="#page">page</A>] tag for more detail.</P>
<H4><A NAME="area_search"> </A>4.3.2.2. <A NAME="area_search">search</A></H4>
<P>Interchange allows you to pass a search in a URL. There are two ways to do this:</P>
<OL>
<LI>Place the search specification in the named <TT>search</TT> attribute.<UL>
<LI>Interchange will ignore the <TT>href</TT> parameter (the link will be set to 'scan'.</UL><UL>
<LI>If you give the <TT>arg</TT> parameter a value, that value will be available as [<A HREF="#value">value</A> mv_arg] within the search display page.</UL>
<LI>Set the <TT>href</TT> parameter to 'scan' and set <TT>arg</TT> to the search specification.<UL>
<LI>Note that you can use this form positionally&nbsp;-- the values go into <TT>href</TT> and <TT>arg</TT>, so you do not have to name parameters.</UL></OL>
<P>These are identical:</P>
<PRE>
   &lt;A HREF=&quot;[area scan
                  se=Impressionists
                  sf=category]&quot;&gt;Impressionist Paintings&lt;/A&gt;

   &lt;A HREF=&quot;[area href=scan
                   arg=&quot;se=Impressionists
                        sf=category&quot;]&quot;&gt;Impressionist Paintings&lt;/A&gt;

   &lt;A HREF=&quot;[area search=&quot;se=Impressionists
                          sf=category&quot;]&quot;&gt;Impressionist Paintings&lt;/A&gt;

</PRE>
<P>See the description of the <A HREF="#page_search">page</A> tag for more detail.</P>
<H4><A NAME="area_secure"> </A>4.3.2.3. <A NAME="area_secure">secure</A></H4>
<H4><A NAME="Examples">4.3.2.4. Examples</A></H4>
<P><B>Tag expansion example:</B></P>
<PRE>
    [area href=dir/page.html arg=&quot;arg1=AA/arg2=BB&quot;]

    www.here.com/cgi-bin/mycatalog/page.html?mv_session_id=6CZ2whqo&amp;\
    mv_pc=1&amp;mv_arg=arg1%3dAA/arg2%3dBB
</PRE>
<P>Positional call example:</P>
<PRE>
    &lt;A HREF=&quot;[area ord/basket]&quot;&gt;Check basket&lt;/A&gt;
</PRE>
<P>Named call example:</P>
<PRE>
    &lt;A HREF=&quot;[area ord/basket]&quot;&gt;Check basket&lt;/A&gt;
</PRE>
<H2><A NAME="assign">4.4. assign</A></H2>
<P>Allows you to assign numeric values to preempt calculation of one or more of the following tags:</P>
<P>[<A HREF="#handling">handling</A>], [<A HREF="#salestax">salestax</A>], [<A HREF="#shipping">shipping</A>], and [<A HREF="#subtotal">subtotal</A>]</P>
<P>The assignment is persistent within a user's session until you clear it, an assigned tag will return your value instead of calculating a value.</P>
<P>Warning&nbsp;-- please be sure you understand the dependencies within the pricing system before using the <TT>assign</TT> tag. In particular, you must have the value <TT>mv_shipmode</TT> set to assign to <TT>shipping</TT>, and likewise you must set <TT>mv_handling</TT> to assign to <TT>handling</TT>. The <TT>salestax</TT> and <TT>subtotal</TT> settings don't require any session variables be set.</P>
<H3><A NAME="Summary">4.4.1. Summary</A></H3>
<PRE>
    [<B>assign</B> <I>tag_name=value</I> <I>tag_name=value</I> ...]
    [<B>assign</B> <TT>clear=1</TT>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#assign_clear">clear</A>
</TD>
<TD VALIGN='Top'>
Clears all pending '<TT>assign</TT>' tag assignments
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#assign_handling">handling</A>
</TD>
<TD VALIGN='Top'>
Assigns an override value for [<A HREF="#handling">handling</A>] tags
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#assign_salestax">salestax</A>
</TD>
<TD VALIGN='Top'>
Assigns an override value for [<A HREF="#salestax">salestax</A>] tags
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#assign_shipping">shipping</A>
</TD>
<TD VALIGN='Top'>
Assigns an override value for [<A HREF="#shipping">shipping</A>] tags
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#assign_subtotal">subtotal</A>
</TD>
<TD VALIGN='Top'>
Assigns an override value for [<A HREF="#subtotal">subtotal</A>] tags
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;assign(  { shipping =&gt; 2.99, }  );
</PRE>
<H4><A NAME="See Also">4.4.1.1. See Also</A></H4>
<P>[<A HREF="#handling">handling</A>], [<A HREF="#salestax">salestax</A>], [<A HREF="#shipping">shipping</A>], [<A HREF="#subtotal">subtotal</A>], [<A HREF="icdatabase.html#Shipping">Shipping</A>]</P>
<H3><A NAME="Description">4.4.2. Description</A></H3>
<P>The <TT>assign</TT> tag allows you to assign numeric override values to one or more of the following tags:</P>
<P>[<A HREF="#handling">handling</A>], [<A HREF="#salestax">salestax</A>], [<A HREF="#shipping">shipping</A>], and [<A HREF="#subtotal">subtotal</A>]</P>
<P>An assigned tag will return your value rather than calculating its own until you clear the assignment.</P>
<P>Assignment is persistent within the user's session (unless cleared) and affects only that user.</P>
<P>Assigning an empty string clears the tag's assignment. You can also clear all pending assignments at once with the <A HREF="#assign_clear">clear</A> attribute.</P>
<P>For example, the following eliminates salestax and sets shipping to $4.99 regardless of weight and destination:</P>
<PRE>
    [assign salestax=0 shipping=4.99]
</PRE>
<P>This restores the [<A HREF="#salestax">salestax</A>] tag and eliminates handling charges:</P>
<PRE>
    [assign salestax=&quot;&quot; handling=0]
</PRE>
<P>This restores the normal behavior to the [<A HREF="#shipping">shipping</A>] and [<A HREF="#handling">handling</A>] tags:</P>
<PRE>
    [assign clear=1]
</PRE>
<P>Assignment affects only the value returned by a tag. Other behavior, such as formatting for the local currency, is not affected by the assignment.</P>
<P>Note&nbsp;-- you will get an error in the error log (and any pending assignment for the specified tag will be cleared) if you try to assign a value other than a number or the empty string (&quot;&quot;).</P>
<H4><A NAME="assign_clear"> </A>4.4.2.1. <A NAME="assign_clear">clear</A></H4>
<P>Setting this to a true value clears all pending assignments (i.e., all assignable tags return to normal behavior).</P>
<H4><A NAME="assign_shipping"> </A>4.4.2.2. <A NAME="assign_shipping">shipping</A></H4>
<P>This sets the total value of shipping, rounded to locale-specific fractional digits. Always active if assigned a numeric value. See the [<A HREF="#shipping">shipping</A>] tag for detail about rounding, etc.</P>
<H4><A NAME="assign_handling"> </A>4.4.2.3. <A NAME="assign_handling">handling</A></H4>
<P>This option sets the total value of handling, rounded to fractional digits.</P>
<P><HR WIDTH="80%" ALIGN="Left">
<STRONG>Important note</STRONG></P>
<P>The [<A HREF="#handling">handling</A>] tag is unlike the others in that it will be inactive (despite your assignment) unless the [<A HREF="#value">value</A> <B>mv_handling</B>] variable is true (i.e., a nonzero, non-blank value).</P>
<P><HR WIDTH="80%" ALIGN="Left"></P>
<H4><A NAME="assign_salestax"> </A>4.4.2.4. <A NAME="assign_salestax">salestax</A></H4>
<P>This preempts the salestax calculation. The assigned value is not rounded.</P>
<H4><A NAME="assign_subtotal"> </A>4.4.2.5. <A NAME="assign_subtotal">subtotal</A></H4>
<P>This preempts the cart subtotal derived from prices. The assigned value is not rounded.</P>
<P>Note that you cannot assign to [<A HREF="#total-cost">total-cost</A>]&nbsp;-- it will always be the sum of the four above.</P>
<P>Before using the <TT>assign</TT> tag, please be sure you understand the dependencies within the pricing system, such as the relationship between [<A HREF="#total-cost">total-cost</A>] and assigned tags.</P>
<H2><A NAME="attr-list">4.5. attr-list</A></H2>
<P>This tag is intended for use within embedded perl rather than as a standalone tag within a template (i.e., the [<TT>attr-list</TT> ...] syntax does not apply).</P>
<P>The <TT>$Tag-&gt;attr_list($template, $hashref)</TT> usage provides a shorthand for accessing values of a hash within embedded perl. It also allows you to control defaults or set up conditional values.</P>
<H3><A NAME="Summary">4.5.1. Summary</A></H3>
<PRE>
    <TT>$Tag-&gt;attr_list($template, $hashref)</TT>
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_list_hash">hash</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_reparse">reparse</A>
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>no</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>NA</I> (Though the template is technically body text)
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example</B> (ASP-like Perl call):</P>
<PRE>
    [perl tables=products]
        my %opt = ( hashref =&gt; 1,
                 sql     =&gt; 'select * from  products', );

        my $ary_of_hash = $Db{products}-&gt;query(\%opt);

        my <B>$template</B> = &lt;&lt;EOF;
            {sku} - {description} - {price|Call for price}
            {image?}&lt;IMG SRC=&quot;{image}&quot;&gt;{/image?}
            {image:}No image available{/image:}
            &lt;br&gt;
            More body Text here
            &lt;br&gt;
EOF

        foreach my <B>$ref</B> (@$ary_of_hash) {
            $out .= $Tag-&gt;<B>attr_list($template, $ref)</B>;
        }
        return $out;
     [/perl]
---
     os28113 - The Claw Hand Rake - Call for price
     &lt;IMG SRC=&quot;/mycatalog/images/os28113.gif&quot;&gt;

     &lt;br&gt;
     More body Text here
     &lt;br&gt;
     os28006 - Painters Brush Set - 29.99
     No image available

     &lt;br&gt;
     More body Text here
     &lt;br&gt;
     ...
</PRE>
<H3><A NAME="Description">4.5.2. Description</A></H3>
<P>Tags an attribute list with values from a hash. Designed for use in embedded Perl.</P>
<P>Tags according to the following rules:</P>
<H4><A NAME="E&lt;lbrace&gt;key}">4.5.2.1. {key}</A></H4>
<P>Inserts the value of the key for the reference. In a database query, this is the column name.</P>
<H4><A NAME="E&lt;lbrace&gt;key|fallback string}">4.5.2.2. {key|fallback string}</A></H4>
<P>Displays the value of {key} or if it is zero or blank, the fallback string (i.e., default).</P>
<H4><A NAME="E&lt;lbrace&gt;key true string}">4.5.2.3. {key true string}</A></H4>
<P>Displays <TT>true string</TT> if the value of {key} is non-blank, non-zero, or displays nothing if the key is false.</P>
<H4><A NAME="E&lt;lbrace&gt;key?} true text {/key?}">4.5.2.4. {key?} true text {/key?}</A></H4>
<P>Displays <TT>true text</TT> if the value of {key} is non-blank, non-zero, and nothing otherwise.</P>
<H4><A NAME="E&lt;lbrace&gt;key:} false text {/key:}">4.5.2.5. {key:} false text {/key:}</A></H4>
<P>Displays <TT>false text</TT> if the value of {key} is blank or zero, and nothing otherwise.</P>
<H4><A NAME="attr_list_hash"> </A>4.5.2.6. <A NAME="attr_list_hash">hash</A></H4>
<P>This is the hash reference whose keys will be expanded within the template (see above).</P>
<H2><A NAME="banner">4.6. banner</A></H2>
<P>Implements random or rotating banner ads. See also <A HREF="ictemplates.html#Banner/Ad rotation">Banner/Ad rotation</A>.</P>
<H3><A NAME="Summary">4.6.1. Summary</A></H3>
<PRE>
    [<B>banner</B> category]
    [<B>banner</B> category=my_category <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#banner_category">category</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
default
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#banner_table">table</A>
</TD>
<TD VALIGN='Top'>
banner
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#banner_r_field">r_field</A> (unweighted)
</TD>
<TD VALIGN='Top'>
rotate
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#banner_b_field">b_field</A>
</TD>
<TD VALIGN='Top'>
banner
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#banner_separator">separator</A> (unweighted)
</TD>
<TD VALIGN='Top'>
':'
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#banner_delimiter">delimiter</A> (unweighted)
</TD>
<TD VALIGN='Top'>
'{or}'
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#banner_weighted">weighted</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#banner_once">once</A> (weighted)
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#banner_c_field">c_field</A> (weighted)
</TD>
<TD VALIGN='Top'>
category
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#banner_w_field">w_field</A> (weighted)
</TD>
<TD VALIGN='Top'>
weight
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [<B>banner</B> category=my_category]
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;banner(  { category =&gt; $key, } );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;banner($category, $attribute_hash_reference);
</PRE>
<H4><A NAME="See Also">4.6.1.1. See Also</A></H4>
<P><A HREF="ictemplates.html#Banner/Ad rotation">Banner/Ad rotation</A></P>
<H3><A NAME="Description">4.6.2. Description</A></H3>
<P>Implements random or rotating banner ads. See <A HREF="ictemplates.html#Banner/Ad rotation">Banner/Ad rotation</A> in the Interchange Template documentation.</P>
<P>You will need a banner ad table (typically called 'banner') which contains banner data. The following is an example:</P>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>code</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>category</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>weight</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>rotate</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>banner</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
m_3
</TD>
<TD VALIGN='Top'>
cat1
</TD>
<TD VALIGN='Top'>
7
</TD>
<TD VALIGN='Top'>
0
</TD>
<TD VALIGN='Top'>
my banner 3
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
m_1
</TD>
<TD VALIGN='Top'>
cat1
</TD>
<TD VALIGN='Top'>
1
</TD>
<TD VALIGN='Top'>
0
</TD>
<TD VALIGN='Top'>
my banner 1
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
default
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
1
</TD>
<TD VALIGN='Top'>
Default 1{or}Default 2{or}Default 3
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
m_2
</TD>
<TD VALIGN='Top'>
cat1
</TD>
<TD VALIGN='Top'>
2
</TD>
<TD VALIGN='Top'>
0
</TD>
<TD VALIGN='Top'>
my banner 2
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
t_1
</TD>
<TD VALIGN='Top'>
cat2
</TD>
<TD VALIGN='Top'>
4
</TD>
<TD VALIGN='Top'>
0
</TD>
<TD VALIGN='Top'>
their banner 1
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
t_2
</TD>
<TD VALIGN='Top'>
cat2
</TD>
<TD VALIGN='Top'>
1
</TD>
<TD VALIGN='Top'>
0
</TD>
<TD VALIGN='Top'>
their banner 2
</TD>
</TR>
</TABLE>

<H4><A NAME="banner_category"> </A>4.6.2.1. <A NAME="banner_category">category</A></H4>
<P>Default: category=&quot;default&quot;</P>
<P>This specifies the category for weighted ad, or the table row (i.e., code value) for an unweighted ad.</P>
<H4><A NAME="banner_table"> </A>4.6.2.2. <A NAME="banner_table">table</A></H4>
<P>Default: table=&quot;banner&quot;</P>
<P>Setting '<TT>table</TT>=&quot;my_banner_table&quot;' forces the tag to refer to 'my_banner_table' rather than the default 'banner' table for banner ad information.</P>
<H4><A NAME="banner_r_field"> </A>4.6.2.3. <A NAME="banner_r_field">r_field</A></H4>
<P>Default: r_field=&quot;rotate&quot;</P>
<P>Unweighted ads only.</P>
<P>A table row may include multiple banners in the 'banner' column. The column specified by r_field contains a boolean that determines whether to rotate banners. In the above table example, 'Default&nbsp;1', 'Default&nbsp;2' and 'Default&nbsp;3' would rotate.</P>
<H4><A NAME="banner_b_field"> </A>4.6.2.4. <A NAME="banner_b_field">b_field</A></H4>
<P>Default: b_field=&quot;banner&quot;</P>
<P>This specifies the column containing the banner descriptor(s). The default is 'banner'. Note that an entry might be a delimited list of banner descriptors to rotate (see <A HREF="#banner_delimiter">delimiter</A> below).</P>
<H4><A NAME="banner_separator"> </A>4.6.2.5. <A NAME="banner_separator">separator</A></H4>
<P>Default: separator=&quot;:&quot;</P>
<P>Unweighted ads only.</P>
<P>This sets the separator within the table key (i.e., code) for multi-level categorized ads. See <A HREF="ictemplates.html#Banner/Ad rotation">Banner/Ad rotation</A>.</P>
<H4><A NAME="banner_delimiter"> </A>4.6.2.6. <A NAME="banner_delimiter">delimiter</A></H4>
<P>Default: delimiter=&quot;{or}&quot;</P>
<P>Unweighted ads only.</P>
<P>This specifies the delimiter between rotating banner descriptors in the 'banner' column.</P>
<H4><A NAME="banner_weighted"> </A>4.6.2.7. <A NAME="banner_weighted">weighted</A></H4>
<P>The <TT>banner</TT> tag will not apply weighting from the table unless you set <TT>weighted</TT>=1. Note that the tag will behave as if you gave it a standard unweighted entry&nbsp;-- it will look for a matching row rather than a matching category.</P>
<H4><A NAME="banner_once"> </A>4.6.2.8. <A NAME="banner_once">once</A></H4>
<P>Weighted ads only.</P>
<P>If the option once is passed (i.e., [banner once=1 weighted=1], then the banners will not be rebuilt until the total_weight file is removed. See <A HREF="ictemplates.html#Banner/Ad rotation">Banner/Ad rotation</A>.</P>
<H4><A NAME="banner_c_field"> </A>4.6.2.9. <A NAME="banner_c_field">c_field</A></H4>
<P>Default: c_field=&quot;category&quot;</P>
<P>Weighted ads only.</P>
<P>This specifies the column containing the banner category for weighted ads. The <TT>banner</TT> tag will display ads from rows in the table whose category matches the category given in the tag, with frequency corresponding to the weights in the table.</P>
<H4><A NAME="banner_w_field"> </A>4.6.2.10. <A NAME="banner_w_field">w_field</A></H4>
<P>Default: w_field=&quot;weight&quot;</P>
<P>Weighted ads only.</P>
<P>This specifies the column containing the banner weight.</P>
<H2><A NAME="bounce">4.7. bounce</A></H2>
<H3><A NAME="Summary">4.7.1. Summary</A></H3>
<P>Parameters: <B>href if</B></P>
<P>Positional parameters in same order.</P>
<P>Pass attribute hash as last to subroutine: <B>no</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>Invalidates cache: <B>no</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<P>None. This tag doesn't work with embedded Perl due to special processing.</P>
<PRE>
    [<B>bounce</B> href if]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#bounce_href">href</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#bounce_if">if</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>no</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [bounce href if]
---
    TAG RESULT
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;bounce(  { href =&gt; VALUE_href
                     <B>if</B> =&gt; VALUE_if
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;bounce(href,<B>if</B>, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.7.2. Description</A></H3>
<P>The [bounce ...] tag is designed to send an HTTP redirect (302 status code) to the browser and redirect it to another (possibly Interchange-parsed) page.</P>
<P>It will stop ITL code execution at that point; further tags will not be run through the parser. Bear in mind that if you are inside a looping list, that list will run to completion and the [bounce] tag will not be seen until the loop is complete.</P>
<P>Example of bouncing to an Interchange parsed page:</P>
<PRE>
        [if !scratch real_user]
        [bounce href=&quot;[area violation]&quot;]
        [/if]
</PRE>
<P>Note the URL is produced by the [<A HREF="#area">area</A> ...] ITL tag.</P>
<P>Since the HTTP says the URL needs to be absolute, this one might cause a browser warning:</P>
<PRE>
        [if value go_home]
        [bounce href=&quot;/&quot;]
        [/if]
</PRE>
<P>But running something like one of the Interchange demos you can do:</P>
<PRE>
        [if value go_home]
        [bounce href=&quot;__SERVER_NAME__/&quot;]
        [/if]

        [if value go_home]
        [bounce href=&quot;/&quot;]
        [/if]
</PRE>
<H4><A NAME="bounce_href"> </A>4.7.2.1. <A NAME="bounce_href">href</A></H4>
<H4><A NAME="bounce_if"> </A>4.7.2.2. <A NAME="bounce_if">if</A></H4>
<H2><A NAME="calc">4.8. calc</A></H2>
<P>Calculates the value of the enclosed arithmetic expression.</P>
<H3><A NAME="Summary">4.8.1. Summary</A></H3>
<PRE>
    [<B>calc</B>] <I>Expression</I> [/calc]
</PRE>
<P><B>No parameters</B></P>
<P><B>No attributes</B> (though you can break it if you set '<TT>interpolate=0</TT>')</P>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>ASP-like Perl call:</B></P>
<P>There is never a reason to call this tag from within Perl or ASP code. Simply do the calculation directly.</P>
<H3><A NAME="Description">4.8.2. Description</A></H3>
<P>Calculates the value of the enclosed arithmetic expression.</P>
<P>Use it as follows: [calc] <I>Expression</I> [/calc]</P>
<P>The enclosed region where the arguments are calculated according to normal arithmetic symbols. For instance:</P>
<PRE>
    [calc] 2 + 2 [/calc]
</PRE>
<P>will expand to:</P>
<PRE>
    4
</PRE>
<P>The [calc] tag is really the same as the [<A HREF="#perl">perl</A>] tag, except that it doesn't accept arguments, interpolates surrounded Interchange tags by default, and is slightly more efficient to parse.</P>
<P>Tip: The [calc] tag will remember variable values inside one page, so you can do the equivalent of a memory store and memory recall for a loop.</P>
<P>ASP Note: There is never a reason to call this tag from within Perl or ASP code.</P>
<H2><A NAME="calcn">4.9. calcn</A></H2>
<P>Calculates the value of the enclosed arithmetic expression.</P>
<H3><A NAME="Summary">4.9.1. Summary</A></H3>
<PRE>
    [<B>calcn</B>] <I>Expression</I> [/calcn]
</PRE>
<P><B>No parameters</B></P>
<P><B>No attributes</B></P>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>ASP-like Perl call:</B></P>
<P>There is never a reason to call this tag from within Perl or ASP code. Simply do the calculation directly.</P>
<H3><A NAME="Description">4.9.2. Description</A></H3>
<P>Equivalent to the [<A HREF="#calc">calc</A>] tag, except that it does not <A HREF="#attr_interpolate">interpolate</A> by default.</P>
<P>NOTE: This tag was introduced in Interchange 4.9 and is therefore not available in earlier versions.</P>
<H2><A NAME="cart">4.10. cart</A></H2>
<H3><A NAME="Summary">4.10.1. Summary</A></H3>
<P>Parameters: <B>name</B></P>
<P>Positional parameters in same order.</P>
<P>Pass attribute hash as last to subroutine: <B>no</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>Invalidates cache: <B>YES</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;cart(
        {
         name =&gt; VALUE,
        }
    )

 OR

    $Tag-&gt;cart($name);
    [<B>cart</B> name]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#cart_name">name</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>YES</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [cart name]
---
    TAG RESULT
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;cart(  { name =&gt; VALUE_name
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;cart(name, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.10.2. Description</A></H3>
<P>Sets the name of the current shopping cart for display of shipping, price, total, subtotal, shipping, and nitems tags.</P>
<H4><A NAME="cart_name"> </A>4.10.2.1. <A NAME="cart_name">name</A></H4>
<H2><A NAME="catch">4.11. catch</A></H2>
<P>The page content contained within the [<TT>catch</TT> <I>label</I>][<TT>/catch</TT>] block executes if the correspondingly labelled  <A HREF="#try">try</A> block fails.</P>
<P>You can also return a result based on the error message caught in the try block with paired subtags, like this:</P>
<PRE>
    [<I>error message</I>]body text[/<I>error message</I>]
</PRE>
<P>Note that this feature excises <I>all</I> tag/endtag pairs if interpolation is turned off, so the <TT>catch</TT> tag interpolates by default.</P>
<P>See also [<A HREF="#try">try</A>].</P>
<H3><A NAME="Summary">4.11.1. Summary</A></H3>
<PRE>
    [<B>try</B> <I>my_label</I>]
        <I>Body text to return if no error</I>
    [<B>/try</B>]
    .
    .
    .
    [<B>catch</B> label=<I>my_label</I> <I>other_named_attributes</I>]
        [/<I>Pattern matching error message 1</I>/]
            Return this if error 1 occurs
        [/<I>Pattern matching error message 1</I>/]

        [/<I>Pattern matching error message 2</I>/]
            Return this if error 2 occurs, <I>etc.</I>
        [/<I>Pattern matching error message 2</I>/]

        <I>Default body text to process if try block caused an error</I>
    [<B>/catch</B>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#catch_label">label</A>
</TD>
<TD VALIGN='Top'>
The label shared by the paired <A HREF="#try">try</A> and <TT>catch</TT> blocks
</TD>
<TD VALIGN='Top'>
'default'
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate</A>
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_reparse">reparse</A>
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
Yes
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<UL>
[<I>Error message text</I>]<UL>
body</UL>
<BR>
[<I>/Error message text</I>]</UL>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example</B></P>
<P>Ignoring whitespace, the following would return division result if successful, 0 on a division by zero, or an error message:</P>
<PRE>
    [set divisor]0[/set]
    [try label=div]
        [perl] eval(1 / [scratch divisor]) [/perl]
    [/try]
    [catch div]
        [/Illegal division by zero/]
            0
        [/Illegal division by zero/]
        [/eval &quot;string&quot; trapped by operation mask/]
            Perl <A HREF="http://www.perl.com/pub/doc/manual/html/lib/Safe.html">Safe</A> error
        [/eval &quot;string&quot; trapped by operation mask/]
        Other division error
    [/catch]
---
   Perl <A HREF="http://www.perl.com/pub/doc/manual/html/lib/Safe.html">Safe</A> error
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;catch(  { label =&gt; I&lt;'my_label'&gt;, },
                  $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;catch($label, $attribute_hash_reference, $body);
</PRE>
<H4><A NAME="See Also">4.11.1.1. See Also</A></H4>
<P><A HREF="#try">try</A></P>
<PRE>
    [catch]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [catch]
---
    TAG RESULT
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;catch(  {
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;catch(, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.11.2. Description</A></H3>
<P>The page content contained within the [<TT>catch</TT> <I>label</I>][<TT>/catch</TT>] block executes if the correspondingly labelled  <A HREF="#try">try</A> block fails. The catch block executes in place on the page if triggered (<I>i.e.</I>, it does not return its result in place of the try block).</P>
<P>You can also return a result based on the error message caught in the try block with paired subtags, like this:</P>
<PRE>
    [/<I>error message</I>/]special catch block for the error[/<I>error message</I>/]
</PRE>
<P>The error message to use in the special block will generally be part of the entry the error generates in your error log.  For example, a division by zero error generates something like the following in the error log:</P>
<PRE>
   127.0.0.1 4cU3Pgsh:127.0.0.1 - [24/May/2001:14:45:07 -0400]\
   tag /cgi-bin/tag72/tag <A HREF="http://www.perl.com/pub/doc/manual/html/lib/Safe.html">Safe</A>: Illegal division by zero\
   at (eval 526) line 2.
</PRE>
<P>(note that trailing backslashes in the example indicate a continued line).</P>
<H4><A NAME="catch_label"> </A>4.11.2.1. <A NAME="catch_label">label</A></H4>
<P>This is the label specifying the corresponding [<A HREF="#try">try</A> block. Defaults to 'default'.</P>
<H2><A NAME="cgi">4.12. cgi</A></H2>
<P>Returns the the current value of the named CGI input variable. HTML-escapes Interchange tags in the result for security.</P>
<P>Can also set a new CGI value within the current page.</P>
<H3><A NAME="Summary">4.12.1. Summary</A></H3>
<PRE>
    [<B>cgi</B> name]
    [<B>cgi</B> name=<I>cgi_var_name</I> <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#cgi_name">name</A>
</TD>
<TD VALIGN='Top'>
This is the name of the CGI variable whose value you want.
</TD>
<TD VALIGN='Top'>
<I>None</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#cgi_set">set</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#cgi_hide">hide</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#cgi_filter">filter</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#cgi_keep">keep</A> (with filter)
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#cgi_enable_html">enable_html</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<P>Assuming CGI variable 'foo' = 'bar',</P>
<PRE>
    [cgi foo]
---
    bar
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;cgi( { name =&gt; var_name } );

    <I># or if you simply want the value:</I>
    $CGI-&gt;{var_name};

    <I># or:</I>
    $CGI::values{var_name};
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;cgi($name, $attribute_hash_reference);
</PRE>
<H3><A NAME="Description">4.12.2. Description</A></H3>
<P>Displays the value of a CGI variable <B>submitted to the current page</B>. This is similar to [<A HREF="#value">value</A> ...], except it displays the transitory values that have been submitted with the current request.</P>
<P>For instance, if you access the following URL:</P>
<PRE>
        http://VENDURL/pagename?foo=bar
</PRE>
<P><TT>bar</TT> will be substituted for <TT>[cgi foo]</TT>.</P>
<P>This is the same as $CGI-&gt;{foo} in embedded Perl.</P>
<H4><A NAME="cgi_name"> </A>4.12.2.1. <A NAME="cgi_name">name</A></H4>
<P>This is the name of the CGI variable whose value you want.</P>
<H4><A NAME="cgi_set"> </A>4.12.2.2. <A NAME="cgi_set">set</A></H4>
<P>You can change a value with '<TT>set</TT>=<I>new_value</I>'. The tag will return the CGI value you set unless you also set the <A HREF="#cgi_hide">hide</A>=1 attribute.</P>
<P>Note that this is only available in new-style tags, for safety reasons.</P>
<H4><A NAME="cgi_hide"> </A>4.12.2.3. <A NAME="cgi_hide">hide</A></H4>
<P>Setting <TT>hide</TT>=1 suppresses the tag's return value, which can be useful with the <A HREF="#cgi_set">set</A> attribute.</P>
<H4><A NAME="cgi_filter"> </A>4.12.2.4. <A NAME="cgi_filter">filter</A></H4>
<P>See the <A HREF="#filter">filter</A> tag for a list of filters.</P>
<P>Setting '<TT>filter</TT>=&quot;<I>filter</I>&quot;' modifies the named CGI variable with the specified filter.</P>
<H4><A NAME="cgi_keep (with filter)"> </A>4.12.2.5. <A NAME="cgi_keep">keep</A> (with filter)</H4>
<P>Set <TT>keep</TT>=1 if you want the tag to return a filtered result but do not want the filter to modify the CGI value itself in the $CGI::values hash.</P>
<H4><A NAME="cgi_default"> </A>4.12.2.6. <A NAME="cgi_default">default</A></H4>
<P>This sets a return value in case the named CGI variable is missing or otherwise false. The following will expand to &quot;Using default&quot;:</P>
<PRE>
    [cgi name=myname set=0 hide=1]
    [cgi name=myname default=&quot;Using default&quot;]
</PRE>
<H4><A NAME="cgi_enable_html"> </A>4.12.2.7. <A NAME="cgi_enable_html">enable_html</A></H4>
<P>Any '&lt;' characters will normally be converted into '&amp;lt;' for safety reasons. This conversion can be disabled using '<TT>enable_html</TT>=1'.</P>
<H2><A NAME="checked">4.13. checked</A></H2>
<H3><A NAME="Summary">4.13.1. Summary</A></H3>
<P>Parameters: <B>name value</B></P>
<P>Positional parameters in same order.</P>
<P><B>The attribute hash reference is passed</B> to the subroutine after the parameters as the last argument. <B>This may mean that there are parameters not shown here.</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>Invalidates cache: <B>YES</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;checked(
        {
         name =&gt; VALUE,
         value =&gt; VALUE,
        }
    )

 OR

    $Tag-&gt;checked($name, $value, $ATTRHASH);
    [<B>checked</B> name value <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#checked_case">case</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#checked_cgi">cgi</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#checked_default">default</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#checked_name">name</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#checked_multiple">multiple</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#checked_value">value</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>YES</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [value name=example set=neato]
    &lt;INPUT TYPE=checkbox NAME=neato VALUE=1 [checked name=neato value=1]&gt;
    &lt;INPUT TYPE=checkbox NAME=silly VALUE=1 [checked name=silly value=1]&gt;
    &lt;INPUT TYPE=checkbox NAME=neato VALUE=1 CHECKED&gt;
    &lt;INPUT TYPE=checkbox NAME=silly VALUE=1 &gt;
</PRE>
<H3><A NAME="Description">4.13.2. Description</A></H3>
<P>You can provide a &quot;memory&quot; for drop-down menus, radio buttons, and checkboxes with the [checked] and [selected] tags.</P>
<PRE>
    &lt;INPUT TYPE=radio NAME=foo
            VALUE=on [checked name=foo value=on default=1]&gt;
    &lt;INPUT TYPE=radio NAME=foo
            VALUE=off [checked name=foo value=off]&gt;
</PRE>
<P>This will output CHECKED if the variable <TT>var_name</TT> is equal to <TT>value</TT>. Not case sensitive unless the optional <TT>case=1</TT> parameter is used.</P>
<P>The <TT>default</TT> parameter, if true (non-zero and non-blank), will cause the box to be checked if the variable has never been defined.</P>
<P>Note that CHECKBOX items will never submit their value if not checked, so the box will not be reset. You must do something like:</P>
<PRE>
    &lt;INPUT TYPE=checkbox NAME=foo
            VALUE=1 [checked name=foo value=1 default=1]&gt;
    [value name=foo set=&quot;&quot;]
</PRE>
<P>By default, the Values space (i.e. [value foo]) is checked&nbsp;-- if you want to use the volatile CGI space (i.e. [cgi foo]) use the option <TT>cgi=1</TT>.</P>
<P>Use the parameter <TT>default=1</TT> to specify that this checkbox should be marked CHECKED if the value/CGI variable has never been set.</P>
<P>If the parameter <TT>multiple=1</TT> is set, the <TT>value</TT> parameter can contain multiple (stacked) values that should be checked, separated by ASCII null characters (&quot;\0&quot; in Perl).</P>
<H4><A NAME="checked_case"> </A>4.13.2.1. <A NAME="checked_case">case</A></H4>
<H4><A NAME="checked_cgi"> </A>4.13.2.2. <A NAME="checked_cgi">cgi</A></H4>
<H4><A NAME="checked_default"> </A>4.13.2.3. <A NAME="checked_default">default</A></H4>
<H4><A NAME="checked_name"> </A>4.13.2.4. <A NAME="checked_name">name</A></H4>
<H4><A NAME="checked_multiple"> </A>4.13.2.5. <A NAME="checked_multiple">multiple</A></H4>
<H4><A NAME="checked_value"> </A>4.13.2.6. <A NAME="checked_value">value</A></H4>
<H2><A NAME="control">4.14. control</A></H2>
<P>Returns named scratchpad field or copies named scratch variable to scratchpad. Returns value specified by 'default' attribute if scratchpad variable is undefined or empty. Calling without a name moves to next scratchpad. Calling without a name and 'reset=1' returns to first scratchpad page.</P>
<H3><A NAME="Summary">4.14.1. Summary</A></H3>
<PRE>
    [<B>control</B> name default <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#control_default">default</A>
</TD>
<TD VALIGN='Top'>
Value to return if scratchpad variable missing or empty
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#control_name">name</A>
</TD>
<TD VALIGN='Top'>
Name of scratchpad variable to set or return
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#control_reset">reset</A>
</TD>
<TD VALIGN='Top'>
Resets scratchpad (i.e. $::Control array) by setting special scratch variable 'control_index' to 0. Control_index is an index into the $::Control == $Vend::Session-&gt;{control} array of hashrefs.
<UL>
<LI>(must not specify name; may specify default)</UL>
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#control_set">set</A>
</TD>
<TD VALIGN='Top'>
Copies named scratch variable (i.e., from $::Scratch) to scratchpad with current control index.
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>no</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [control name default]
---
    TAG RESULT
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;control(  { default =&gt; VALUE_default
                      name =&gt; VALUE_name
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;control(name,default, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.14.2. Description</A></H3>
<P>Returns named scratchpad field or copies named scratch variable to scratchpad. Returns value specified by 'default' attribute if scratchpad variable is undefined or empty. Calling without a name moves to next scratchpad. Calling without a name and 'reset=1' returns to first scratchpad page.</P>
<H4><A NAME="control_default"> </A>4.14.2.1. <A NAME="control_default">default</A></H4>
<P>Value to return if scratchpad variable missing or empty</P>
<H4><A NAME="control_name"> </A>4.14.2.2. <A NAME="control_name">name</A></H4>
<P>Name of scratchpad variable to set or return</P>
<H4><A NAME="control_reset"> </A>4.14.2.3. <A NAME="control_reset">reset</A></H4>
<P>Resets scratchpad (i.e. $::Control array) by setting special scratch variable 'control_index' to 0. Control_index is an index into the $::Control == $Vend::Session-&gt;{control} array of hashrefs.</P>
<UL>
<LI>(must not specify name; may specify default)</UL>
<H4><A NAME="control_set"> </A>4.14.2.4. <A NAME="control_set">set</A></H4>
<P>Copies named scratch variable (i.e., from $::Scratch) to scratchpad with current control index.</P>
<H2><A NAME="control_set">4.15. control_set</A></H2>
<P>Bulk-sets scratchpad variables on the scratchpad page specified by 'index'. Note that, unlike [control], this does not copy values from scratch.</P>
<H3><A NAME="Summary">4.15.1. Summary</A></H3>
<P>This example sets var_one, var_two and var_three in the scratchpad on page 5 (index begins with 0).</P>
<PRE>
    [control_set index=4]
        [var_one]<I>var_one_value</I>[/var_one]
        [var_two]<I>var_two_value</I>[/var_two]
        [var_three]<I>var_three_value</I>[/var_three]
    [/control_set]
</PRE>
<P>Parameters: <B>index</B></P>
<P>Positional parameters in same order.</P>
<P><B>The attribute hash reference is passed</B> after the parameters but before the container text argument. <B>This may mean that there are parameters not shown here.</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>This is a container tag, i.e. [control_set] FOO [/control_set]. Nesting: NO</P>
<P>Invalidates cache: <B>no</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;control_set(
        {
         index =&gt; VALUE,
        },
        BODY
    )

 OR

    $Tag-&gt;control_set($index, $ATTRHASH, $BODY);
    [<B>control_set</B> index <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#control_set_index">index</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_reparse">reparse</A>
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>no</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [control_set index]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;control_set(  { <B>index</B> =&gt; VALUE_index
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;control_set(<B>index</B>, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.15.2. Description</A></H3>
<P>Bulk-sets scratchpad variables on the scratchpad page specified by 'index'. Note that, unlike [control], this does not copy values from scratch.</P>
<H4><A NAME="control_set_index"> </A>4.15.2.1. <A NAME="control_set_index">index</A></H4>
<H2><A NAME="counter">4.16. counter</A></H2>
<H3><A NAME="Summary">4.16.1. Summary</A></H3>
<P>Parameters: <B>file</B></P>
<P>Positional parameters in same order.</P>
<P>Invalidates cache: <B>YES</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;counter(
        {
         file =&gt; VALUE,
         sql =&gt; VALUE,
         start =&gt; VALUE,
        }
    )

 OR

    $Tag-&gt;counter($file, $ATTRHASH);
</PRE>
<P>Attribute aliases</P>
<PRE>
            name ==&gt; file
    [<B>counter</B> file]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#counter_file">file</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#counter_file">name</A>
</TD>
<TD VALIGN='Top'>
Alias for file
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>YES</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [counter file]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;counter(  { file =&gt; VALUE_file, sql =&gt; <TT>'table:seq'</TT>, start =&gt; VALUE, }  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;counter(file, $attribute_hash_reference);
</PRE>
<H3><A NAME="Description">4.16.2. Description</A></H3>
<P>Manipulates a persistent counter, by default incrementing it and returning the new value.</P>
<P>The counter value is stored in the specified file. If the file name begins with a &quot;/&quot; then it is an absolute path. Otherwise, it is relative to VendRoot. The default file is <TT>etc/counter</TT>. If the file does not exist, it is created and initialized to the value of the <TT>start</TT> parameter.</P>
<P>The counter is implemented using Perl's <TT>File::Counter</TT> module, which protects the file against simultaneous access by multiple processes.</P>
<P>If the optional <TT>sql</TT> attribute is used, a SQL sequence will be used. Currently MySQL and Postgres are supported. The sequence must already exist. If no <TT>bypass</TT> parameter is sent, the table in the sequence callout (explained below) will be used and must be an Interchange table (i.e. set up with Database setting). If <TT>bypass</TT> is set, then the DSN for the sequence will be passed in the <TT>dsn</TT> parameter.</P>
<P>WARNING: This tag may not work under <A HREF="http://www.perl.com/pub/doc/manual/html/lib/Safe.html">Safe</A>, i.e. in embedded Perl.</P>
<P>Additional parameters:</P>
<H4><A NAME="counter_decrement"> </A>4.16.2.1. <A NAME="counter_decrement">decrement=1</A></H4>
<P>Causes the counter to count down instead of up. This option is not applicable to SQL counters.</P>
<H4><A NAME="counter_start"> </A>4.16.2.2. <A NAME="counter_start">start=50</A></H4>
<P>Causes a new counter to be created and to start from 50 (for example) if it did not exist before. This option is not applicable to SQL counters.</P>
<H4><A NAME="counter_value"> </A>4.16.2.3. <A NAME="counter_value">value=1</A></H4>
<P>Shows the value of the counter without incrementing or decrementing it. This option is not applicable to SQL counters.</P>
<H4><A NAME="counter_sql"> </A>4.16.2.4. <A NAME="counter_sql">sql=&quot;table:sequence&quot;</A></H4>
<P>The table and sequence name of the SQL counter.</P>
<P>If the type of database is Postgres, the <TT>table</TT> is used to derive the database and the sequence will be a named sequence independent of the table; the sequence is incremented and accessed by &quot;SELECT nextval('sequence_name')&quot;.</P>
<P>If the type of database is MySQL, an AUTO_INCREMENT key column is assumed and an insert of <TT>0</TT> followed by &quot;select last_insert_id()&quot; will increment then access the counter.</P>
<H4><A NAME="counter_file"> </A>4.16.2.5. <A NAME="counter_file">file</A></H4>
<H3><A NAME="SQL Counter Examples">4.16.3. SQL Counter Examples</A></H3>
<P>To set up a Postgres counter, simply create a named sequence in the database:</P>
<PRE>
  CREATE SEQUENCE &quot;foo&quot; start 1 increment 1 maxvalue 2147483647 minvalue 1 cache 1
</PRE>
<P>You will want to make sure you have an Interchange table that uses that database (&quot;sometable&quot; in the below example).</P>
<P>Then access it with:</P>
<PRE>
    [counter sql=&quot;sometable:foo&quot;]
</PRE>
<P>You can create as many sequences as you like.</P>
<P>To set up a MySQL counter, add a table to your MySQL database in catalog.cfg or other place like <TT>dbconf/mysql</TT>:</P>
<PRE>
  Database sequence_name sequence_name.txt dbi:mysql:test_foundation
  Database sequence_name COLUMN_DEF &quot;id=int NOT NULL AUTO_INCREMENT PRIMARY KEY&quot;
</PRE>
<P>Make sure you set up the sequence.txt file if you want Interchange to create the table for you. Otherwise you can create the table yourself from a mysql client:</P>
<P>mysql&gt; create table sequence_name(id int NOT NULL AUTO_INCREMENT PRIMARY KEY);</P>
<P>Then access it with:</P>
<PRE>
    [counter sql=&quot;sequence_name:sequence_name&quot;]
</PRE>
<P>Alternatively, you can create the table without Interchange definition as long as it is in the same database as an Interchange table:</P>
<PRE>
  mysql&gt; create table sequence_name(id int NOT NULL AUTO_INCREMENT PRIMARY KEY);
</PRE>
<P>Then access it by calling the Interchange-defined table name followed by the table that has the AUTO_INCREMENT key:</P>
<PRE>
    [counter sql=&quot;products:sequence_name&quot;]
</PRE>
<P>To set up an Oracle counter, create a sequence:</P>
<PRE>
  SQL&gt; CREATE SEQUENCE foo START WITH 10000 INCREMENT BY 1
                 MAXVALUE 2147483647 MINVALUE 1 CACHE 2;
</PRE>
<P>Then access via a table already connected to Oracle, in below <TT>sometable</TT>:</P>
<PRE>
    [counter sql=&quot;sometable:foo&quot;]
  Database sequence_name sequence_name.txt dbi:mysql:test_foundation
  Database sequence_name COLUMN_DEF &quot;id=int NOT NULL AUTO_INCREMENT PRIMARY KEY&quot;
</PRE>
<P>Make sure you set up the sequence.txt file if you want Interchange to create the table for you. Otherwise you can create the table yourself from a mysql client:</P>
<P>mysql&gt; create table sequence_name(id int NOT NULL AUTO_INCREMENT PRIMARY KEY);</P>
<P>Then access it with:</P>
<PRE>
    [counter sql=&quot;sequence_name:sequence_name&quot;]
</PRE>
<P>Alternatively, you can create the table without Interchange definition as long as it is in the same database as an Interchange table:</P>
<PRE>
  mysql&gt; create table sequence_name(id int NOT NULL AUTO_INCREMENT PRIMARY KEY);
</PRE>
<P>Then access it by calling the Interchange-defined table name followed by the table that has the AUTO_INCREMENT key:</P>
<PRE>
    [counter sql=&quot;products:sequence_name&quot;]
</PRE>
<H2><A NAME="currency">4.17. currency</A></H2>
<H3><A NAME="Summary">4.17.1. Summary</A></H3>
<P>Parameters: <B>convert noformat</B></P>
<P>Positional parameters in same order.</P>
<P>Pass attribute hash as last to subroutine: <B>no</B></P>
<P>Interpolates <B>container text</B> by default.</P>
<P>This is a container tag, i.e. [currency] FOO [/currency]. Nesting: NO</P>
<P>Invalidates cache: <B>no</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;currency(
        {
         convert =&gt; VALUE,
         noformat =&gt; VALUE,
        },
        BODY
    )

 OR

    $Tag-&gt;currency($convert, $noformat, $BODY);
    [<B>currency</B> convert noformat]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#currency_convert">convert</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#currency_noformat">noformat</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_reparse">reparse</A>
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>no</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [currency convert noformat]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;currency(  { convert =&gt; VALUE_convert
                       noformat =&gt; VALUE_noformat
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;currency(convert,noformat, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.17.2. Description</A></H3>
<P>When passed a value of a single number, formats it according to the currency specification. For instance:</P>
<PRE>
    [currency]4[/currency]
</PRE>
<P>will display:</P>
<PRE>
    4.00
</PRE>
<P>or something else depending on the <I>Locale</I> and PriceCommas settings. It can contain a [calc] region. If the optional &quot;convert&quot; parameter is set, it will convert the value according to PriceDivide&gt; for the current locale. If Locale is set to <TT>fr_FR</TT>, and <TT>PriceDivide</TT> for <TT>fr_FR</TT> is 0.167, the following sequence</P>
<PRE>
    [currency convert=1] [calc] 500.00 + 1000.00 [/calc] [/currency]
</PRE>
<P>will cause the number 8.982,04 to be displayed.</P>
<H4><A NAME="currency_convert"> </A>4.17.2.1. <A NAME="currency_convert">convert</A></H4>
<H4><A NAME="currency_noformat"> </A>4.17.2.2. <A NAME="currency_noformat">noformat</A></H4>
<H2><A NAME="data">4.18. data</A></H2>
<H3><A NAME="Summary">4.18.1. Summary</A></H3>
<P>Parameters: <B>table field key</B></P>
<P>Positional parameters in same order.</P>
<P><B>The attribute hash reference is passed</B> to the subroutine after the parameters as the last argument. <B>This may mean that there are parameters not shown here.</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>Invalidates cache: <B>no</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;data(
        {
         table =&gt; VALUE,
         field =&gt; VALUE,
         key =&gt; VALUE,
        }
    )

 OR

    $Tag-&gt;data($table, $field, $key, $ATTRHASH);
</PRE>
<P>Attribute aliases</P>
<PRE>
            base ==&gt; table
            code ==&gt; key
            col ==&gt; field
            column ==&gt; field
            database ==&gt; table
            name ==&gt; field
            row ==&gt; key
    [<B>data</B> table field key <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#data_table">base</A>
</TD>
<TD VALIGN='Top'>
Alias for table
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#data_key">code</A>
</TD>
<TD VALIGN='Top'>
Alias for key
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#data_field">col</A>
</TD>
<TD VALIGN='Top'>
Alias for field
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#data_field">column</A>
</TD>
<TD VALIGN='Top'>
Alias for field
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#data_table">database</A>
</TD>
<TD VALIGN='Top'>
Alias for table
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#data_field">field</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#data_hash">hash</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#data_key">key</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#data_field">name</A>
</TD>
<TD VALIGN='Top'>
Alias for field
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#data_key">row</A>
</TD>
<TD VALIGN='Top'>
Alias for key
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#data_table">table</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>no</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [data table field key]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;data(  { field =&gt; VALUE_field
                   key =&gt; VALUE_key
                   table =&gt; VALUE_table
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;data(table,field,key, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.18.2. Description</A></H3>
<P>Syntax:             [data table=db_table column=column_name key=key filter=&quot;uc|lc|name|namecase|no_white|etc.&quot;* append=1* value=&quot;value to set to&quot;* increment=1*]</P>
<P>Returns the value of the field in a database table, or from the <TT>session</TT> namespace. If the optional <B>value</B> is supplied, the entry will be changed to that value. If the option increment* is present, the field will be atomically incremented with the value in <B>value</B>. Use negative numbers in <TT>value</TT> to decrement. The <TT>append</TT> attribute causes the value to be appended; and finally, the <TT>filter</TT> attribute is a set of Interchange filters that are applied to the data 1) after it is read; or 2)before it is placed in the table.</P>
<P>If a DBM-based database is to be modified, it must be flagged writable on the page calling the write tag. Use [tag flag write]products[/tag] to mark the <TT>products</TT> database writable, for example. <B>This must be done before ANY access to that table.</B></P>
<P>In addition, the <TT>[data ...]</TT> tag can access a number of elements in the Interchange session database:</P>
<PRE>
    accesses           Accesses within the last 30 seconds
    arg                The argument passed in a [page ...] or [area ...] tag
    browser            The user browser string
    cybercash_error    Error from last CyberCash operation
    cybercash_result   Hash of results from CyberCash (access with usertag)
    host               Interchange's idea of the host (modified by DomainTail)
    last_error         The last error from the error logging
    last_url           The current Interchange path_info
    logged_in          Whether the user is logged in (add-on UserDB feature)
    pageCount          Number of unique URLs generated
    prev_url           The previous path_info
    referer            HTTP_REFERER string
    ship_message       The last error messages from shipping
    source             Source of original entry to Interchange
    time               Time (seconds since Jan 1, 1970) of last access
    user               The REMOTE_USER string
    username           User name logged in as (UserDB feature)
</PRE>
<P>Note: Databases will hide session values, so don't name a database &quot;session&quot;. or you won't be able to use the [data ...] tag to read them. Case is sensitive, so in a pinch you could call the database &quot;Session&quot;, but it would be better not to use that name at all.</P>
<H4><A NAME="data_field"> </A>4.18.2.1. <A NAME="data_field">field</A></H4>
<P>The name of the field whose value you want to fetch. Required unless returning the entire row in combination with the <TT>hash</TT> option.</P>
<H4><A NAME="data_hash"> </A>4.18.2.2. <A NAME="data_hash">hash</A></H4>
<P>The hash option causes the data tag to return its results (the entire row, if you omit the field parameter) as a reference to a hash with column names as keys into the values of the row.</P>
<P>An example:</P>
<PRE>
        $row_hash = $Tag-&gt;data({
                table =&gt; <TT>'products'</TT>,
                key   =&gt; <TT>'os28004'</TT>,
                hash  =&gt; 1,
        });
</PRE>
<P>You could then access desired values this way:</P>
<PRE>
        $out = <TT>'Price: '</TT> . $row_hash-&gt;{price};
</PRE>
<H4><A NAME="data_key"> </A>4.18.2.3. <A NAME="data_key">key</A></H4>
<P>The key that identifies the row containing the value(s) you want to fetch. Required.</P>
<H4><A NAME="data_table"> </A>4.18.2.4. <A NAME="data_table">table</A></H4>
<P>The name of the Interchange-defined table you want to fetch data from. Required.</P>
<H2><A NAME="default">4.19. default</A></H2>
<H3><A NAME="Summary">4.19.1. Summary</A></H3>
<P>Parameters: <B>name default</B></P>
<P>Positional parameters in same order.</P>
<P><B>The attribute hash reference is passed</B> to the subroutine after the parameters as the last argument. <B>This may mean that there are parameters not shown here.</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>Invalidates cache: <B>YES</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;default(
        {
         name =&gt; VALUE,
         default =&gt; VALUE,
        }
    )

 OR

    $Tag-&gt;default($name, $default, $ATTRHASH);
    [<B>default</B> name default <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#default_default">default</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#default_name">name</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>YES</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [default name default]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;default(  { default =&gt; VALUE_default
                      name =&gt; VALUE_name
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;default(name,default, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.19.2. Description</A></H3>
<P>Returns the value of the user form variable <TT>variable</TT> if it is non-empty. Otherwise returns <TT>default</TT>, which is the string &quot;default&quot; if there is no default supplied. Got that? This tag is DEPRECATED anyway.</P>
<H4><A NAME="default_default"> </A>4.19.2.1. <A NAME="default_default">default</A></H4>
<H4><A NAME="default_name"> </A>4.19.2.2. <A NAME="default_name">name</A></H4>
<H2><A NAME="description">4.20. description</A></H2>
<H3><A NAME="Summary">4.20.1. Summary</A></H3>
<P>Parameters: <B>code base</B></P>
<P>Positional parameters in same order.</P>
<P>Pass attribute hash as last to subroutine: <B>no</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>Invalidates cache: <B>no</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;description(
        {
         code =&gt; VALUE,
         base =&gt; VALUE,
        }
    )

 OR

    $Tag-&gt;description($code, $base);
    [<B>description</B> code base]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#description_base">base</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#description_code">code</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>no</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [description code base]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;description(  { base =&gt; VALUE_base
                          code =&gt; VALUE_code
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;description(code,base, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.20.2. Description</A></H3>
<P>Expands into the description of the product identified by code as found in the products database. This is the value of the database field that corresponds to the <TT>catalog.cfg</TT> directive <TT>DescriptionField</TT>. If there is more than one products file defined, they will be searched in order unless constrained by the optional argument <B>base</B>.</P>
<P>This tag is especially useful for multi-language catalogs. The <TT>DescriptionField</TT> directive can be set for each locale and point to a different database field; for example <TT>desc_en</TT> for English, <TT>desc_fr</TT> for French, etc.</P>
<H4><A NAME="description_base"> </A>4.20.2.1. <A NAME="description_base">base</A></H4>
<H4><A NAME="description_code"> </A>4.20.2.2. <A NAME="description_code">code</A></H4>
<H2><A NAME="discount">4.21. discount</A></H2>
<H3><A NAME="Summary">4.21.1. Summary</A></H3>
<P>Parameters: <B>code</B></P>
<P>Positional parameters in same order.</P>
<P>Pass attribute hash as last to subroutine: <B>no</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>This is a container tag, i.e. [discount] FOO [/discount]. Nesting: NO</P>
<P>Invalidates cache: <B>YES</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;discount(
        {
         code =&gt; VALUE,
        },
        BODY
    )

 OR

    $Tag-&gt;discount($code, $BODY);
    [<B>discount</B> code]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#discount_code">code</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_reparse">reparse</A>
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>YES</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [discount code]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;discount(  { code =&gt; VALUE_code
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;discount(code, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.21.2. Description</A></H3>
<P>Product discounts can be set upon display of any page. The discounts apply only to the customer receiving them, and are of one of three types:</P>
<PRE>
    1. A discount for one particular item code (code/key is the item-code)
    2. A discount applying to all item codes (code/key is ALL_ITEMS)
    3. A discount applied after all items are totaled
       (code/key is ENTIRE_ORDER)
</PRE>
<P>The discounts are specified via a formula. The formula is scanned for the variables $q and $s, which are substituted for with the item <I>quantity</I> and <I>subtotal</I> respectively. In the case of the item and all items discount, the formula must evaluate to a new subtotal for all items <I>of that code</I> that are ordered. The discount for the entire order is applied to the entire order, and would normally be a monetary amount to subtract or a flat percentage discount.</P>
<P>Discounts are applied to the effective price of the product, including any quantity discounts.</P>
<P>To apply a straight 20% discount to all items:</P>
<PRE>
    [discount ALL_ITEMS] $s * .8 [/discount]
</PRE>
<P>or with named attributes:</P>
<PRE>
    [discount code=ALL_ITEMS] $s * .8 [/discount]
</PRE>
<P>To take 25% off of only item 00-342:</P>
<PRE>
    [discount 00-342] $s * .75 [/discount]
</PRE>
<P>To subtract $5.00 from the customer's order:</P>
<PRE>
    [discount ENTIRE_ORDER] $s - 5 [/discount]
</PRE>
<P>To reset a discount, set it to the empty string:</P>
<PRE>
    [discount ALL_ITEMS][/discount]
</PRE>
<P>Perl code can be used to apply the discounts. Here is an example of a discount for item code 00-343 which prices the <I>second</I> one ordered at 1 cent:</P>
<PRE>
    [discount 00-343]
    return $s if $q == 1;
    my $p = $s/$q;
    my $t = ($q - 1) * $p;
    $t .= 0.01;
    return $t;
    [/discount]
</PRE>
<P>If you want to display the discount amount, use the [item-discount] tag.</P>
<PRE>
    [item-list]
    Discount for [item-code]: [item-discount]
    [/item-list]
</PRE>
<P>Finally, if you want to display the discounted subtotal in a way that doesn't correspond to a standard Interchange tag, you can use the [calc] tag:</P>
<PRE>
    [item-list]
    Discounted subtotal for [item-code]: [currency][calc]
                                            [item-price noformat] * [item-quantity]
                                            [/calc][/currency]
    [/item-list]
</PRE>
<H4><A NAME="discount_code"> </A>4.21.2.1. <A NAME="discount_code">code</A></H4>
<H2><A NAME="dump">4.22. dump</A></H2>
<P>Dumps client connection information, cart contents, query value, contents of environment, session, and CGI with Data::Dumper to the page. This is useful for debugging.</P>
<H3><A NAME="Summary">4.22.1. Summary</A></H3>
<P>No parameters.</P>
<P>Pass attribute hash as last to subroutine: <B>no</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>Invalidates cache: <B>no</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;dump(
        {
        }
    )

 OR

    $Tag-&gt;dump($);
    [<B>dump</B>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>no</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [dump]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;dump(  {
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;dump(, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.22.2. Description</A></H3>
<P>Dumps client connection information, cart contents, query value, contents of environment, session, and CGI with Data::Dumper to the page. This is useful for debugging.</P>
<H2><A NAME="ecml">4.23. ecml</A></H2>
<P>Uses ECML (Electronic Commerce Markup Language) module to map Interchange forms/userdb to ECML checkout</P>
<H3><A NAME="Summary">4.23.1. Summary</A></H3>
<PRE>
    [<B>ecml</B> name function <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#ecml_function">function</A>
</TD>
<TD VALIGN='Top'>
ecml function (default = 'widget')
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#ecml_name">name</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>no</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [ecml name function]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;ecml(  { function =&gt; VALUE_function
                   name =&gt; VALUE_name
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;ecml(name,function, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.23.2. Description</A></H3>
<P>This package implements the ECML standard for the Interchange demo. ECML stands for &quot;Electronic Commerce Modeling Language&quot;, but at this writing it is a simple standard for naming variables so that &quot;electronic wallets&quot; can pre-fill-in your checkout form based on users past purchase from other companies.</P>
<P>It translates into ECML from the following Interchange variables:</P>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>ECML</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Interchange variable</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_BillTo_Online_Email
</TD>
<TD VALIGN='Top'>
b_email
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_BillTo_Postal_City
</TD>
<TD VALIGN='Top'>
b_city
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_BillTo_Postal_CountryCode
</TD>
<TD VALIGN='Top'>
b_country
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_BillTo_Postal_Name_First
</TD>
<TD VALIGN='Top'>
b_fname
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_BillTo_Postal_Name_Last
</TD>
<TD VALIGN='Top'>
b_lname
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_BillTo_Postal_Name_Middle
</TD>
<TD VALIGN='Top'>
b_mname
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_BillTo_Postal_Name_Prefix
</TD>
<TD VALIGN='Top'>
b_title
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_BillTo_Postal_Name_Suffix
</TD>
<TD VALIGN='Top'>
b_name_suffix
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_BillTo_Postal_PostalCode
</TD>
<TD VALIGN='Top'>
b_zip
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_BillTo_Postal_StateProv
</TD>
<TD VALIGN='Top'>
b_state
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_BillTo_Postal_Street_Line1
</TD>
<TD VALIGN='Top'>
b_address1
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_BillTo_Postal_Street_Line2
</TD>
<TD VALIGN='Top'>
b_address2
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_BillTo_Postal_Street_Line3
</TD>
<TD VALIGN='Top'>
b_address3
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_BillTo_Telecom_Phone_Number
</TD>
<TD VALIGN='Top'>
b_phone_day
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_ConsumerOrderID
</TD>
<TD VALIGN='Top'>
mv_order_number
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_Payment_Card_ExpDate_Day
</TD>
<TD VALIGN='Top'>
mv_credit_card_exp_day
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_Payment_Card_ExpDate_Month
</TD>
<TD VALIGN='Top'>
mv_credit_card_exp_month
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_Payment_Card_ExpDate_Year
</TD>
<TD VALIGN='Top'>
mv_credit_card_exp_year
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_Payment_Card_Name
</TD>
<TD VALIGN='Top'>
c_name
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_Payment_Card_Number
</TD>
<TD VALIGN='Top'>
mv_credit_card_number
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_Payment_Card_Protocol
</TD>
<TD VALIGN='Top'>
payment_protocols_available
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_Payment_Card_Type
</TD>
<TD VALIGN='Top'>
mv_credit_card_type
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_Payment_Card_Verification
</TD>
<TD VALIGN='Top'>
mv_credit_card_verify
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_ReceiptTo_Online_Email
</TD>
<TD VALIGN='Top'>
r_email
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_ReceiptTo_Postal_City
</TD>
<TD VALIGN='Top'>
r_city
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_ReceiptTo_Postal_CountryCode
</TD>
<TD VALIGN='Top'>
r_country
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_ReceiptTo_Postal_Name_First
</TD>
<TD VALIGN='Top'>
r_fname
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_ReceiptTo_Postal_Name_Last
</TD>
<TD VALIGN='Top'>
r_lname
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_ReceiptTo_Postal_Name_Middle
</TD>
<TD VALIGN='Top'>
r_mname
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_ReceiptTo_Postal_Name_Prefix
</TD>
<TD VALIGN='Top'>
r_title
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_ReceiptTo_Postal_Name_Suffix
</TD>
<TD VALIGN='Top'>
r_name_suffix
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_ReceiptTo_Postal_PostalCode
</TD>
<TD VALIGN='Top'>
r_zip
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_ReceiptTo_Postal_StateProv
</TD>
<TD VALIGN='Top'>
r_state
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_ReceiptTo_Postal_Street_Line1
</TD>
<TD VALIGN='Top'>
r_address1
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_ReceiptTo_Postal_Street_Line2
</TD>
<TD VALIGN='Top'>
r_address2
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_ReceiptTo_Postal_Street_Line3
</TD>
<TD VALIGN='Top'>
r_address3
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_ReceiptTo_Telecom_Phone_Number
</TD>
<TD VALIGN='Top'>
r_phone
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_SchemaVersion
</TD>
<TD VALIGN='Top'>
ecml_version
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_ShipTo_Online_Email
</TD>
<TD VALIGN='Top'>
email
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_ShipTo_Postal_City
</TD>
<TD VALIGN='Top'>
city
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_ShipTo_Postal_CountryCode
</TD>
<TD VALIGN='Top'>
country
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_ShipTo_Postal_Name_Combined
</TD>
<TD VALIGN='Top'>
name
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_ShipTo_Postal_Name_First
</TD>
<TD VALIGN='Top'>
fname
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_ShipTo_Postal_Name_Last
</TD>
<TD VALIGN='Top'>
lname
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_ShipTo_Postal_Name_Middle
</TD>
<TD VALIGN='Top'>
mname
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_ShipTo_Postal_Name_Prefix
</TD>
<TD VALIGN='Top'>
title
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_ShipTo_Postal_Name_Suffix
</TD>
<TD VALIGN='Top'>
name_suffix
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_ShipTo_Postal_PostalCode
</TD>
<TD VALIGN='Top'>
zip
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_ShipTo_Postal_StateProv
</TD>
<TD VALIGN='Top'>
state
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_ShipTo_Postal_Street_Line1
</TD>
<TD VALIGN='Top'>
address1
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_ShipTo_Postal_Street_Line2
</TD>
<TD VALIGN='Top'>
address2
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_ShipTo_Postal_Street_Line3
</TD>
<TD VALIGN='Top'>
address3
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_ShipTo_Telecom_Phone_Number
</TD>
<TD VALIGN='Top'>
phone
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Ecom_TransactionComplete
</TD>
<TD VALIGN='Top'>
end_transaction_flag
</TD>
</TR>
</TABLE>

<P>Once the form variables are input and sent to Interchange, the [ecml function=mapback] tag will cause the input results to be mapped back from the ECML names to the Interchange names.</P>
<P>If you only have a <TT>name</TT> variable in your UserDB, the module will attempt to split it into first name and last name for ECML purposes and map the results back. If you have <TT>fname</TT> and <TT>lname</TT>, then it will not.</P>
<H4><A NAME="ecml_function"> </A>4.23.2.1. <A NAME="ecml_function">function</A></H4>
<P>ecml function (default = 'widget')</P>
<H4><A NAME="ecml_name"> </A>4.23.2.2. <A NAME="ecml_name">name</A></H4>
<H2><A NAME="either">4.24. either</A></H2>
<P>The [either]this[or]that[/either] implements a check for the first non-zero, non-blank value. It splits on [or], and then parses each piece in turn. If a value returns true (in the Perl sense: non-zero, non-blank) then subsequent pieces will be discarded without interpolation.</P>
<H3><A NAME="Summary">4.24.1. Summary</A></H3>
<PRE>
    [either]
        This
    [or]
        That
    [or]
        The other
    [/either]
</PRE>
<P>No parameters.</P>
<P>Pass attribute hash as last to subroutine: <B>no</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>This is a container tag, i.e. [either] FOO [/either]. Nesting: NO</P>
<P>Invalidates cache: <B>no</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;either(
        {
        },
        BODY
    )

 OR

    $Tag-&gt;either($BODY);
    [<B>either</B>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_reparse">reparse</A>
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>no</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [either]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;either(  {
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;either(, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.24.2. Description</A></H3>
<P><B>NO Description</B></P>
<H2><A NAME="error">4.25. error</A></H2>
<H3><A NAME="Summary">4.25.1. Summary</A></H3>
<P>Parameters: <B>name</B></P>
<P>Positional parameters in same order.</P>
<P><B>The attribute hash reference is passed</B> to the subroutine after the parameters as the last argument. <B>This may mean that there are parameters not shown here.</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>Invalidates cache: <B>no</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;error(
        {
         name =&gt; VALUE,
        }
    )

 OR

    $Tag-&gt;error($name, $ATTRHASH);
    [<B>error</B> name <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#error_name">name</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>no</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [error name]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;error(  { name =&gt; VALUE_name
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;error(name, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.25.2. Description</A></H3>
<PRE>
    [error var options]
        var is the error name, e.g. &quot;session&quot;
</PRE>
<P>The [error ...] tag is designed to manage form variable checking for the Interchange <TT>submit</TT> form processing action. It works in conjunction with the definition set in <TT>mv_order_profile</TT>, and can generate error messages in any format you desire.</P>
<P>If the variable in question passes order profile checking, it will output a label, by default <B>bold</B> text if the item is required, or normal text if not (controlled by the &lt;require&gt; parameter. If the variable fails one or more order checks, the error message will be substituted into a template and the error cleared from the user's session.</P>
<P>(Below is as of 4.03, the equivalent in 4.02 is [if type=explicit compare=&quot;[error all=1 keep=1]&quot;] ... [/if].)</P>
<P>To check errors without clearing them, you can use the idiom:</P>
<PRE>
    [if errors]
    &lt;FONT SIZE=&quot;+1&quot; COLOR=RED&gt;
        There were errors in your form submission.
    &lt;/FONT&gt;
    &lt;BLOCKQUOTE&gt;
        [error all=1 show_error=1 joiner=&quot;&lt;BR&gt;&quot;]
    &lt;/BLOCKQUOTE&gt;
    [/if]
</PRE>
<P>The options are:</P>
<H4><A NAME="error_all"> </A>4.25.2.1. <A NAME="error_all">all=1</A></H4>
<P>Display all error messages, not just the one referred to by &lt;var&gt;. The default is only display the error message assigned to &lt;var&gt;.</P>
<P>text=&lt;optional string to embed the error message(s) in&gt;</P>
<P>place a &quot;%s&quot; somewhere in 'text' to mark where you want the error message placed, otherwise it's appended on the end. This option also implies show_error.</P>
<H4><A NAME="error_joiner"> </A>4.25.2.2. <A NAME="error_joiner">joiner=</A><I>char</I></H4>
<P>Character used to join multiple error messages. Default is '\n', a newline.</P>
<H4><A NAME="error_keep"> </A>4.25.2.3. <A NAME="error_keep">keep=1</A></H4>
<P>keep=1 means don't delete the error messages after copy; anything else deletes them.</P>
<H4><A NAME="error_show_error"> </A>4.25.2.4. <A NAME="error_show_error">show_error=1</A></H4>
<P>show_error=1 means return the error message text; otherwise just the number of errors found is returned.</P>
<H4><A NAME="error_show_label"> </A>4.25.2.5. <A NAME="error_show_label">show_label=1</A></H4>
<P>show_label=1 causes the field label set by a previous [error] tag's std_label attribute (see below) to be included as part of the error message, like this:</P>
<PRE>
First Name: blank
</PRE>
<P>If no std_label was set, the variable name will be used instead. This can also be used in combination with show_var to show both the label and the variable name.</P>
<P>show_label was added in 4.7.0.</P>
<H4><A NAME="error_show_var"> </A>4.25.2.6. <A NAME="error_show_var">show_var=1</A></H4>
<P>show_var=1 includes the name of the variable the error was found in as part of the error message, like this:</P>
<PRE>
email: 'bob#nothing,net' not a valid email address
</PRE>
<H4><A NAME="error_std_label"> </A>4.25.2.7. <A NAME="error_std_label">std_label</A></H4>
<P>std_label=&lt;label string for error message&gt;</P>
<P>used with 'required' to display a standardized error format. The HTML formatting can be set via the global variable MV_ERROR_STD_LABEL with the default being:</P>
<PRE>
        &lt;FONT COLOR=RED&gt;{LABEL}&lt;SMALL&gt;&lt;I&gt;(%s)&lt;/I&gt;&lt;/SMALL&gt;&lt;/FONT&gt;
</PRE>
<P>where {LABEL} is what you set std_label to and %s is substituted with the error message. This option can not be used with the text= option.</P>
<H4><A NAME="error_required"> </A>4.25.2.8. <A NAME="error_required">required=1</A></H4>
<P>Specifies that this is a required field for formatting purposes. In the std_label format, it means the field will be bolded. If you specify your own label string, it will insert HTML anywhere you have {REQUIRED: HTML}, but only when the field is required.</P>
<H4><A NAME="error_name"> </A>4.25.2.9. <A NAME="error_name">name</A></H4>
<H2><A NAME="export">4.26. export</A></H2>
<P>Exports a database to a delimited text file (see also <A HREF="#import">import</A>).</P>
<H3><A NAME="Summary">4.26.1. Summary</A></H3>
<PRE>
    [<B>export</B> table <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#export_table">base</A>
</TD>
<TD VALIGN='Top'>
Alias for table
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#export_table">database</A>
</TD>
<TD VALIGN='Top'>
Alias for table
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#export_delete">delete</A>
</TD>
<TD VALIGN='Top'>
If 'verify' attribute also set, deletes column specified by 'field' attribute rather than adding a column.
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#export_field">field</A>
</TD>
<TD VALIGN='Top'>
The column to add (or delete if delete and verify are true)
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#export_file">file</A>
</TD>
<TD VALIGN='Top'>
Filename to export to. Note that the NoAbsolute directive and other conditions may affect actual location of the output file.
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#export_sort">sort</A>
</TD>
<TD VALIGN='Top'>
Output sorted rows (usage: sort=&quot;<I>sort_field</I>:<I>sort_option</I>&quot;) (see search/form variable 'mv_sort_option' for sort options)
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#export_table">table</A>
</TD>
<TD VALIGN='Top'>
The table to export
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#export_type">type</A>
</TD>
<TD VALIGN='Top'>
Specifies the [line, record] delimiter types. Either NOTES or one of the following:
<PRE>
  my %Delimiter = (
       2 =&gt; [&quot;\n&quot;, &quot;\n\n&quot;],
       3 =&gt; [&quot;\n%%\n&quot;, &quot;\n%%%\n&quot;],
       4 =&gt; [&quot;CSV&quot;,&quot;\n&quot;],
       5 =&gt; ['|', &quot;\n&quot;],
       6 =&gt; [&quot;\t&quot;, &quot;\n&quot;],
       7 =&gt; [&quot;\t&quot;, &quot;\n&quot;],
       8 =&gt; [&quot;\t&quot;, &quot;\n&quot;],
       LINE =&gt; [&quot;\n&quot;, &quot;\n\n&quot;],
       '%%%' =&gt; [&quot;\n%%\n&quot;, &quot;\n%%%\n&quot;],
       '%%' =&gt; [&quot;\n%%\n&quot;, &quot;\n%%%\n&quot;],
       CSV =&gt; [&quot;CSV&quot;,&quot;\n&quot;],
       PIPE =&gt; ['|', &quot;\n&quot;],
       TAB =&gt; [&quot;\t&quot;, &quot;\n&quot;],
       );
</PRE>
<UL>
<LI>If using NOTES<UL>
<LI>notes_separator (defaults to &quot;\f&quot;)
<LI>notes_field (defaults to &quot;notes_field&quot;)</UL></UL>
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#export_verify">verify</A>
</TD>
<TD VALIGN='Top'>
must be true when deleting a column
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>YES</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [export table]
---
    1
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;export(  { table =&gt; VALUE_table
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;export(table, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.26.2. Description</A></H3>
<P>Exports 'table' to a delimited text file. See also <A HREF="#import">import</A> tag which imports files into databases.</P>
<H4><A NAME="export_delete"> </A>4.26.2.1. <A NAME="export_delete">delete</A></H4>
<P>If 'verify' attribute also set, deletes column specified by 'field' attribute rather than adding a column.</P>
<H4><A NAME="export_field"> </A>4.26.2.2. <A NAME="export_field">field</A></H4>
<P>The column to add (or delete if delete and verify are true)</P>
<H4><A NAME="export_file"> </A>4.26.2.3. <A NAME="export_file">file</A></H4>
<P>Filename to export to. Note that the NoAbsolute directive and other conditions may affect actual location of the output file.</P>
<H4><A NAME="export_sort"> </A>4.26.2.4. <A NAME="export_sort">sort</A></H4>
<P>Output sorted rows (usage: sort=&quot;<I>sort_field</I>:<I>sort_option</I>&quot;) (see search/form variable 'mv_sort_option' for sort options)</P>
<H4><A NAME="export_table"> </A>4.26.2.5. <A NAME="export_table">table</A></H4>
<P>The table to export</P>
<H4><A NAME="export_type"> </A>4.26.2.6. <A NAME="export_type">type</A></H4>
<P>Specifies the [line, record] delimiter types. Either NOTES or one of the following:</P>
<PRE>
  my %Delimiter = (
        2 =&gt; [&quot;\n&quot;, &quot;\n\n&quot;],
        3 =&gt; [&quot;\n%%\n&quot;, &quot;\n%%%\n&quot;],
        4 =&gt; [&quot;CSV&quot;,&quot;\n&quot;],
        5 =&gt; ['|', &quot;\n&quot;],
        6 =&gt; [&quot;\t&quot;, &quot;\n&quot;],
        7 =&gt; [&quot;\t&quot;, &quot;\n&quot;],
        8 =&gt; [&quot;\t&quot;, &quot;\n&quot;],
        LINE =&gt; [&quot;\n&quot;, &quot;\n\n&quot;],
        '%%%' =&gt; [&quot;\n%%\n&quot;, &quot;\n%%%\n&quot;],
        '%%' =&gt; [&quot;\n%%\n&quot;, &quot;\n%%%\n&quot;],
        CSV =&gt; [&quot;CSV&quot;,&quot;\n&quot;],
        PIPE =&gt; ['|', &quot;\n&quot;],
        TAB =&gt; [&quot;\t&quot;, &quot;\n&quot;],
        );
</PRE>
<UL>
<LI>If using NOTES<UL>
<LI>notes_separator (defaults to &quot;\f&quot;)
<LI>notes_field (defaults to &quot;notes_field&quot;)</UL></UL>
<H4><A NAME="export_verify"> </A>4.26.2.7. <A NAME="export_verify">verify</A></H4>
<P>must be true when deleting a column</P>
<H2><A NAME="field">4.27. field</A></H2>
<H3><A NAME="Summary">4.27.1. Summary</A></H3>
<P>Parameters: <B>name code</B></P>
<P>Positional parameters in same order.</P>
<P>Pass attribute hash as last to subroutine: <B>no</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>Invalidates cache: <B>no</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;field(
        {
         name =&gt; VALUE,
         code =&gt; VALUE,
        }
    )

 OR

    $Tag-&gt;field($name, $code);
</PRE>
<P>Attribute aliases</P>
<PRE>
            col ==&gt; name
            column ==&gt; name
            field ==&gt; name
            key ==&gt; code
            row ==&gt; code
    [<B>field</B> name code]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#field_code">code</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#field_name">col</A>
</TD>
<TD VALIGN='Top'>
Alias for name
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#field_name">column</A>
</TD>
<TD VALIGN='Top'>
Alias for name
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#field_name">field</A>
</TD>
<TD VALIGN='Top'>
Alias for name
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#field_code">key</A>
</TD>
<TD VALIGN='Top'>
Alias for code
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#field_name">name</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#field_code">row</A>
</TD>
<TD VALIGN='Top'>
Alias for code
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>no</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [field name code]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;field(  { code =&gt; VALUE_code
                    name =&gt; VALUE_name
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;field(name,code, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.27.2. Description</A></H3>
<P>Expands into the value of the field <I>name</I> for the product identified by <I>code</I> as found by searching the products database. It will return the first entry found in the series of <I>Product Files</I>. the products database. If you want to constrain it to a particular database, use the [data base name code] tag.</P>
<P>Note that if you only have one ProductFile <TT>products</TT>, which is the default, <TT>[field column key]</TT> is the same as [<A HREF="#data">data</A> products column key].</P>
<H4><A NAME="field_code"> </A>4.27.2.1. <A NAME="field_code">code</A></H4>
<H4><A NAME="field_name"> </A>4.27.2.2. <A NAME="field_name">name</A></H4>
<H2><A NAME="file">4.28. file</A></H2>
<H3><A NAME="Summary">4.28.1. Summary</A></H3>
<P>Parameters: <B>name type</B></P>
<P>Positional parameters in same order.</P>
<P>Pass attribute hash as last to subroutine: <B>no</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>Invalidates cache: <B>no</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;file(
        {
         name =&gt; VALUE,
         type =&gt; VALUE,
        }
    )

 OR

    $Tag-&gt;file($name, $type);
    [<B>file</B> name type]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#file_name">name</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#file_type">type</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>no</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [file name type]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;file(  { name =&gt; VALUE_name
                   type =&gt; VALUE_type
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;file(name,type, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.28.2. Description</A></H3>
<P>Inserts the contents of the named file. The file should normally be relative to the catalog directory&nbsp;-- file names beginning with / or .. are not allowed if the Interchange server administrator has set <I>NoAbsolute</I> to <TT>Yes</TT>.</P>
<P>The optional <TT>type</TT> parameter will do an appropriate ASCII translation on the file before it is sent.</P>
<H4><A NAME="file_name"> </A>4.28.2.1. <A NAME="file_name">name</A></H4>
<H4><A NAME="file_type"> </A>4.28.2.2. <A NAME="file_type">type</A></H4>
<H2><A NAME="filter">4.29. filter</A></H2>
<H3><A NAME="Summary">4.29.1. Summary</A></H3>
<P>Parameters: <B>op</B></P>
<P>Positional parameters in same order.</P>
<P>Pass attribute hash as last to subroutine: <B>no</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>This is a container tag, i.e. [filter] FOO [/filter]. Nesting: NO</P>
<P>Invalidates cache: <B>no</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;filter(
        {
         op =&gt; VALUE,
        },
        BODY
    )

 OR

    $Tag-&gt;filter($op, $BODY);
    [<B>filter</B> op]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#filter_op">op</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_reparse">reparse</A>
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>no</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [filter op]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;filter(  { op =&gt; VALUE_op
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;filter(op, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.29.2. Description</A></H3>
<P>Applies any of Interchange's standard filters to an arbitrary value, or you may define your own. The filters are also available as parameters to the <TT>cgi</TT>, <TT>data</TT>, and <TT>value</TT> tags.</P>
<P>Filters can be applied in sequence and as many as needed can be applied.</P>
<P>Here is an example. If you store your author or artist names in the database &quot;LAST, First&quot; so that they sort properly, you still might want to display them normally as &quot;First Last&quot;. This call</P>
<PRE>
    [filter op=&quot;name namecase&quot;]WOOD, Grant[/filter]
</PRE>
<P>will display as</P>
<PRE>
    Grant Wood
</PRE>
<P>Another way to do this would be:</P>
<PRE>
    [data table=products column=artist key=99-102 filter=&quot;name namecase&quot;]
</PRE>
<P>Filters available include:</P>
<H4><A NAME="filter_op_cgi"> </A>4.29.2.1. <A NAME="filter_op_cgi">cgi</A></H4>
<P>Returns the value of the CGI variable. Useful for starting a filter sequence with a seed value.</P>
<PRE>
    'cgi' =&gt;    sub {
                    return $CGI::values(shift);
                },
</PRE>
<H4><A NAME="filter_op_digits"> </A>4.29.2.2. <A NAME="filter_op_digits">digits</A></H4>
<P>Returns only digits.</P>
<PRE>
    'digits' =&gt; sub {
                    my $val = shift;
                    $val =~ s/\D+//g;
                    return $val;
                },
</PRE>
<H4><A NAME="filter_op_digits_dot"> </A>4.29.2.3. <A NAME="filter_op_digits_dot">digits_dot</A></H4>
<P>Returns only digits and periods, i.e. [.0-9]. Useful for decommifying numbers.</P>
<PRE>
    'digits_dot' =&gt; sub {
                    my $val = shift;
                    $val =~ s/[^\d.]+//g;
                    return $val;
                },
</PRE>
<H4><A NAME="filter_op_dos"> </A>4.29.2.4. <A NAME="filter_op_dos">dos</A></H4>
<P>Turns linefeeds into carriage-return / linefeed pairs.</P>
<PRE>
    'dos' =&gt;    sub {
                    my $val = shift;
                    $val =~ s/\r?\n/\r\n/g;
                    return $val;
                },
</PRE>
<H4><A NAME="filter_op_entities"> </A>4.29.2.5. <A NAME="filter_op_entities">entities</A></H4>
<P>Changes <TT>&lt;</TT> to <TT>&amp;lt;</TT>, <TT>&quot;</TT> to <TT>&amp;quot;</TT>, etc.</P>
<PRE>
    'entities' =&gt; sub {
                    return HTML::Entities::encode(shift);
                },
</PRE>
<H4><A NAME="filter_op_gate"> </A>4.29.2.6. <A NAME="filter_op_gate">gate</A></H4>
<P>Performs a security screening by testing to make sure a corresponding scratch variable has been set.</P>
<PRE>
    'gate' =&gt;   sub {
                    my ($val, $var) = @_;
                    return '' unless $::Scratch-&gt;{$var};
                    return $val;
                },
</PRE>
<H4><A NAME="filter_op_lc"> </A>4.29.2.7. <A NAME="filter_op_lc">lc</A></H4>
<P>Lowercases the text.</P>
<PRE>
    'lc' =&gt;     sub {
                    return lc(shift);
                },
</PRE>
<H4><A NAME="filter_op_lookup"> </A>4.29.2.8. <A NAME="filter_op_lookup">lookup</A></H4>
<P>Looks up an item in a database based on the passed table and column. Call would be:</P>
<PRE>
    [filter op=&quot;uc lookup.country.name&quot;]us[/filter]
</PRE>
<P>This would be the equivalent of [data table=country column=name key=US].</P>
<PRE>
    'lookup' =&gt; sub {
                        my ($val, $tag, $table, $column) = @_;
                        return tag_data($table, $column, $val) || $val;
                },
</PRE>
<H4><A NAME="filter_op_mac"> </A>4.29.2.9. <A NAME="filter_op_mac">mac</A></H4>
<P>Changes newlines to carriage returns.</P>
<PRE>
    'mac' =&gt;    sub {
                    my $val = shift;
                    $val =~ s/\r?\n|\r\n?/\r/g;
                    return $val;
                },
</PRE>
<H4><A NAME="filter_op_name"> </A>4.29.2.10. <A NAME="filter_op_name">name</A></H4>
<P>Transposes a LAST, First name pair.</P>
<PRE>
    'name' =&gt; sub {
                    my $val = shift;
                    return $val unless $val =~ /,/;
                    my($last, $first) = split /\s*,\s*/, $val, 2;
                    return &quot;$first $last&quot;;
                },
</PRE>
<H4><A NAME="filter_op_namecase"> </A>4.29.2.11. <A NAME="filter_op_namecase">namecase</A></H4>
<P>Namecases the text. Only works on values that are uppercase in the first letter, i.e. [filter op=namecase]LEONARDO da Vinci[/filter] will return &quot;Leonardo da Vinci&quot;.</P>
<PRE>
    'namecase' =&gt; sub {
                    my $val = shift;
                    $val =~ s/([A-Z]\w+)/\L\u$1/g;
                    return $val;
                },
</PRE>
<H4><A NAME="filter_op_no_white"> </A>4.29.2.12. <A NAME="filter_op_no_white">no_white</A></H4>
<P>Strips all whitespace.</P>
<PRE>
    'no_white' =&gt;   sub {
                    my $val = shift;
                    $val =~ s/\s+//g;
                    return $val;
                },
</PRE>
<H4><A NAME="filter_op_pagefile"> </A>4.29.2.13. <A NAME="filter_op_pagefile">pagefile</A></H4>
<P>Strips leading slashes and dots.</P>
<PRE>
    'pagefile' =&gt; sub {
                    $_[0] =~ s:^[./]+::;
                    return $_[0];
                },
</PRE>
<H4><A NAME="filter_op_sql"> </A>4.29.2.14. <A NAME="filter_op_sql">sql</A></H4>
<P>Change single-quote characters into doubled versions, i.e. ' becomes ''.</P>
<PRE>
    'sql'       =&gt; sub {
                    my $val = shift;
                    $val =~ s:':'':g; # '
                    return $val;
                },
</PRE>
<H4><A NAME="filter_op_strip"> </A>4.29.2.15. <A NAME="filter_op_strip">strip</A></H4>
<P>Strips leading and trailing whitespace.</P>
<PRE>
    'strip' =&gt;  sub {
                    my $val = shift;
                    $val =~ s/^\s+//;
                    $val =~ s/\s+$//;
                    return $val;
                },
</PRE>
<H4><A NAME="filter_op_text2html"> </A>4.29.2.16. <A NAME="filter_op_text2html">text2html</A></H4>
<P>Rudimentary HTMLizing of text.</P>
<PRE>
    'text2html' =&gt; sub {
                    my $val = shift;
                    $val =~ s|\r?\n\r?\n|&lt;P&gt;|;
                    $val =~ s|\r?\n|&lt;BR&gt;|;
                    return $val;
                },
</PRE>
<H4><A NAME="filter_op_uc"> </A>4.29.2.17. <A NAME="filter_op_uc">uc</A></H4>
<P>Uppercases the text.</P>
<PRE>
    'uc' =&gt;     sub {
                    return uc(shift);
                },
</PRE>
<H4><A NAME="filter_op_unix"> </A>4.29.2.18. <A NAME="filter_op_unix">unix</A></H4>
<P>Removes those crufty carriage returns.</P>
<PRE>
    'unix' =&gt;   sub {
                    my $val = shift;
                    $val =~ s/\r?\n/\n/g;
                    return $val;
                },
</PRE>
<H4><A NAME="filter_op_urlencode"> </A>4.29.2.19. <A NAME="filter_op_urlencode">urlencode</A></H4>
<P>Changes non-word characters (except colon) to %3c notation.</P>
<PRE>
    'urlencode' =&gt; sub {
                    my $val = shift;
                    $val =~ s|[^\w:]|sprintf &quot;%%%02x&quot;, ord $1|eg;
                    return $val;
                },
</PRE>
<H4><A NAME="filter_op_value"> </A>4.29.2.20. <A NAME="filter_op_value">value</A></H4>
<P>Returns the value of the user session variable. Useful for starting a filter sequence with a seed value.</P>
<PRE>
    'value' =&gt;  sub {
                    return $::Values-&gt;(shift);
                },
</PRE>
<H4><A NAME="filter_op_word"> </A>4.29.2.21. <A NAME="filter_op_word">word</A></H4>
<P>Only returns word characters. Locale does apply if collation is properly set.</P>
<PRE>
    'word' =&gt;   sub {
                    my $val = shift;
                    $val =~ s/\W+//g;
                    return $val;
                },
</PRE>
<P>You can define your own filters in a <A HREF="icconfig.html#GlobalSub *global*">GlobalSub</A> (or Sub or ActionMap):</P>
<PRE>
    package Vend::Interpolate;

    $Filter{reverse} = sub { $val = shift; return scalar reverse $val  };
</PRE>
<P>That filter will reverse the characters sent.</P>
<P>The arguments sent to the subroutine are the value to be filtered, any associated variable or tag name, and any arguments appended to the filter name with periods as the separator.</P>
<P>A <TT>[filter op=lookup.products.price]99-102[/filter]</TT> will send ('99-102', undef, 'products', 'price') as the parameters. Assuming the value of the user variable <TT>foo</TT> is <TT>bar</TT>, the call <TT>[value name=foo filter=&quot;lookup.products.price.extra&quot;]</TT> will send ('bar', 'foo', 'products', 'price', 'extra').</P>
<H4><A NAME="filter_op"> </A>4.29.2.22. <A NAME="filter_op">op</A></H4>
<H2><A NAME="flag">4.30. flag</A></H2>
<P>Controls Interchange flags. For example, flags affect database access and transactions for those databases able to support these features. See also the [<A HREF="#tag">tag</A>] tag.</P>
<H3><A NAME="Summary">4.30.1. Summary</A></H3>
<PRE>
    [<B>flag</B> type]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#flag_build">build</A>
</TD>
<TD VALIGN='Top'>
Forces build of static Interchange page specified by the <TT>name</TT> attribute
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#flag_checkhtml">checkhtml</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#flag_commit">commit</A>
</TD>
<TD VALIGN='Top'>
Attempts to commit transactions
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#flag_type">flag</A>
</TD>
<TD VALIGN='Top'>
Alias for type
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#flag_type">name</A>
</TD>
<TD VALIGN='Top'>
Alias for type
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#flag_read">read</A>
</TD>
<TD VALIGN='Top'>
Flags the table read-only
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#flag_rollback">rollback</A>
</TD>
<TD VALIGN='Top'>
Attempts to rollback transactions
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#flag_show">show</A>
</TD>
<TD VALIGN='Top'>
Normally, the [<TT>flag</TT>] tag returns nothing to the page. Setting '<TT>show</TT>=1' causes the tag to return status, if any.
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#flag_tables">table</A>
</TD>
<TD VALIGN='Top'>
Alias for tables
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#flag_tables">tables</A>
</TD>
<TD VALIGN='Top'>
The name of the table to flag
<UL>
<LI>'<TT>table</TT>' is an alias</UL>
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#flag_transactions">transactions</A>
</TD>
<TD VALIGN='Top'>
Reopens the database in transactions mode if <A HREF="http://www.perl.com/pub/doc/manual/html/lib/Safe.html">Safe.pm</A> is not active (e.g., in a global subroutine, usertag or [<A HREF="#perl_global">perl</A>&nbsp;global=1] tag). The limitation exists because it is not possible to reopen a database within <A HREF="http://www.perl.com/pub/doc/manual/html/lib/Safe.html">Safe.pm</A>.
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#flag_type">type</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#flag_value">value</A>
</TD>
<TD VALIGN='Top'>
The boolean value of the flag
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#flag_write">write</A>
</TD>
<TD VALIGN='Top'>
Flags the table writable by default (or read-only if you also set the <TT>value</TT>=0 attribute)
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>YES</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [flag type]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;flag(  { type =&gt; VALUE_type
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;flag(type, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.30.2. Description</A></H3>
<P>The <TT>flag</TT> tag controls database access and transactions.</P>
<P>If a DBM-based database is to be modified, it must be flagged writable on the page calling the write tag.</P>
<P>For example, you can call</P>
<PRE>
    [flag type=write value=1 table=products]
</PRE>
<P>to mark the <TT>products</TT> DBM database writable. <B>This must be done before ANY access to that table.</B></P>
<P>Note that SQL databases are always writable if allowed by the SQL database itself, and in-memory databases will never be written.</P>
<P>Using [<TT>flag</TT> build] forces static build of a page, even if it contains dynamic elements.</P>
<H4><A NAME="flag_build"> </A>4.30.2.1. <A NAME="flag_build">build</A></H4>
<P>Forces build of static Interchange page specified by the <TT>name</TT> attribute</P>
<H4><A NAME="flag_checkhtml"> </A>4.30.2.2. <A NAME="flag_checkhtml">checkhtml</A></H4>
<H4><A NAME="flag_commit"> </A>4.30.2.3. <A NAME="flag_commit">commit</A></H4>
<P>Attempts to commit transactions</P>
<H4><A NAME="flag_read"> </A>4.30.2.4. <A NAME="flag_read">read</A></H4>
<P>Flags the table read-only</P>
<H4><A NAME="flag_rollback"> </A>4.30.2.5. <A NAME="flag_rollback">rollback</A></H4>
<P>Attempts to rollback transactions</P>
<H4><A NAME="flag_show"> </A>4.30.2.6. <A NAME="flag_show">show</A></H4>
<P>Normally, the [<TT>flag</TT>] tag returns nothing to the page. Setting '<TT>show</TT>=1' causes the tag to return status, if any.</P>
<H4><A NAME="flag_tables"> </A>4.30.2.7. <A NAME="flag_tables">tables</A></H4>
<P>The name of the table to flag</P>
<UL>
<LI>'<TT>table</TT>' is an alias</UL>
<H4><A NAME="flag_transactions"> </A>4.30.2.8. <A NAME="flag_transactions">transactions</A></H4>
<P>Reopens the database in transactions mode if <A HREF="http://www.perl.com/pub/doc/manual/html/lib/Safe.html">Safe.pm</A> is not active (e.g., in a global subroutine, usertag or [<A HREF="#perl_global">perl</A>&nbsp;global=1] tag). The limitation exists because it is not possible to reopen a database within <A HREF="http://www.perl.com/pub/doc/manual/html/lib/Safe.html">Safe.pm</A>.</P>
<H4><A NAME="flag_type"> </A>4.30.2.9. <A NAME="flag_type">type</A></H4>
<H4><A NAME="flag_value"> </A>4.30.2.10. <A NAME="flag_value">value</A></H4>
<P>The boolean value of the flag</P>
<H4><A NAME="flag_write"> </A>4.30.2.11. <A NAME="flag_write">write</A></H4>
<P>Flags the table writable by default (or read-only if you also set the <TT>value</TT>=0 attribute)</P>
<H2><A NAME="fly-list">4.31. fly-list</A></H2>
<H3><A NAME="Summary">4.31.1. Summary</A></H3>
<P>Parameters: <B>code base</B></P>
<P>Positional parameters in same order.</P>
<P>Pass attribute hash as last to subroutine: <B>no</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>This is a container tag, i.e. [fly-list] FOO [/fly-list]. Nesting: NO</P>
<P>Invalidates cache: <B>no</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;fly_list(
        {
         code =&gt; VALUE,
         base =&gt; VALUE,
        },
        BODY
    )

 OR

    $Tag-&gt;fly_list($code, $base, $BODY);
    [<B>fly-list</B> code base]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#fly_list_base">base</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#fly_list_code">code</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_reparse">reparse</A>
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>no</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [fly-list code base]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;fly_list(  { base =&gt; VALUE_base
                       code =&gt; VALUE_code
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;fly_list(code,base, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.31.2. Description</A></H3>
<P>Syntax: [fly-list prefix=tag_prefix* code=code*]</P>
<P>Defines an area in a random page which performs the flypage lookup function, implementing the tags below.</P>
<PRE>
   [fly-list]
    (contents of flypage.html)
   [/fly-list]
</PRE>
<P>If you place the above around the contents of the demo flypage, in a file named <TT>flypage2.html</TT>, it will make these two calls display identical pages:</P>
<PRE>
    [page 00-0011] One way to display the Mona Lisa &lt;/a&gt;
    [page flypage2 00-0011] Another way to display the Mona Lisa &lt;/a&gt;
</PRE>
<P>If you place a [fly-list] tag alone at the top of the page, it will cause any page to act as a flypage.</P>
<P>By default, the prefix is <TT>item</TT>, meaning the <TT>[item-code]</TT> tag will display the code of the item, the <TT>[item-price]</TT> tag will display price, etc. But if you use the prefix, i.e. <TT>[fly-list prefix=fly]</TT>, then it will be [fly-code]; <TT>prefix=foo</TT> would cause <TT>[foo-code]</TT>, etc.</P>
<H4><A NAME="fly_list_base"> </A>4.31.2.1. <A NAME="fly_list_base">base</A></H4>
<H4><A NAME="fly_list_code"> </A>4.31.2.2. <A NAME="fly_list_code">code</A></H4>
<H2><A NAME="fly-tax">4.32. fly-tax</A></H2>
<H3><A NAME="Summary">4.32.1. Summary</A></H3>
<P>Parameters: <B>area</B></P>
<P>Positional parameters in same order.</P>
<P>Pass attribute hash as last to subroutine: <B>no</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>Invalidates cache: <B>no</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;fly_tax(
        {
         area =&gt; VALUE,
        }
    )

 OR

    $Tag-&gt;fly_tax($area);
    [fly-tax area]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#fly_tax_area">area</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>no</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [fly-tax area]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;fly_tax(  { area =&gt; VALUE_area
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;fly_tax(area, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.32.2. Description</A></H3>
<P>Builds a tax rate from <TT>taxarea</TT>, <TT>taxrate</TT>, <TT>taxshipping</TT>, variable values, and the <TT>SalesTax</TT> directive value.</P>
<H4><A NAME="fly_tax_area"> </A>4.32.2.1. <A NAME="fly_tax_area">area</A></H4>
<H2><A NAME="goto">4.33. goto</A></H2>
<P>Skips page content between [<TT>goto</TT> <I>name</I>] and [<A HREF="#label">label</A> <I>name</I>]. Note that the <TT>goto</TT> tag is not interpreted in the standard way, and you cannot use the '$Tag-&gt;goto()' Perl syntax. Note also that skipping endtags with <TT>goto</TT> will probably break your page.</P>
<H3><A NAME="Summary">4.33.1. Summary</A></H3>
<PRE>
    [goto name=<I>label_name</I> if=<I>condition</I>]
        <I>content to skip</I>
    [label name=<I>label_name</I>]
</PRE>
<P>or positionally,</P>
<PRE>
    [goto name if]
        <I>content to skip</I>
    [label name]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#goto_name">name</A>
</TD>
<TD VALIGN='Top'>
The name set in the corresponding [label] tag
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#goto_if">if</A>
</TD>
<TD VALIGN='Top'>
Condition for <TT>goto</TT>. Should evaluate to truth value before tag is parsed.
</TD>
<TD VALIGN='Top'>
<I>true</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>, but you use it like this:
<UL>
[goto name=<I>label_name</I> if=<I>condition</I>]<UL>
<I>body text</I></UL>
<BR>
[label <I>label_name</I>]</UL>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
[label] interpreted by <TT>goto</TT>
</TD>
</TR>
</TABLE>

<P><B>ASP-like Perl call:</B></P>
<P>No Perl call available (Note that this tag is not parsed in the standard way).</P>
<H3><A NAME="Description">4.33.2. Description</A></H3>
<P>Skips page content between [<TT>goto</TT> <I>name</I>] and [<A HREF="#label">label</A> <I>name</I>]. Note that the <TT>goto</TT> tag is not interpreted in the standard way, and you cannot use the '$Tag-&gt;goto()' Perl syntax. Note also that skipping endtags with <TT>goto</TT> will probably break your page.</P>
<P>The correspondingly named [<TT>label</TT>] tag marks the end of the page content the <TT>goto</TT> should skip. Note that the [<TT>label</TT>] tag is not an end tag, but simply a marker for the end of the text to skip.</P>
<P><HR WIDTH="80%" ALIGN="Left">
<STRONG>Technical note (Interchange 4.8): </STRONG>This tag may not work properly if you have more than one goto/label pair on a page.</P>
<P><HR WIDTH="80%" ALIGN="Left"></P>
<H4><A NAME="goto_name"> </A>4.33.2.1. <A NAME="goto_name">name</A></H4>
<P>This should match the name set in a [label] tag <I>after</I> the goto tag in the page (i.e., don't create loops).</P>
<H4><A NAME="goto_if"> </A>4.33.2.2. <A NAME="goto_if">if</A></H4>
<P>Condition for goto. If the argument to '<TT>if</TT>' is true, the tag will skip the text between the <TT>goto</TT> and &lt;label&gt;.  Note that the tag itself does not evaluate the condition. The condition must evaluate to a true or false value before the <TT>goto</TT> tag processes it.</P>
<P>For example, this will not execute the goto:</P>
<PRE>
    [set go]0[/set]
    [goto name=&quot;there&quot; if=&quot;[scratch go]&quot;]
</PRE>
<H2><A NAME="handling">4.34. handling</A></H2>
<H3><A NAME="Summary">4.34.1. Summary</A></H3>
<P>Parameters: <B>mode</B></P>
<P>Positional parameters in same order.</P>
<P><B>The attribute hash reference is passed</B> to the subroutine after the parameters as the last argument. <B>This may mean that there are parameters not shown here.</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>Invalidates cache: <B>YES</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;handling(
        {
         mode =&gt; VALUE,
        }
    )

 OR

    $Tag-&gt;handling($mode, $ATTRHASH);
</PRE>
<P>Attribute aliases</P>
<PRE>
            carts ==&gt; cart
            modes ==&gt; mode
            name ==&gt; mode
            tables ==&gt; table
    [<B>handling</B> mode <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#handling_cart">carts</A>
</TD>
<TD VALIGN='Top'>
Alias for cart
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#handling_mode">mode</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#handling_mode">modes</A>
</TD>
<TD VALIGN='Top'>
Alias for mode
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#handling_mode">name</A>
</TD>
<TD VALIGN='Top'>
Alias for mode
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#handling_table">tables</A>
</TD>
<TD VALIGN='Top'>
Alias for table
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>YES</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [handling mode]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;handling(  { mode =&gt; VALUE_mode
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;handling(mode, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.34.2. Description</A></H3>
<P>Calculates and inserts handling costs. Accepts the same noformat and convert arguments as the shipping tag.</P>
<H4><A NAME="handling_cart"> </A>4.34.2.1. <A NAME="handling_cart">cart</A></H4>
<H4><A NAME="handling_mode"> </A>4.34.2.2. <A NAME="handling_mode">mode</A></H4>
<H4><A NAME="handling_table"> </A>4.34.2.3. <A NAME="handling_table">table</A></H4>
<H2><A NAME="harness">4.35. harness</A></H2>
<P>Test harness block. Similar to try/catch. Interprets the body text and checks the return value against expected and explicitly bad cases.</P>
<P>Returns DIED, OK, or NOT OK message along with your result if not the expected value.</P>
<H3><A NAME="Summary">4.35.1. Summary</A></H3>
<PRE>
    [<B>harness</B> <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#harness_expected">expected</A>
</TD>
<TD VALIGN='Top'>
Tagname for delimiting your expected return value (default &quot;OK&quot;)
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#harness_name">name</A>
</TD>
<TD VALIGN='Top'>
This will appear in your output message (useful for distinguishing harness tags from one another) (default &quot;test<I>nnn</I>&quot;)
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_reparse">reparse</A>
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>no</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [harness]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;harness(  {
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;harness(, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.35.2. Description</A></H3>
<P>Test harness block. Similar to try/catch. Interprets the body text and checks the return value against expected and explicitly bad cases.</P>
<P>Returns DIED, OK, or NOT OK message along with the harness name and your result if not the expected value.</P>
<H4><A NAME="harness_expected"> </A>4.35.2.1. <A NAME="harness_expected">expected</A></H4>
<P>Tagname for delimiting your expected return value (default &quot;OK&quot;)</P>
<H4><A NAME="harness_name"> </A>4.35.2.2. <A NAME="harness_name">name</A></H4>
<P>This will appear in your output message (useful for distinguishing harness tags from one another) (default &quot;test<I>nnn</I>&quot;)</P>
<H2><A NAME="href">4.36. href</A></H2>
<P>Alias for [<A HREF="#area">area</A>] tag.</P>
<H2><A NAME="html-table">4.37. html-table</A></H2>
<P>Builds an HTML table</P>
<H3><A NAME="Summary">4.37.1. Summary</A></H3>
<PRE>
    [html-table <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#html_table_columns">columns</A>
</TD>
<TD VALIGN='Top'>
Whitespace-delimited list of columns
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#html_table_delimiter">delimiter</A>
</TD>
<TD VALIGN='Top'>
Line delimiter to use if tag body is delimited text rather than an array reference (default &quot;\t&quot;)
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#html_table_fc">fc</A>
</TD>
<TD VALIGN='Top'>
HTML attributes for &lt;TD&gt; in the first cell
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#html_table_fr">fr</A>
</TD>
<TD VALIGN='Top'>
HTML attributes for &lt;TR&gt; in the first row
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#html_table_record_delim">record_delim</A>
</TD>
<TD VALIGN='Top'>
Record delimiter to use if tag body is delimited text rather than an array reference (default &quot;\n&quot;)
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#html_table_td">td</A>
</TD>
<TD VALIGN='Top'>
HTML attributes for &lt;TD&gt;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#html_table_th">th</A>
</TD>
<TD VALIGN='Top'>
HTML attributes for &lt;TH&gt;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#html_table_tr">tr</A>
</TD>
<TD VALIGN='Top'>
HTML attributes for &lt;TR&gt;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_reparse">reparse</A>
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>no</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [html-table]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;html_table(  {
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;html_table(, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.37.2. Description</A></H3>
<P>Builds an HTML table</P>
<H4><A NAME="html_table_columns"> </A>4.37.2.1. <A NAME="html_table_columns">columns</A></H4>
<P>Whitespace-delimited list of columns</P>
<H4><A NAME="html_table_delimiter"> </A>4.37.2.2. <A NAME="html_table_delimiter">delimiter</A></H4>
<P>Line delimiter to use if tag body is delimited text rather than an array reference (default &quot;\t&quot;)</P>
<H4><A NAME="html_table_fc"> </A>4.37.2.3. <A NAME="html_table_fc">fc</A></H4>
<P>HTML attributes for &lt;TD&gt; in the first cell</P>
<H4><A NAME="html_table_fr"> </A>4.37.2.4. <A NAME="html_table_fr">fr</A></H4>
<P>HTML attributes for &lt;TR&gt; in the first row</P>
<H4><A NAME="html_table_record_delim"> </A>4.37.2.5. <A NAME="html_table_record_delim">record_delim</A></H4>
<P>Record delimiter to use if tag body is delimited text rather than an array reference (default &quot;\n&quot;)</P>
<H4><A NAME="html_table_td"> </A>4.37.2.6. <A NAME="html_table_td">td</A></H4>
<P>HTML attributes for &lt;TD&gt;</P>
<H4><A NAME="html_table_th"> </A>4.37.2.7. <A NAME="html_table_th">th</A></H4>
<P>HTML attributes for &lt;TH&gt;</P>
<H4><A NAME="html_table_tr"> </A>4.37.2.8. <A NAME="html_table_tr">tr</A></H4>
<P>HTML attributes for &lt;TR&gt;</P>
<H2><A NAME="if">4.38. if</A></H2>
<H3><A NAME="Summary">4.38.1. Summary</A></H3>
<P>Parameters: <B>type term op compare</B></P>
<P>THIS TAG HAS SPECIAL POSITIONAL PARAMETER HANDLING.</P>
<P>Pass attribute hash as last to subroutine: <B>no</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>This is a container tag, i.e. [if] FOO [/if]. Nesting: NO</P>
<P>Invalidates cache: <B>YES</B></P>
<P>Called Routine:</P>
<P>Called Routine for positional:</P>
<P><B>ASP-like Perl call:</B></P>
<P>Not applicable. Any [if ...] call can be better and more efficiently done with Perl.</P>
<P>Attribute aliases</P>
<PRE>
            base ==&gt; type
            comp ==&gt; compare
            condition ==&gt; compare
            operator ==&gt; op
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#if_type">base</A>
</TD>
<TD VALIGN='Top'>
Alias for type
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#if_compare">comp</A>
</TD>
<TD VALIGN='Top'>
Alias for compare
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#if_compare">compare</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#if_compare">condition</A>
</TD>
<TD VALIGN='Top'>
Alias for compare
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#if_op">op</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#if_op">operator</A>
</TD>
<TD VALIGN='Top'>
Alias for op
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#if_term">term</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#if_type">type</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_reparse">reparse</A>
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>YES</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [if type term op compare]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;if(  { compare =&gt; VALUE_compare
                 op =&gt; VALUE_op
                 term =&gt; VALUE_term
                 type =&gt; VALUE_type
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;if(type,term,op,compare, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.38.2. Description</A></H3>
<P>Named call example: [if type=&quot;type&quot; term=&quot;field&quot; op=&quot;op&quot; compare=&quot;compare&quot;]</P>
<P>Positional call example: [if type field op compare]</P>
<P>negated: [if type=&quot;!type&quot; term=&quot;field&quot; op=&quot;op&quot; compare=&quot;compare&quot;]</P>
<P>Positional call example: [if !type field op compare]</P>
<P>Allows conditional building of HTML based on the setting of various Interchange session and database values. The general form is:</P>
<PRE>
    [if type term op compare]
    [then]
                                If true, this is printed on the document.
                                The [then] [/then] is optional in most
                                cases. If ! is prepended to the type
                                setting, the sense is reversed and
                                this will be output for a false condition.
    [/then]
    [elsif type term op compare]
                                Optional, tested when if fails
    [/elsif]
    [else]
                                Optional, printed when all above fail
    [/else]
    [/if]
</PRE>
<P>The [<A HREF="#if">if</A>] tag can also have some variants:</P>
<PRE>
    [if type=explicit compare=`$perl_code`]
        Displayed if valid Perl CODE returns a true value.
    [/if]
</PRE>
<P>You can do some Perl-style regular expressions:</P>
<PRE>
    [if value name =~ /^mike/]
                                This is the if with Mike.
    [elsif value name =~ /^sally/]
                                This is an elsif with Sally.
    [/elsif]
    [elsif value name =~ /^pat/]
                                This is an elsif with Pat.
    [/elsif]
    [else]
                                This is the else, no name I know.
    [/else]
    [/if]
</PRE>
<P>While named parameter tag syntax works for [<A HREF="#if">if</A> ...], it is more convenient to use positional calls in most cases. The only exception is if you are planning on doing a test on the results of another tag sequence:</P>
<PRE>
    [if value name =~ /[value b_name]/]
        Shipping name matches billing name.
    [/if]
</PRE>
<P>Oops!  This will not work. You must do instead</P>
<PRE>
    [if base=value term=name op=&quot;=~&quot; compare=&quot;/[value b_name]/&quot;]
        Shipping name matches billing name.
    [/if]
</PRE>
<P>or better yet</P>
<PRE>
    [if type=explicit compare=`
                        $Values-&gt;{name} =~ /$Values-&gt;{b_name}/
                        `]
        Shipping name matches billing name.
    [/if]
</PRE>
<P>Interchange also supports a limited [and ...] and [or ...] capability:</P>
<PRE>
    [if value name =~ /Mike/]
    [or value name =~ /Jean/]
    Your name is Mike or Jean.
    [/if]

    [if value name =~ /Mike/]
    [and value state =~ /OH/]
    Your name is Mike and you live in Ohio.
    [/if]
</PRE>
<P>If you wish to do very complex AND and OR operations, you will have to use [<A HREF="#if">if</A> explicit] or better yet embedded Perl/ASP. This allows complex testing and parsing of values.</P>
<P>There are many test targets available:</P>
<H4><A NAME="if_config"> </A>4.38.2.1. <A NAME="if_config">config Directive</A></H4>
<P>The Interchange configuration variables. These are set by the directives in your Interchange configuration file (or the defaults).</P>
<PRE>
    [if config CreditCardAuto]
    Auto credit card validation is enabled.
    [/if]
</PRE>
<H4><A NAME="if_data"> </A>4.38.2.2. <A NAME="if_data">data database::field::key</A></H4>
<P>The Interchange databases. Retrieves a field in the database and returns true or false based on the value.</P>
<PRE>
    [if data products::size::99-102]
    There is size information.
    [else]
    No size information.
    [/else]
    [/if]

    [if data products::size::99-102 =~ /small/i]
    There is a small size available.
    [else]
    No small size available.
    [/else]
    [/if]
</PRE>
<H4><A NAME="if_discount"> </A>4.38.2.3. <A NAME="if_discount">discount</A></H4>
<P>Checks to see if a discount is present for an item.</P>
<PRE>
    [if discount 99-102]
    Item is discounted.
    [/if]
</PRE>
<H4><A NAME="if_explicit"> </A>4.38.2.4. <A NAME="if_explicit">explicit</A></H4>
<P>A test for an explicit value. If perl code is placed between a [condition] [/condition] tag pair, it will be used to make the comparison. Arguments can be passed to import data from user space, just as with the [perl] tag.</P>
<PRE>
    [if explicit]
    [condition]
        $country = '[value country]';
        return 1 if $country =~ /u\.?s\.?a?/i;
        return 0;
    [/condition]
    You have indicated a US address.
    [else]
    You have indicated a non-US address.
    [/else]
    [/if]
</PRE>
<P>This example is a bit contrived, as the same thing could be accomplished with [if value country =~ /u\.?s\.?a?/i], but you will run into many situations where it is useful.</P>
<P>This will work for <I>Variable</I> values:</P>
<PRE>
    [if type=explicit compare=&quot;__MYVAR__&quot;] .. [/if]
</PRE>
<H4><A NAME="if_file"> </A>4.38.2.5. <A NAME="if_file">file</A></H4>
<P>Tests for existence of a file. Useful for placing image tags only if the image is present.</P>
<PRE>
    [if type=file term=&quot;/home/user/www/images/[item-code].gif&quot;]
    &lt;IMG SRC=&quot;[item-code].gif&quot;&gt;
    [/if]
</PRE>
<P>The <TT>file</TT> test requires that the <I>SafeUntrap</I> directive contains <TT>ftfile</TT> (which is the default).</P>
<H4><A NAME="if_items"> </A>4.38.2.6. <A NAME="if_items">items</A></H4>
<P>The Interchange shopping carts. If not specified, the cart used is the main cart. Usually used as a litmus test to see if anything is in the cart, for example:</P>
<PRE>
  [if items]You have items in your shopping cart.[/if]

  [if items layaway]You have items on layaway.[/if]
</PRE>
<H4><A NAME="if_ordered"> </A>4.38.2.7. <A NAME="if_ordered">ordered</A></H4>
<P>Order status of individual items in the Interchange shopping carts. If not specified, the cart used is the main cart. The following items refer to a part number of 99-102.</P>
<PRE>
  [if ordered 99-102] Item 99-102 is in your cart. [/if]
    Checks the status of an item on order, true if item
    99-102 is in the main cart.

  [if ordered 99-102 layaway] ... [/if]
    Checks the status of an item on order, true if item
    99-102 is in the layaway cart.

  [if ordered 99-102 main size] ... [/if]
    Checks the status of an item on order in the main cart,
    true if it has a size attribute.

  [if ordered 99-102 main size =~ /large/i] ... [/if]
    Checks the status of an item on order in the main cart,
    true if it has a size attribute containing 'large'.

    To make sure it is exactly large, you could use:

  [if ordered 99-102 main size eq 'large'] ... [/if]
</PRE>
<H4><A NAME="if_pragma"> </A>4.38.2.8. <A NAME="if_pragma">pragma</A></H4>
<P>The Interchange Pragma settings, set with the <A HREF="catalog.cfg.html">the catalog.cfg manpage</A> directive <TT>Pragma</TT> or with <TT>[pragma name]</TT>.</P>
<PRE>
    [if pragma dynamic_variables]
    __THE_VARIABLE__
    [else]
    [data table=variable column=Variable key=THE_VARIABLE]
    [/else]
    [/if]
</PRE>
<H4><A NAME="if_scratch"> </A>4.38.2.9. <A NAME="if_scratch">scratch</A></H4>
<P>The Interchange scratchpad variables, which can be set with the [set name]value[/set] element.</P>
<PRE>
    [if scratch mv_separate_items]
    ordered items will be placed on a separate line.
    [else]
    ordered items will be placed on the same line.
    [/else]
    [/if]
</PRE>
<H4><A NAME="if_session"> </A>4.38.2.10. <A NAME="if_session">session</A></H4>
<P>the Interchange session variables. of particular interest are <I>login</I>, <I>frames</I>, <I>secure</I>, and <I>browser</I>.</P>
<H4><A NAME="if_validcc"> </A>4.38.2.11. <A NAME="if_validcc">validcc</A></H4>
<P>a special case, takes the form [if validcc no type exp_date]. evaluates to true if the supplied credit card number, type of card, and expiration date pass a validity test. does a Luhn-10 calculation to weed out typos or phony card numbers. Uses the standard <TT>CreditCardAuto</TT> variables for targets if nothing else is passed.</P>
<H4><A NAME="if_value"> </A>4.38.2.12. <A NAME="if_value">value</A></H4>
<P>the Interchange user variables, typically set in search, control, or order forms. Variables beginning with <TT>mv_</TT> are Interchange special values, and should be tested/used with caution.</P>
<P>The <I>field</I> term is the specifier for that area. For example, [if session logged_in] would return true if the <TT>logged_in</TT> session parameter was set.</P>
<P>As an example, consider buttonbars for frame-based setups. It would be nice to display a different buttonbar (with no frame targets) for sessions that are not using frames:</P>
<PRE>
    [if scratch frames]
        __BUTTONBAR_FRAMES__
    [else]
        __BUTTONBAR__
    [/else]
    [/if]
</PRE>
<P>Another example might be the when search matches are displayed. If you use the string '[value mv_match_count] titles found', it will display a plural for only one match. Use:</P>
<PRE>
    [if value mv_match_count != 1]
        [value mv_match_count] matches found.
    [else]
        Only one match was found.
    [/else]
    [/if]
</PRE>
<P>The <I>op</I> term is the compare operation to be used. Compare operations are as in Perl:</P>
<PRE>
    ==  numeric equivalence
    eq  string equivalence
    &gt;   numeric greater-than
    gt  string greater-than
    &lt;   numeric less-than
    lt  string less-than
    !=  numeric non-equivalence
    ne  string non-equivalence
</PRE>
<P>Any simple perl test can be used, including some limited regex matching. More complex tests are best done with [<A HREF="#if">if</A> explicit].</P>
<H4><A NAME="[then] text [/then]">4.38.2.13. [then] text [/then]</A></H4>
<P>This is optional if you are not nesting if conditions, as the text immediately following the [if ..] tag is used as the conditionally substituted text. If nesting [if ...] tags you should use a [then][/then] on any outside conditions to ensure proper interpolation.</P>
<H4><A NAME="[elsif type field op* compare*]">4.38.2.14. [elsif type field op* compare*]</A></H4>
<P>named attributes: [elsif type=&quot;type&quot; term=&quot;field&quot; op=&quot;op&quot; compare=&quot;compare&quot;]</P>
<P>Additional conditions for test, applied if the initial [<A HREF="#if">if</A> ..] test fails.</P>
<H4><A NAME="[else] text [/else]">4.38.2.15. [else] text [/else]</A></H4>
<P>The optional else-text for an if or <TT>[if-field]</TT> conditional.</P>
<H4><A NAME="[condition] text [/condition]">4.38.2.16. [condition] text [/condition]</A></H4>
<P>Only used with the [if explicit] tag. Allows an arbitrary expression <B>in Perl</B> to be placed inside, with its return value interpreted as the result of the test. If arguments are added to [if explicit args], those will be passed as arguments are in the [<A HREF="#perl">perl</A>] construct.</P>
<H4><A NAME="if_compare"> </A>4.38.2.17. <A NAME="if_compare">compare</A></H4>
<H4><A NAME="if_op"> </A>4.38.2.18. <A NAME="if_op">op</A></H4>
<H4><A NAME="if_term"> </A>4.38.2.19. <A NAME="if_term">term</A></H4>
<H4><A NAME="if_type"> </A>4.38.2.20. <A NAME="if_type">type</A></H4>
<H2><A NAME="import">4.39. import</A></H2>
<H3><A NAME="Summary">4.39.1. Summary</A></H3>
<P>Parameters: <B>table type</B></P>
<P>Positional parameters in same order.</P>
<P><B>The attribute hash reference is passed</B> after the parameters but before the container text argument. <B>This may mean that there are parameters not shown here.</B></P>
<P>Interpolates <B>container text</B> by default.</P>
<P>This is a container tag, i.e. [import] FOO [/import]. Nesting: NO</P>
<P>Invalidates cache: <B>YES</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;import(
        {
         table =&gt; VALUE,
         type =&gt; VALUE,
        },
        BODY
    )

 OR

    $Tag-&gt;import($table, $type, $ATTRHASH, $BODY);
</PRE>
<P>Attribute aliases</P>
<PRE>
            base ==&gt; table
            database ==&gt; table
    [<B>import</B> table type <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#import_table">base</A>
</TD>
<TD VALIGN='Top'>
Alias for table
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#import_table">database</A>
</TD>
<TD VALIGN='Top'>
Alias for table
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#import_table">table</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#import_type">type</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_reparse">reparse</A>
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>YES</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [import table type]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;import(  { table =&gt; VALUE_table
                     type =&gt; VALUE_type
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;import(table,type, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.39.2. Description</A></H3>
<P>Named attributes:</P>
<PRE>
    [import table=table_name
            type=(TAB|PIPE|CSV|%%|LINE)
            continue=(NOTES|UNIX|DITTO)
            separator=c]
</PRE>
<P>Import one or more records into a database. The <TT>type</TT> is any of the valid Interchange delimiter types, with the default being defined by the setting of the database <I>DELIMITER</I>. The table must already be a defined Interchange database table; it cannot be created on the fly. (If you need that, it is time to use SQL.)</P>
<P>The <TT>type</TT> of <TT>LINE</TT> and <TT>continue</TT> setting of <TT>NOTES</TT> is particularly useful, for it allows you to name your fields and not have to remember the order in which they appear in the database. The following two imports are identical in effect:</P>
<PRE>
    [import table=orders]
    code: [value mv_order_number]
    shipping_mode: [shipping-description]
    status: pending
    [/import]

    [import table=orders]
    shipping_mode: [shipping-description]
    status: pending
    code: [value mv_order_number]
    [/import]
</PRE>
<P>The <TT>code</TT> or key must always be present, and is always named <TT>code</TT>.</P>
<P>If you do not use <TT>NOTES</TT> mode, you must import the fields in the same order as they appear in the ASCII source file.</P>
<P>The <TT>[import ....] TEXT [/import]</TT> region may contain multiple records. If using <TT>NOTES</TT> mode, you must use a separator, which by default is a form-feed character (^L).</P>
<H4><A NAME="import_table"> </A>4.39.2.1. <A NAME="import_table">table</A></H4>
<H4><A NAME="import_type"> </A>4.39.2.2. <A NAME="import_type">type</A></H4>
<H2><A NAME="include">4.40. include</A></H2>
<H3><A NAME="Summary">4.40.1. Summary</A></H3>
<P>Parameters: <B>file locale</B></P>
<P>Positional parameters in same order.</P>
<P>Pass attribute hash as last to subroutine: <B>no</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>Invalidates cache: <B>no</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<P>Not applicable.</P>
<PRE>
    [<B>include</B> file locale]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#include_file">file</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#include_locale">locale</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>no</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [include file locale]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;include(  { file =&gt; VALUE_file
                      locale =&gt; VALUE_locale
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;include(file,locale, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.40.2. Description</A></H3>
<P>Same as [<A HREF="#file">file</A> name] except interpolates for all Interchange tags and variables. Does NOT do locale translations.</P>
<H4><A NAME="include_file"> </A>4.40.2.1. <A NAME="include_file">file</A></H4>
<H4><A NAME="include_locale"> </A>4.40.2.2. <A NAME="include_locale">locale</A></H4>
<H2><A NAME="index">4.41. index</A></H2>
<P>Creates an index for the specified table.</P>
<H3><A NAME="Summary">4.41.1. Summary</A></H3>
<PRE>
    [<B>index</B> table <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#index_table">base</A>
</TD>
<TD VALIGN='Top'>
Alias for table
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#index_basefile">basefile</A>
</TD>
<TD VALIGN='Top'>
Database filename. Exports the table to this filename if old or missing before indexing. See also the <A HREF="#export">export</A> tag for additional relevant attributes such as delimiter type, etc.
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#index_col">col</A>
</TD>
<TD VALIGN='Top'>
alias for fields
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#index_columns">columns</A>
</TD>
<TD VALIGN='Top'>
alias for fields
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#index_table">database</A>
</TD>
<TD VALIGN='Top'>
Alias for table
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#index_export_only">export_only</A>
</TD>
<TD VALIGN='Top'>
Just do the export if necessary (not the index).
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#index_extension">extension</A>
</TD>
<TD VALIGN='Top'>
Index file extension (default &quot;idx&quot;)
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#index_fields">fields</A>
</TD>
<TD VALIGN='Top'>
field(s) to index
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#index_fn">fn</A>
</TD>
<TD VALIGN='Top'>
alias for fields
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#index_show_status">show_status</A>
</TD>
<TD VALIGN='Top'>
Return '1' to the page if successful
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#index_spec">spec</A>
</TD>
<TD VALIGN='Top'>
The index specification
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#index_table">table</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>YES</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [index table]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;index(  { table =&gt; VALUE_table
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;index(table, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.41.2. Description</A></H3>
<P>Creates an index for the specified table.</P>
<H4><A NAME="index_basefile"> </A>4.41.2.1. <A NAME="index_basefile">basefile</A></H4>
<P>Database filename. Exports the table to this filename if old or missing before indexing. See also the <A HREF="#export">export</A> tag for additional relevant attributes such as delimiter type, etc.</P>
<H4><A NAME="index_col"> </A>4.41.2.2. <A NAME="index_col">col</A></H4>
<P>alias for fields</P>
<H4><A NAME="index_columns"> </A>4.41.2.3. <A NAME="index_columns">columns</A></H4>
<P>alias for fields</P>
<H4><A NAME="index_export_only"> </A>4.41.2.4. <A NAME="index_export_only">export_only</A></H4>
<P>Just do the export if necessary (not the index).</P>
<H4><A NAME="index_extension"> </A>4.41.2.5. <A NAME="index_extension">extension</A></H4>
<P>Index file extension (default &quot;idx&quot;)</P>
<H4><A NAME="index_fields"> </A>4.41.2.6. <A NAME="index_fields">fields</A></H4>
<P>field(s) to index</P>
<H4><A NAME="index_fn"> </A>4.41.2.7. <A NAME="index_fn">fn</A></H4>
<P>alias for fields</P>
<H4><A NAME="index_show_status"> </A>4.41.2.8. <A NAME="index_show_status">show_status</A></H4>
<P>Return '1' to the page if successful</P>
<H4><A NAME="index_spec"> </A>4.41.2.9. <A NAME="index_spec">spec</A></H4>
<P>The index specification</P>
<H4><A NAME="index_table"> </A>4.41.2.10. <A NAME="index_table">table</A></H4>
<H2><A NAME="item-list">4.42. item-list</A></H2>
<H3><A NAME="Summary">4.42.1. Summary</A></H3>
<P>Parameters: <B>name</B></P>
<P><B>The attribute hash reference is passed</B> after the parameters but before the container text argument. <B>This may mean that there are parameters not shown here.</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>This is a container tag, i.e. [item-list] FOO [/item-list]. Nesting: NO</P>
<P>Invalidates cache: <B>YES</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    NOTE: This would not usually be used with embedded Perl -- a better
    choice would normally be:

                 for(@$Items) { CODE }

    $Tag-&gt;item_list(
        {
         name =&gt; VALUE,
        },
        BODY
    )

 OR

    $Tag-&gt;item_list($name, $ATTRHASH, $BODY);
</PRE>
<P>Attribute aliases</P>
<PRE>
            cart ==&gt; name
    [<B>item-list</B> name <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#item_list_name">cart</A>
</TD>
<TD VALIGN='Top'>
Alias for name
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#item_list_name">name</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_reparse">reparse</A>
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>YES</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [item-list name]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;item_list(  { name =&gt; VALUE_name
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;item_list(name, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.42.2. Description</A></H3>
<P>Within any page, the <TT>[item-list cart*]</TT> element shows a list of all the items ordered by the customer so far. It works by repeating the source between <TT>[item-list]</TT> and <TT>[/item-list]</TT> once for each item ordered.</P>
<P>NOTE: The special tags that reference item within the list are not normal Interchange tags, do not take named attributes, and cannot be contained in an HTML tag (other than to substitute for one of its values or provide a conditional container). They are interpreted only inside their corresponding list container. Normal Interchange tags can be interspersed, though they will be interpreted <I>after</I> all of the list-specific tags.</P>
<P>Between the [<TT>item-list</TT>] markers the following elements will return information for the current item:</P>
<H4><A NAME="E&lt;lbracket&gt;if-data table column]">4.42.2.1. [if-data table column]</A></H4>
<P>If the database field <TT>column</TT> in table <I>table</I> is non-blank, the following text up to the <TT>[/if-data]</TT> tag is substituted. This can be used to substitute IMG or other tags only if the corresponding source item is present. Also accepts an <TT>[else]</TT>else text<TT>[/else]</TT> pair for the opposite condition.</P>
<H4><A NAME="E&lt;lbracket&gt;if-data ! table column]">4.42.2.2. [if-data ! table column]</A></H4>
<P>Reverses sense for <TT>[if-data]</TT>.</P>
<H4><A NAME="E&lt;lbracket&gt;/if-data]">4.42.2.3. [/if-data]</A></H4>
<P>Terminates an <TT>[if-data table column]</TT> element.</P>
<H4><A NAME="E&lt;lbracket&gt;if-field fieldname]">4.42.2.4. [if-field fieldname]</A></H4>
<P>If the products database field <I>fieldname</I> is non-blank, the following text up to the <TT>[/if-field]</TT> tag is substituted. If you have more than one products database table (see <A HREF="icconfig.html#ProductFiles">ProductFiles</A>), it will check them in order until a matching key is found. This can be used to substitute IMG or other tags only if the corresponding source item is present. Also accepts an <TT>[else]</TT>else text<TT>[/else]</TT> pair for the opposite condition.</P>
<H4><A NAME="E&lt;lbracket&gt;if-field ! fieldname]">4.42.2.5. [if-field ! fieldname]</A></H4>
<P>Reverses sense for <TT>[if-field]</TT>.</P>
<H4><A NAME="E&lt;lbracket&gt;/if-field]">4.42.2.6. [/if-field]</A></H4>
<P>Terminates an <TT>[if-field fieldname]</TT> element.</P>
<H4><A NAME="E&lt;lbracket&gt;item-accessories attribute*, type*, field*, database*, name*]">4.42.2.7. [item-accessories attribute*, type*, field*, database*, name*]</A></H4>
<P>Evaluates to the value of the Accessories database entry for the item. If passed any of the optional arguments, initiates special processing of item attributes based on entries in the product database.</P>
<H4><A NAME="E&lt;lbracket&gt;item-code]">4.42.2.8. [item-code]</A></H4>
<P>Evaluates to the product code for the current item.</P>
<H4><A NAME="E&lt;lbracket&gt;item-data database fieldname]">4.42.2.9. [item-data database fieldname]</A></H4>
<P>Evaluates to the field name <I>fieldname</I> in the arbitrary database table <I>database</I>, for the current item.</P>
<H4><A NAME="E&lt;lbracket&gt;item-description]">4.42.2.10. [item-description]</A></H4>
<P>Evaluates to the product description (from the products file) for the current item.</P>
<P>In support of <TT>OnFly</TT>, if the description field is not found in the database, the <TT>description</TT> setting in the shopping cart will be used instead.</P>
<H4><A NAME="E&lt;lbracket&gt;item-field fieldname]">4.42.2.11. [item-field fieldname]</A></H4>
<P>Evaluates to the field name <I>fieldname</I> in the products database, for the current item. If the item is not found in the first of the <A HREF="icconfig.html#ProductFiles">ProductFiles</A>, all will be searched in sequence.</P>
<H4><A NAME="E&lt;lbracket&gt;item-increment]">4.42.2.12. [item-increment]</A></H4>
<P>Evaluates to the number of the item in the match list. Used for numbering search matches or order items in the list.</P>
<H4><A NAME="E&lt;lbracket&gt;item-last]tags[/item-last]">4.42.2.13. [item-last]tags[/item-last]</A></H4>
<P>Evaluates the output of the Interchange tags encased inside the tags, and if it evaluates to a numerical non-zero number (i.e. 1, 23, or -1) then the list iteration will terminate. If the evaluated number is <B>negative</B>, then the item itself will be skipped. If the evaluated number is <B>positive</B>, then the item itself will be shown but will be last on the list.</P>
<PRE>
      [item-last][calc]
        return -1 if '[item-field weight]' eq '';
        return 1 if '[item-field weight]' &lt; 1;
        return 0;
        [/calc][/item-last]
</PRE>
<P>If this is contained in your [<A HREF="#item-list">item-list</A>] (or [<A HREF="#search-list">search-list</A>] or flypage) and the weight field is empty, then a numerical <TT>-1</TT> will be output from the [calc][/calc] tags; the list will end and the item will <B>not</B> be shown. If the product's weight field is less than 1, a numerical 1 is output. The item will be shown, but will be the last item shown. (If it is an [<A HREF="#item-list">item-list</A>], any price for the item will still be added to the subtotal.)</P>
<H4><A NAME="E&lt;lbracket&gt;item-modifier attribute]">4.42.2.14. [item-modifier attribute]</A></H4>
<P>Evaluates to the modifier value of <TT>attribute</TT> for the current item.</P>
<H4><A NAME="E&lt;lbracket&gt;item-next]tags[/item_next]">4.42.2.15. [item-next]tags[/item_next]</A></H4>
<P>Evaluates the output of the Interchange tags encased inside, and if it evaluates to a numerical non-zero number (i.e. 1, 23, or -1) then the item will be skipped with no output. Example:</P>
<PRE>
      [item-next][calc][item-field weight] &lt; 1[/calc][/item-next]
</PRE>
<P>If this is contained in your [<A HREF="#item-list">item-list</A>] (or [<A HREF="#search-list">search-list</A>] or flypage) and the product's weight field is less than 1, then a numerical <TT>1</TT> will be output from the [calc][/calc] operation. The item will not be shown. (If it is an [<A HREF="#item-list">item-list</A>], any price for the item will still be added to the subtotal.)</P>
<H4><A NAME="E&lt;lbracket&gt;item-price n* noformat*]">4.42.2.16. [item-price n* noformat*]</A></H4>
<P>Evaluates to the price for quantity <TT>n</TT> (from the products file) of the current item, with currency formatting. If the optional &quot;noformat&quot; is set, then currency formatting will not be applied.</P>
<H4><A NAME="E&lt;lbracket&gt;discount-price n* noformat*]">4.42.2.17. [discount-price n* noformat*]</A></H4>
<P>Evaluates to the discount price for quantity <TT>n</TT> (from the products file) of the current item, with currency formatting. If the optional &quot;noformat&quot; is set, then currency formatting will not be applied. Returns regular price if not discounted.</P>
<H4><A NAME="E&lt;lbracket&gt;item-discount]">4.42.2.18. [item-discount]</A></H4>
<P>Returns the difference between the regular price and the discounted price.</P>
<H4><A NAME="E&lt;lbracket&gt;item-discount_subtotal]">4.42.2.19. [item-discount_subtotal]</A></H4>
<P>Inserts the discounted subtotal of the ordered items.</P>
<H4><A NAME="E&lt;lbracket&gt;item-quantity]">4.42.2.20. [item-quantity]</A></H4>
<P>Evaluates to the quantity ordered for the current item.</P>
<H4><A NAME="E&lt;lbracket&gt;item-subtotal]">4.42.2.21. [item-subtotal]</A></H4>
<P>Evaluates to the subtotal (quantity * price) for the current item. Quantity price breaks are taken into account.</P>
<H4><A NAME="E&lt;lbracket&gt;modifier-name attribute]">4.42.2.22. [modifier-name attribute]</A></H4>
<P>Evaluates to the name to give an input box in which the customer can specify the modifier to the ordered item.</P>
<H4><A NAME="E&lt;lbracket&gt;quantity-name]">4.42.2.23. [quantity-name]</A></H4>
<P>Evaluates to the name to give an input box in which the customer can enter the quantity to order.</P>
<H4><A NAME="item_list_name"> </A>4.42.2.24. <A NAME="item_list_name">name</A></H4>
<H2><A NAME="label">4.43. label</A></H2>
<P>The page label for goto. See [<A HREF="#goto">goto</A>] tag for description.  Note that this is not a standard tag, but is simply a marker used by <A HREF="#goto">goto</A>.</P>
<P>Parameter: <B>name</B></P>
<PRE>
    [goto name=<I>label_name</I> if=<I>condition</I>]
        <I>content to skip</I>
    [label name=<I>label_name</I>]
</PRE>
<H3><A NAME="Summary">4.43.1. Summary</A></H3>
<P>NO SUMMARY SECTION</P>
<PRE>
    [<B>label</B>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [label]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;label(  {
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;label(, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.43.2. Description</A></H3>
<P>NO DESCRIPTION SECTION</P>
<H2><A NAME="log">4.44. log</A></H2>
<P>Log contained text to specified file.</P>
<H3><A NAME="Summary">4.44.1. Summary</A></H3>
<PRE>
    [<B>log</B> file <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#log_file">arg</A>
</TD>
<TD VALIGN='Top'>
Alias for file
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#log_create">create</A>
</TD>
<TD VALIGN='Top'>
Set create=1 to create the file if not present
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#log_delim">delim</A>
</TD>
<TD VALIGN='Top'>
Line delimiter
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#log_file">file</A>
</TD>
<TD VALIGN='Top'>
name of file to log to. 'file=&quot;&gt;<I>filename</I>&quot;' also sets 'create' attribute.
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#log_hide">hide</A>
</TD>
<TD VALIGN='Top'>
Suppress status otherwise returned by tag to the page.
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#log_process">process</A>
</TD>
<TD VALIGN='Top'>
Processing (if any) to apply to the content while logging
<UL>
<LI>nostrip (don't strip leading/trailing whitespace and convert &quot;\r\n&quot; to &quot;\n&quot;</UL>
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#log_record_delim">record_delim</A>
</TD>
<TD VALIGN='Top'>
Record delimiter
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#log_type">type</A>
</TD>
<TD VALIGN='Top'>
Log type
<UL>
<LI>text (ordinary text file)
<LI>quot (delimited entries)
<LI>error (add Interchange error formatting and time/location stamps)</UL>
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_reparse">reparse</A>
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>no</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [log file]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;log(  { file =&gt; VALUE_file
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;log(file, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.44.2. Description</A></H3>
<P>Log contained text to specified file.</P>
<H4><A NAME="log_create"> </A>4.44.2.1. <A NAME="log_create">create</A></H4>
<P>Set create=1 to create the file if not present</P>
<H4><A NAME="log_delim"> </A>4.44.2.2. <A NAME="log_delim">delim</A></H4>
<P>Line delimiter</P>
<H4><A NAME="log_file"> </A>4.44.2.3. <A NAME="log_file">file</A></H4>
<P>name of file to log to. 'file=&quot;&gt;<I>filename</I>&quot;' also sets 'create' attribute.</P>
<H4><A NAME="log_hide"> </A>4.44.2.4. <A NAME="log_hide">hide</A></H4>
<P>Suppress status otherwise returned by tag to the page.</P>
<H4><A NAME="log_process"> </A>4.44.2.5. <A NAME="log_process">process</A></H4>
<P>Processing (if any) to apply to the content while logging</P>
<UL>
<LI>nostrip (don't strip leading/trailing whitespace and convert &quot;\r\n&quot; to &quot;\n&quot;</UL>
<H4><A NAME="log_record_delim"> </A>4.44.2.6. <A NAME="log_record_delim">record_delim</A></H4>
<P>Record delimiter</P>
<H4><A NAME="log_type"> </A>4.44.2.7. <A NAME="log_type">type</A></H4>
<P>Log type</P>
<UL>
<LI>text (ordinary text file)
<LI>quot (delimited entries)
<LI>error (add Interchange error formatting and time/location stamps)</UL>
<H2><A NAME="loop">4.45. loop</A></H2>
<H3><A NAME="Summary">4.45.1. Summary</A></H3>
<P>Parameters: <B>list</B></P>
<P>Positional parameters in same order.</P>
<P><B>The attribute hash reference is passed</B> after the parameters but before the container text argument. <B>This may mean that there are parameters not shown here.</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>This is a container tag, i.e. [loop] FOO [/loop]. Nesting: NO</P>
<P>Invalidates cache: <B>no</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    NOTE: This would not usually be used with embedded Perl -- a better
    choice would normally be:

                 for(@list) { CODE }

    $Tag-&gt;loop(
        {
         list =&gt; VALUE,
        },
        BODY
    )

 OR

    $Tag-&gt;loop($list, $ATTRHASH, $BODY);
</PRE>
<P>Attribute aliases</P>
<PRE>
            arg ==&gt; list
            args ==&gt; list
    [<B>loop</B> list <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#loop_list">arg</A>
</TD>
<TD VALIGN='Top'>
Alias for list
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#loop_list">args</A>
</TD>
<TD VALIGN='Top'>
Alias for list
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#loop_list">list</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_reparse">reparse</A>
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>no</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [loop list]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;loop(  { list =&gt; VALUE_list
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;loop(list, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.45.2. Description</A></H3>
<P>Returns a string consisting of the LIST, repeated for every item in a comma-separated or space-separated list. Operates in the same fashion as the [item-list] tag, except for order-item-specific values. Intended to pull multiple attributes from an item modifier&nbsp;-- but can be useful for other things, like building a pre-ordained product list on a page.</P>
<P>Loop lists can be nested reliably in Interchange by using the prefix=&quot;tag&quot; parameter. New syntax:</P>
<PRE>
    [loop list=&quot;A B C&quot;]
        [loop prefix=mid list=&quot;[loop-code]1 [loop-code]2 [loop-code]3&quot;]
            [loop prefix=inner list=&quot;X Y Z&quot;]
                [mid-code]-[inner-code]
            [/loop]
        [/loop]
    [/loop]
</PRE>
<P>You can do an arbitrary search with the search=&quot;args&quot; parameter, just as in a one-click search:</P>
<PRE>
    [loop search=&quot;se=Americana/sf=category&quot;]
        [loop-code] [loop-field title]
    [/loop]
</PRE>
<P>The above will show all items with a category containing the whole world &quot;Americana&quot;, and will work the same in both old and new syntax.</P>
<P>Ranges are accepted when you pass a <TT>list</TT> if you set the <TT>ranges</TT> option:</P>
<PRE>
    [loop list=&quot;A..Z&quot; ranges=1][loop-code] [/loop]
</PRE>
<P>The above lists all of the characters from A to Z. Any Perl incrementing variable list will work, but most commonly a range would be something like <TT>1..100</TT>. You can mix regular sets -- <TT>1..5 10 20</TT> would produce the list <TT>1 2 3 4 5 10 20</TT>.</P>
<P>If you surround the repeating text section with a <TT>[list] [/list]</TT> anchor, the more-list, ml=N, and on-match / no-match processing is done just as in <TT>[query]</TT> and <TT>[search-region]</TT>.</P>
<P>Using the <TT>acclist</TT> option will parse Interchange option lists, as used in product options. The value is available with <TT>[loop-code]</TT>, the label with <TT>[loop-param label]</TT>. If the size data for SKU <TT>TS-007</TT> was set to the string <TT>S=Small, M=Medium, L=Large, XL=Extra Large</TT> then you could produce a select list of options this way:</P>
<PRE>
    [loop list=&quot;[data products size TS-007]&quot; acclist=1]
            [on-match]&lt;SELECT NAME=mv_order_size&gt;[/on-match]
                [list]&lt;OPTION VALUE=&quot;[loop-code]&quot;&gt; [loop-param label]&lt;/OPTION&gt;[/list]
        [on-match]&lt;/SELECT&gt;[/on-match]
    [/loop]
</PRE>
<P>Of course the above is probably more easily produced with <TT>[accessories code=TS-007 attribute=size]</TT>, but there will be other uses for the capability. For instance:</P>
<PRE>
         &lt;SELECT NAME=Season&gt;
    [loop acclist=1
                list=&quot;
                        Q1=Winter,
                        Q2=Spring,
                        Q3=Summer,
                        Q4=Fall
                &quot;]&gt; &lt;OPTION VALUE=&quot;[loop-code]&quot;&gt; [loop-param label]&lt;/OPTION&gt;
    [/loop]
</PRE>
<P>If your parameter list needs to have spaces in the parameters, surround them with double or single quotes and set the quoted=1 option: in product options. If the size data for SKU <TT>TS-007</TT> was set to the string <TT>S=Small, M=Medium, L=Large, XL=Extra Large</TT> then you could produce a select list of options this way:</P>
<PRE>
    [loop list=&quot;[data products size TS-007]&quot; acclist=1]
            [on-match]&lt;SELECT NAME=mv_order_size&gt;[/on-match]
                [list]&lt;OPTION VALUE=&quot;[loop-code]&quot;&gt; [loop-param label]&lt;/OPTION&gt;[/list]
        [on-match]&lt;/SELECT&gt;[/on-match]
    [/loop]
</PRE>
<P>A nice shortcut is available when using [loop] to generate &lt;OPTION&gt; lists inside HTML &lt;SELECT&gt;...&lt;/SELECT&gt; blocks, when you want the user's last selection to be chosen by default on subsequent page views. Interchange simplifies this with functions that output &quot;SELECTED&quot; (surrounded by appropriate whitespace) for an &lt;OPTION&gt; if a certain value is set to the &lt;OPTION VALUE=&quot;...&quot;&gt;. (It sounds more complicated than it really is.)</P>
<P>For example, consider:</P>
<PRE>
&lt;select name=search_cat&gt;
[loop
        search=&quot;
                fi=cat
                st=db
                ra=yes
                rf=name
                tf=name
                un=1
        &quot;
]
&lt;option[selected search_cat [loop-code]&gt;[loop-code]
[/loop]
&lt;/select&gt;
</PRE>
<P>When the user returns to the page, their last selection will be chosen as the default. (Assuming the value search_cat was set after the search, which is normally is with standard searches.)</P>
<P>[loop] offers the <TT>option</TT> attribute, which can give loops that parse faster and are easier to write. The following example is equivalent to the one above:</P>
<PRE>
&lt;select name=search_cat&gt;
[loop
        option=search_cat
        search=&quot;
                fi=cat
                st=db
                ra=yes
                rf=name
                tf=name
                un=1
        &quot;
]
&lt;option&gt;[loop-code]
[/loop]
&lt;/select&gt;
</PRE>
<P>It works equally well when option values are explicitly specified:</P>
<PRE>
&lt;option value=&quot;[loop-code]&quot;&gt;So-called &quot;[loop-code]&quot;
</PRE>
<P>See also the <TT>ictemplates</TT> documentation in the section &quot;Checks and Selections.&quot;</P>
<H4><A NAME="E&lt;lbracket&gt;if-loop-data table column] IF [else] ELSE [/else][/if-loop-field]">4.45.2.1. [if-loop-data table column] IF [else] ELSE [/else][/if-loop-field]</A></H4>
<P>Outputs the IF if the <TT>column</TT> in <TT>table</TT> is non-empty, and the ELSE (if any) otherwise.</P>
<P>See [<A HREF="#if-PREFIX-data">if-PREFIX-data</A>].</P>
<H4><A NAME="E&lt;lbracket&gt;if-loop-field column] IF [else] ELSE [/else][/if-loop-field]">4.45.2.2. [if-loop-field column] IF [else] ELSE [/else][/if-loop-field]</A></H4>
<P>Outputs the <B>IF</B> if the <TT>column</TT> in the <TT>products</TT> table is non-empty, and the <B>ELSE</B> (if any) otherwise. Will fall through to the first non-empty field if there are multiple <A HREF="icconfig.html#ProductFiles">ProductFiles</A>.</P>
<P>See [<A HREF="#if-PREFIX-field">if-PREFIX-field</A>].</P>
<H4><A NAME="E&lt;lbracket&gt;if-loop-param param] IF [else] ELSE [/else][/if-loop-param]">4.45.2.3. [if-loop-param param] IF [else] ELSE [/else][/if-loop-param]</A></H4>
<P>Only works if you have named return fields from a search (or from a passed list with the lr=1 parameter).</P>
<P>Outputs the <B>IF</B> if the returned <TT>param</TT> is non-empty, and the <B>ELSE</B> (if any) otherwise.</P>
<P>See <TT>[if-PREFIX-param]</TT>.</P>
<H4><A NAME="E&lt;lbracket&gt;if-loop-pos N] IF [else] ELSE [/else][/if-loop-pos]">4.45.2.4. [if-loop-pos N] IF [else] ELSE [/else][/if-loop-pos]</A></H4>
<P>Only works if you have multiple return fields from a search (or from a passed list with the lr=1 parameter).</P>
<P>Parameters are numbered from ordinal 0, with [loop-pos 0] being the equivalent of [loop-code].</P>
<P>Outputs the <B>IF</B> if the returned positional parameter <TT>N</TT> is non-empty, and the <B>ELSE</B> (if any) otherwise.</P>
<P>See <TT>[if-PREFIX-pos]</TT>.</P>
<H4><A NAME="E&lt;lbracket&gt;loop-accessories]">4.45.2.5. [loop-accessories]</A></H4>
<P>Outputs an [accessories ...] item.</P>
<P>See [<A HREF="#PREFIX-accessories">PREFIX-accessories</A>].</P>
<H4><A NAME="E&lt;lbracket&gt;loop-change marker]">4.45.2.6. [loop-change marker]</A></H4>
<P>See [<A HREF="#PREFIX-change">PREFIX-change</A>].</P>
<H4><A NAME="E&lt;lbracket&gt;loop-code]">4.45.2.7. [loop-code]</A></H4>
<P>Evaluates to the code for the current item.</P>
<P>See [<A HREF="#PREFIX-code">PREFIX-code</A>].</P>
<H4><A NAME="E&lt;lbracket&gt;loop-data database fieldname]">4.45.2.8. [loop-data database fieldname]</A></H4>
<P>Evaluates to the field name <I>fieldname</I> in the arbitrary database table <I>database</I>, for the current item.</P>
<P>See [<A HREF="#PREFIX-data">PREFIX-data</A>].</P>
<H4><A NAME="E&lt;lbracket&gt;loop-description]">4.45.2.9. [loop-description]</A></H4>
<P>Evaluates to the product description (from the products file, passed description in on-fly item, or description attribute in cart) for the current item.</P>
<P>See [<A HREF="#PREFIX-description">PREFIX-description</A>].</P>
<H4><A NAME="E&lt;lbracket&gt;loop-field fieldname]">4.45.2.10. [loop-field fieldname]</A></H4>
<P>Evaluates to the field name <I>fieldname</I> in the database,  for the current item.</P>
<P>See [<A HREF="#PREFIX-field">PREFIX-field</A>].</P>
<H4><A NAME="E&lt;lbracket&gt;loop-increment]">4.45.2.11. [loop-increment]</A></H4>
<P>Evaluates to the number of the item in the list. Used for numbering items in the list.</P>
<P>Starts from integer 1.</P>
<P>See [<A HREF="#PREFIX-increment">PREFIX-increment</A>].</P>
<H4><A NAME="E&lt;lbracket&gt;loop-last]tags[/loop-last]">4.45.2.12. [loop-last]tags[/loop-last]</A></H4>
<P>Evaluates the output of the Interchange tags encased inside, and if it evaluates to a numerical non-zero number (i.e. 1, 23, or -1) then the loop iteration will terminate. If the evaluated number is <B>negative</B>, then the item itself will be skipped. If the evaluated number is <B>positive</B>, then the item itself will be shown but will be last on the list.</P>
<PRE>
      [loop-last][calc]
        return -1 if '[loop-field weight]' eq '';
        return 1 if '[loop-field weight]' &lt; 1;
        return 0;
        [/calc][/loop-last]
</PRE>
<P>If this is contained in your <TT>[loop list]</TT> and the weight field is empty, then a numerical <TT>-1</TT> will be output from the [calc][/calc] tags; the list will end and the item will <B>not</B> be shown. If the product's weight field is less than 1, a numerical 1 is output. The item will be shown, but will be the last item shown.</P>
<H4><A NAME="E&lt;lbracket&gt;loop-next]tags[/loop-next]">4.45.2.13. [loop-next]tags[/loop-next]</A></H4>
<P>Evaluates the output of the Interchange tags encased inside, and if it evaluates to a numerical non-zero number (i.e. 1, 23, or -1) then the loop will be skipped with no output. Example:</P>
<PRE>
      [loop-next][calc][loop-field weight] &lt; 1[/calc][/loop-next]
</PRE>
<P>If this is contained in your <TT>[loop list]</TT> and the product's weight field is less than 1, then a numerical <TT>1</TT> will be output from the [calc][/calc] operation. The item will not be shown.</P>
<H4><A NAME="E&lt;lbracket&gt;loop-price n* noformat*]">4.45.2.14. [loop-price n* noformat*]</A></H4>
<P>Evaluates to the price for optional quantity n (from the products file) of the current item, with currency formatting. If the optional &quot;noformat&quot; is set, then currency formatting will not be applied.</P>
<H4><A NAME="loop_list"> </A>4.45.2.15. <A NAME="loop_list">list</A></H4>
<H2><A NAME="mail">4.46. mail</A></H2>
<P>Mail contained text to recipient specified by 'to' using the program specified with the SendMailProgram catalog directive.</P>
<H3><A NAME="Summary">4.46.1. Summary</A></H3>
<PRE>
    [<B>mail</B> to <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#mail_extra">extra</A>
</TD>
<TD VALIGN='Top'>
Additional headers (these will also be added to 'raw' messages)
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#mail_hide">hide</A>
</TD>
<TD VALIGN='Top'>
Suppress tag return value. This would otherwise be the 'success' attribute setting.
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#mail_raw">raw</A>
</TD>
<TD VALIGN='Top'>
Send it raw without creating headers and checking content, recipient, subject, etc.
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#mail_show">show</A>
</TD>
<TD VALIGN='Top'>
The tag will return the final message with headers in the page
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#mail_success">success</A>
</TD>
<TD VALIGN='Top'>
Tag return value if successful (default is 1).
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#mail_to">to</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_reparse">reparse</A>
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>YES</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [mail to]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;mail(  { to =&gt; VALUE_to
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;mail(to, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.46.2. Description</A></H3>
<P>Mail contained text to recipient specified by 'to' using the program specified with the SendMailProgram catalog directive.</P>
<H4><A NAME="mail_extra"> </A>4.46.2.1. <A NAME="mail_extra">extra</A></H4>
<P>Additional headers (these will also be added to 'raw' messages)</P>
<H4><A NAME="mail_hide"> </A>4.46.2.2. <A NAME="mail_hide">hide</A></H4>
<P>Suppress tag return value. This would otherwise be the 'success' attribute setting.</P>
<H4><A NAME="mail_raw"> </A>4.46.2.3. <A NAME="mail_raw">raw</A></H4>
<P>Send it raw without creating headers and checking content, recipient, subject, etc.</P>
<H4><A NAME="mail_show"> </A>4.46.2.4. <A NAME="mail_show">show</A></H4>
<P>The tag will return the final message with headers in the page</P>
<H4><A NAME="mail_success"> </A>4.46.2.5. <A NAME="mail_success">success</A></H4>
<P>Tag return value if successful (default is 1).</P>
<H4><A NAME="mail_to"> </A>4.46.2.6. <A NAME="mail_to">to</A></H4>
<H2><A NAME="mvasp">4.47. mvasp</A></H2>
<P>Executes the ASP-style perl code contained by the tag. The code will run under the restrictions of the <A HREF="http://www.perl.com/pub/doc/manual/html/lib/Safe.html">Safe</A> module. This is very similar to the [<A HREF="#perl">perl</A>] tag, except that the standard '&lt;%' and '%&gt;' ASP delimiters allow you to mix HTML and perl code.</P>
<H3><A NAME="Summary">4.47.1. Summary</A></H3>
<PRE>
    [<B>mvasp</B> tables] <I>ASP here</I> [/mvasp]
    [<B>mvasp</B> tables=&quot;db1 db2 ...&quot; <I>other_named_attributes</I>] <I>ASP here</I> [/mvasp]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
tables
</TD>
<TD VALIGN='Top'>
Database tables to be made available to ASP Perl code
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
table
</TD>
<TD VALIGN='Top'>
Alias for <TT>tables</TT>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#mvasp_failure">failure</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#mvasp_no_return">no_return</A>
</TD>
<TD VALIGN='Top'>
<I>Always true</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#mvasp_subs">subs</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#mvasp_subs">arg</A>=&quot;subs&quot;
</TD>
<TD VALIGN='Top'>
<I>Same as</I> <TT>subs</TT>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#mvasp_global">global</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#mvasp_file">file</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_reparse">reparse</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
&lt;% <I>and</I> %&gt;
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [mvasp tables=&quot;products&quot; failure=&quot;ASP Broke &lt;BR&gt;&quot;]
        &lt;P&gt;This is HTML&lt;/p&gt;
        &lt;% my $sku = $Values-&gt;{code}; %&gt;
        &lt;P&gt;More HTML&lt;/p&gt;
        &lt;% my $result = &quot;Looked up SKU $sku. It is a &quot;;
            $result .= $Tag-&gt;data('products', 'description', $sku );
            $Document-&gt;write( &quot;$result &lt;br&gt;\n&quot; ); %&gt;
        &lt;P&gt;Still more HTML&lt;/p&gt;
    [/mvasp]
---
    &lt;P&gt;This is HTML&lt;/p&gt;

    &lt;P&gt;More HTML&lt;/p&gt;
    Looked up SKU os28044. It is a Framing Hammer &lt;br&gt;

    &lt;P&gt;Still more HTML&lt;/p&gt;
</PRE>
<H4><A NAME="See Also">4.47.1.1. See Also</A></H4>
<P><A HREF="#perl">perl</A>, <A HREF="ictemplates.html#Programming">Interchange Programming</A></P>
<H3><A NAME="Description">4.47.2. Description</A></H3>
<P>Executes the ASP-style perl code contained by the tag. The code will run under the restrictions of the <A HREF="http://www.perl.com/pub/doc/manual/html/lib/Safe.html">Safe</A> module. This is very similar to the [<A HREF="#perl">perl</A> no_return=1] tag, except that the standard '&lt;%' and '%&gt;' ASP delimiters allow you to mix HTML and perl code.</P>
<P>See the <A HREF="#perl">perl</A> tag and <A HREF="ictemplates.html#ASP-Like Perl">ASP-Like Perl</A> sections for more detail.</P>
<H4><A NAME="mvasp_tables"> </A>4.47.2.1. <A NAME="mvasp_tables">tables</A></H4>
<P>Whitespace-separated list of database tables to make available within the ASP-Perl code. See <A HREF="#perl_tables">perl</A> tag.</P>
<H4><A NAME="mvasp_failure"> </A>4.47.2.2. <A NAME="mvasp_failure">failure</A></H4>
<P>The value the tag should return in case the perl code fails the eval. See <A HREF="#perl_failure">perl</A> tag.</P>
<H4><A NAME="mvasp_no_return"> </A>4.47.2.3. <A NAME="mvasp_no_return">no_return</A></H4>
<P>The return value of the perl code is always suppressed. If you want output from the ASP code sections, you must explicitly write it with the &amp;HTML or $Document-&gt;write() functions.</P>
<P>You can also retrieve the return value of the perl code from the session hash via <TT>[<A HREF="#data">data</A>&nbsp;session&nbsp;mv_perl_result]</TT>. See <A HREF="#perl_no_return">perl</A> tag.</P>
<H4><A NAME="mvasp_subs"> </A>4.47.2.4. <A NAME="mvasp_subs">subs</A></H4>
<P>Enable <A HREF="icconfig.html#GlobalSub *global*">GlobalSub</A> routines (requires catalog directive <A HREF="icconfig.html#AllowGlobal *global*">AllowGlobal</A>). See <A HREF="#perl_subs">perl</A> tag.</P>
<H4><A NAME="mvasp_global"> </A>4.47.2.5. <A NAME="mvasp_global">global</A></H4>
<P>Turn off <A HREF="http://www.perl.com/pub/doc/manual/html/lib/Safe.html">Safe</A> protection (requires catalog directive <A HREF="icconfig.html#AllowGlobal *global*">AllowGlobal</A>). See <A HREF="#perl_global">perl</A> tag.</P>
<H4><A NAME="mvasp_file"> </A>4.47.2.6. <A NAME="mvasp_file">file</A></H4>
<P>Prepend the contents of the specified file or <TT>FileDatabase</TT> entry to the perl code before <TT>eval</TT>'ing it. See <A HREF="#perl_file">perl</A> tag.</P>
<H4><A NAME="Examples">4.47.2.7. Examples</A></H4>
<P>See the <A HREF="ictemplates.html#ASP-Like Perl">ASP-Like Perl</A> section of <A HREF="ictemplates.html#Programming">Interchange Programming</A>.</P>
<H2><A NAME="nitems">4.48. nitems</A></H2>
<P>Returns the total number of items ordered.  Uses the current cart if none specified.</P>
<H3><A NAME="Summary">4.48.1. Summary</A></H3>
<PRE>
    [<B>nitems</B> name]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#nitems_compare">compare</A>
</TD>
<TD VALIGN='Top'>
Regular expression the specified qualifier attribute's value must match to be counted. This replaces the truth value comparison.
<UL>
<LI>Default: None (uses truth value of the specified qualifier attribute)</UL>
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#nitems_name">name</A>
</TD>
<TD VALIGN='Top'>
Cart name
<UL>
<LI>Default: current cart</UL>
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#nitems_qualifier">qualifier</A>
</TD>
<TD VALIGN='Top'>
An item attribute that must be true in order to count the item.
<UL>
<LI>Default: None</UL>
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>YES</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [nitems name]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;nitems(  { name =&gt; VALUE_name
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;nitems(name, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.48.2. Description</A></H3>
<P>Expands into the total number of items ordered so far. Takes an optional cart name as a parameter.</P>
<H4><A NAME="nitems_compare"> </A>4.48.2.1. <A NAME="nitems_compare">compare</A></H4>
<P>Regular expression the specified qualifier attribute's value must match to be counted. This replaces the truth value comparison.</P>
<UL>
<LI>Default: None (uses truth value of the specified qualifier attribute)</UL>
<H4><A NAME="nitems_name"> </A>4.48.2.2. <A NAME="nitems_name">name</A></H4>
<P>Cart name</P>
<UL>
<LI>Default: current cart</UL>
<H4><A NAME="nitems_qualifier"> </A>4.48.2.3. <A NAME="nitems_qualifier">qualifier</A></H4>
<P>An item attribute that must be true in order to count the item.</P>
<UL>
<LI>Default: None</UL>
<H2><A NAME="options">4.49. options</A></H2>
<P>Builds HTML widgets as defined in the options table for selecting options associated with a given product. This tag handles simple, matrix or modular options.  See also the <A HREF="#accessories">accessories</A> tag.</P>
<P>Here is an illustrative example from the 'tools' sample data set of the foundation catalog:</P>
<PRE>
===
    [options code=os28005]
---
    &lt;input type=hidden name=mv_item_option value=&quot;logo&quot;&gt;
        &lt;SELECT NAME=&quot;mv_order_logo&quot;&gt;
        &lt;OPTION VALUE=&quot;c&quot;&gt;Construct Something
        &lt;OPTION VALUE=&quot;y&quot; SELECTED&gt;Your Logo&lt;/SELECT&gt;&lt;BR&gt;
    &lt;input type=hidden name=mv_item_option value=&quot;color&quot;&gt;
        &lt;INPUT TYPE=&quot;radio&quot; NAME=&quot;mv_order_color&quot; VALUE=&quot;BLK&quot; &gt;&amp;nbsp;Black
        &lt;INPUT TYPE=&quot;radio&quot; NAME=&quot;mv_order_color&quot; VALUE=&quot;BEIGE&quot; &gt;&amp;nbsp;Beige
        &lt;INPUT TYPE=&quot;radio&quot; NAME=&quot;mv_order_color&quot; VALUE=&quot;WHITE&quot; &gt;&amp;nbsp;White&lt;BR&gt;
    &lt;input type=hidden name=mv_item_option value=&quot;bristle&quot;&gt;
        &lt;SELECT NAME=&quot;mv_order_bristle&quot;&gt;
        &lt;OPTION VALUE=&quot;synthetic&quot;&gt;Synthetic
        &lt;OPTION VALUE=&quot;camel&quot;&gt;Camel Hair&lt;/SELECT&gt;
===
</PRE>
<H3><A NAME="Summary">4.49.1. Summary</A></H3>
<PRE>
    [<B>options</B> code]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#options_bold">bold</A>
</TD>
<TD VALIGN='Top'>
Boldfaces the labels if the <TT>'label'</TT> option is set.
<UL>
<LI>Default: False</UL>
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#options_code">code</A>
</TD>
<TD VALIGN='Top'>
Product key (usually sku).
<UL>
<LI>No default</UL>
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#options_joiner">joiner</A>
</TD>
<TD VALIGN='Top'>
The joiner for the widgets.
<UL>
<LI>Default: &lt;BR&gt;</UL>
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#options_label">label</A>
</TD>
<TD VALIGN='Top'>
Shows labels for the options with the widgets.
<P>The following example (using another item from the 'tools' data) illustrates the price and label attributes:</P>
<PRE>
===
   [options code=os28011 label=1 price=1]
---
   Handle&lt;BR&gt;
     &lt;input type=hidden name=mv_item_option value=&quot;handle&quot;&gt;
       &lt;SELECT NAME=&quot;mv_order_handle&quot;&gt;
       &lt;OPTION VALUE=&quot;W&quot;&gt;Wood handle
       &lt;OPTION VALUE=&quot;E&quot;&gt;Ebony handle ($20.00)&lt;/SELECT&gt;&lt;BR&gt;
   Blade material&lt;BR&gt;
     &lt;input type=hidden name=mv_item_option value=&quot;blade&quot;&gt;
       &lt;SELECT NAME=&quot;mv_order_blade&quot;&gt;
       &lt;OPTION VALUE=&quot;P&quot;&gt;Plastic blade ($-1.22)
       &lt;OPTION VALUE=&quot;S&quot; SELECTED&gt;Steel blade
       &lt;OPTION VALUE=&quot;T&quot;&gt;Titanium blade ($100.00)&lt;/SELECT&gt;
===
</PRE>
<P>(again, the output has been reformatted to fit the page).</P>
<UL>
<LI>Default: False</UL>
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#options_price">price</A>
</TD>
<TD VALIGN='Top'>
Boolean. If set and the options have prices, the HTML widget(s) will show the prices. This is like the <A HREF="#accessories_price">price</A> attribute of the accessories tag.
<UL>
Note that the <A HREF="#accessories_price_data">price_data</A> setting comes from the 'price' column of the options table.
<BR>
Technical note-- If your options table has different mappings, you can control this with $::Variable-&gt;{MV_OPTION_TABLE_MAP}</UL>
</TD>
<TD VALIGN='Top'>
False
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#options_table">table</A>
</TD>
<TD VALIGN='Top'>
Table to use for option attributes.
<UL>
<LI>Default: 'options'</UL>
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#options_td">td</A>
</TD>
<TD VALIGN='Top'>
Results as table rows. For example, compare the following example from the 'tools' sample data set with the earlier example:
<PRE>
===
   [options code=os28005 td=1]
---
   &lt;td&gt;&lt;input type=hidden name=mv_item_option value=&quot;logo&quot;&gt;
      &lt;SELECT NAME=&quot;mv_order_logo&quot;&gt;
      &lt;OPTION VALUE=&quot;c&quot;&gt;Construct Something
      &lt;OPTION VALUE=&quot;y&quot; SELECTED&gt;Your Logo&lt;/SELECT&gt;&lt;/td&gt;
   &lt;td&gt;&lt;input type=hidden name=mv_item_option value=&quot;color&quot;&gt;
      &lt;INPUT TYPE=&quot;radio&quot; NAME=&quot;mv_order_color&quot; VALUE=&quot;BLK&quot; &gt;&amp;nbsp;Black
      &lt;INPUT TYPE=&quot;radio&quot; NAME=&quot;mv_order_color&quot; VALUE=&quot;BEIGE&quot; &gt;&amp;nbsp;Beige
      &lt;INPUT TYPE=&quot;radio&quot; NAME=&quot;mv_order_color&quot; VALUE=&quot;WHITE&quot; &gt;&amp;nbsp;White&lt;/td&gt;
   &lt;td&gt;&lt;input type=hidden name=mv_item_option value=&quot;bristle&quot;&gt;
      &lt;SELECT NAME=&quot;mv_order_bristle&quot;&gt;
      &lt;OPTION VALUE=&quot;synthetic&quot;&gt;Synthetic
      &lt;OPTION VALUE=&quot;camel&quot;&gt;Camel Hair&lt;/SELECT&gt;&lt;/td&gt;
===
</PRE>
<P>(Note that the output was reformatted to fit this page)</P>
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>no</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [options code]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;options(  { code =&gt; VALUE_code
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;options(code, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.49.2. Description</A></H3>
<P>NO DESCRIPTION SECTION</P>
<H4><A NAME="options_bold"> </A>4.49.2.1. <A NAME="options_bold">bold</A></H4>
<P>Boldfaces the labels if the <TT>'label'</TT> option is set.</P>
<UL>
<LI>Default: False</UL>
<H4><A NAME="options_code"> </A>4.49.2.2. <A NAME="options_code">code</A></H4>
<P>Product key (usually sku).</P>
<UL>
<LI>No default</UL>
<H4><A NAME="options_joiner"> </A>4.49.2.3. <A NAME="options_joiner">joiner</A></H4>
<P>The joiner for the widgets.</P>
<UL>
<LI>Default: &lt;BR&gt;</UL>
<H4><A NAME="options_label"> </A>4.49.2.4. <A NAME="options_label">label</A></H4>
<P>Shows labels for the options with the widgets.</P>
<P>The following example (using another item from the 'tools' data) illustrates the price and label attributes:</P>
<PRE>
===
   [options code=os28011 label=1 price=1]
---
   Handle&lt;BR&gt;
     &lt;input type=hidden name=mv_item_option value=&quot;handle&quot;&gt;
       &lt;SELECT NAME=&quot;mv_order_handle&quot;&gt;
       &lt;OPTION VALUE=&quot;W&quot;&gt;Wood handle
       &lt;OPTION VALUE=&quot;E&quot;&gt;Ebony handle ($20.00)&lt;/SELECT&gt;&lt;BR&gt;
   Blade material&lt;BR&gt;
     &lt;input type=hidden name=mv_item_option value=&quot;blade&quot;&gt;
       &lt;SELECT NAME=&quot;mv_order_blade&quot;&gt;
       &lt;OPTION VALUE=&quot;P&quot;&gt;Plastic blade ($-1.22)
       &lt;OPTION VALUE=&quot;S&quot; SELECTED&gt;Steel blade
       &lt;OPTION VALUE=&quot;T&quot;&gt;Titanium blade ($100.00)&lt;/SELECT&gt;
===
</PRE>
<P>(again, the output has been reformatted to fit the page).</P>
<UL>
<LI>Default: False</UL>
<H4><A NAME="options_price"> </A>4.49.2.5. <A NAME="options_price">price</A></H4>
<P>Boolean. If set and the options have prices, the HTML widget(s) will show the prices. This is like the <A HREF="#accessories_price">price</A> attribute of the accessories tag.</P>
<UL>
Note that the <A HREF="#accessories_price_data">price_data</A> setting comes from the 'price' column of the options table.
<BR>
Technical note-- If your options table has different mappings, you can control this with $::Variable-&gt;{MV_OPTION_TABLE_MAP}
<LI>Default: False</UL>
<H4><A NAME="options_table"> </A>4.49.2.6. <A NAME="options_table">table</A></H4>
<P>Table to use for option attributes.</P>
<UL>
<LI>Default: 'options'</UL>
<H4><A NAME="options_td"> </A>4.49.2.7. <A NAME="options_td">td</A></H4>
<P>Results as table rows. For example, compare the following example from the 'tools' sample data set with the earlier example:</P>
<PRE>
===
   [options code=os28005 td=1]
---
   &lt;td&gt;&lt;input type=hidden name=mv_item_option value=&quot;logo&quot;&gt;
      &lt;SELECT NAME=&quot;mv_order_logo&quot;&gt;
      &lt;OPTION VALUE=&quot;c&quot;&gt;Construct Something
      &lt;OPTION VALUE=&quot;y&quot; SELECTED&gt;Your Logo&lt;/SELECT&gt;&lt;/td&gt;
   &lt;td&gt;&lt;input type=hidden name=mv_item_option value=&quot;color&quot;&gt;
      &lt;INPUT TYPE=&quot;radio&quot; NAME=&quot;mv_order_color&quot; VALUE=&quot;BLK&quot; &gt;&amp;nbsp;Black
      &lt;INPUT TYPE=&quot;radio&quot; NAME=&quot;mv_order_color&quot; VALUE=&quot;BEIGE&quot; &gt;&amp;nbsp;Beige
      &lt;INPUT TYPE=&quot;radio&quot; NAME=&quot;mv_order_color&quot; VALUE=&quot;WHITE&quot; &gt;&amp;nbsp;White&lt;/td&gt;
   &lt;td&gt;&lt;input type=hidden name=mv_item_option value=&quot;bristle&quot;&gt;
      &lt;SELECT NAME=&quot;mv_order_bristle&quot;&gt;
      &lt;OPTION VALUE=&quot;synthetic&quot;&gt;Synthetic
      &lt;OPTION VALUE=&quot;camel&quot;&gt;Camel Hair&lt;/SELECT&gt;&lt;/td&gt;
===
</PRE>
<P>(Note that the output was reformatted to fit this page)</P>
<H2><A NAME="or">4.50. or</A></H2>
<H3><A NAME="Summary">4.50.1. Summary</A></H3>
<P>Parameters: <B>type term op compare</B></P>
<P>THIS TAG HAS SPECIAL POSITIONAL PARAMETER HANDLING.</P>
<P>Pass attribute hash as last to subroutine: <B>no</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>Invalidates cache: <B>no</B></P>
<P>Called Routine:</P>
<P>Called Routine for positional:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;or(
        {
         type =&gt; VALUE,
         term =&gt; VALUE,
         op =&gt; VALUE,
         compare =&gt; VALUE,
        }
    )

 OR

    $Tag-&gt;or($type, $term, $op, $compare);
</PRE>
<P>Attribute aliases</P>
<PRE>
            base ==&gt; type
            comp ==&gt; compare
            operator ==&gt; op
    [<B>or</B> type term op compare]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#or_type">base</A>
</TD>
<TD VALIGN='Top'>
Alias for type
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#or_compare">comp</A>
</TD>
<TD VALIGN='Top'>
Alias for compare
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#or_compare">compare</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#or_op">op</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#or_op">operator</A>
</TD>
<TD VALIGN='Top'>
Alias for op
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#or_term">term</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#or_type">type</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>no</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [or type term op compare]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;or(  { compare =&gt; VALUE_compare
                 op =&gt; VALUE_op
                 term =&gt; VALUE_term
                 type =&gt; VALUE_type
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;or(type,term,op,compare, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.50.2. Description</A></H3>
<P><B>NO Description</B></P>
<H4><A NAME="or_compare"> </A>4.50.2.1. <A NAME="or_compare">compare</A></H4>
<H4><A NAME="or_op"> </A>4.50.2.2. <A NAME="or_op">op</A></H4>
<H4><A NAME="or_term"> </A>4.50.2.3. <A NAME="or_term">term</A></H4>
<H4><A NAME="or_type"> </A>4.50.2.4. <A NAME="or_type">type</A></H4>
<H2><A NAME="order">4.51. order</A></H2>
<P>Expands into a hypertext link which will include the specified item in the list of products to order and display the order page.</P>
<H3><A NAME="Summary">4.51.1. Summary</A></H3>
<PRE>
    [<B>order</B> code quantity]<I>Link Text</I>&lt;/A&gt;
    [<B>order</B> code=os28044 quantity=2]<I>Link Text</I>&lt;/A&gt;
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
code
</TD>
<TD VALIGN='Top'>
This is the unique identifier for the item, typically the SKU in the products table
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
quantity
</TD>
<TD VALIGN='Top'>
Quantity to order
</TD>
<TD VALIGN='Top'>
1
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
code
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
page
</TD>
<TD VALIGN='Top'>
<I>SpecialPage order</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
cart
</TD>
<TD VALIGN='Top'>
<I>main cart</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
base
</TD>
<TD VALIGN='Top'>
<I>ProductFiles array</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
area
</TD>
<TD VALIGN='Top'>
<I>off</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has end tag
</TD>
<TD VALIGN='Top'>
<I>No</I> (<TT>[/order]</TT> is a macro for <TT>&lt;/A&gt;</TT>)
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [order os28044 2]Buy Framing Hammer[/order]
---
    &lt;A HREF=&quot;http://localhost.localdomain/cgi-bin/tag72/ord/basket?\
    mv_session_id=6CZ2whqo&amp;mv_pc=1&amp;mv_action=refresh&amp;\
    mv_order_item=os28044&amp;mv_order_quantity=3&quot;&gt;Buy Framing Hammer&lt;/A&gt;
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;order($code, $quantity);
</PRE>
<H3><A NAME="Description">4.51.2. Description</A></H3>
<P>Expands into a hypertext link which will include the specified code in the list of products to order and display the order page.</P>
<P><B>code</B> should be a product code listed in one of the &quot;products&quot; databases. The optional argument <B>base</B> constrains the order to a particular products file. If not specified, all tables defined as <A HREF="icconfig.html#ProductFiles">ProductFiles</A> will be searched in sequence for the item.</P>
<P>The optional argument <B>cart</B> selects the shopping cart where the item will be placed.</P>
<P><B>page</B> allows you to specify a different order page than the default one specified by SpecialPage order.</P>
<H3><A NAME="How to Order an Item">4.51.3. How to Order an Item</A></H3>
<P>Interchange can either use a form-based order or a link-based order to place an item in the shopping cart. The <TT>order</TT> tag creates a link-based order.</P>
<P>You can use the <A HREF="#area">area</A> tag with form variables if you need more control, for example, to change frames for the order:</P>
<PRE>
   &lt;A HREF=&quot;[area href=ord/basket
                  form=&quot;mv_order_item=os28044
                        mv_order_quantity=2
                        mv_action=refresh&quot;]&quot;
    TARGET=newframe&gt; Order Framing Hammer&lt;/A&gt;
</PRE>
<P>This can also be done more easily with the <TT>area</TT> option to the <TT>order</TT> tag:</P>
<PRE>
    &lt;A HREF=&quot;[order code=os28044 quantity=2 area=1]&quot;
         TARGET=newframe&gt; Order Framing Hammer&lt;/A&gt;
</PRE>
<P>To order with a form, you set the form variable <TT>mv_order_item</TT> to the item-code/SKU and use the <TT>refresh</TT> action:</P>
<PRE>
   &lt;FORM ACTION=&quot;[process]&quot; METHOD=POST&gt;
   &lt;INPUT TYPE=hidden  NAME=&quot;mv_todo&quot;        VALUE=&quot;refresh&quot;&gt;
   &lt;INPUT TYPE=hidden  NAME=&quot;mv_order_item&quot;  VALUE=&quot;os28044&quot;&gt;

   Order &lt;INPUT NAME=&quot;mv_order_quantity&quot; SIZE=3 VALUE=1&gt; Framing Hammer

   &lt;INPUT TYPE=submit VALUE=&quot;Order!&quot;&gt;
   &lt;/FORM&gt;
</PRE>
<P>Groups of items may be batched:</P>
<PRE>
   &lt;FORM ACTION=&quot;[process]&quot; METHOD=POST&gt;
   &lt;INPUT TYPE=hidden  NAME=&quot;mv_todo&quot;        VALUE=&quot;refresh&quot;&gt;

   &lt;INPUT TYPE=hidden  NAME=&quot;mv_order_item&quot;  VALUE=&quot;TK112&quot;&gt;
   &lt;INPUT NAME=&quot;mv_order_quantity&quot; SIZE=3&gt; Standard Toaster

   &lt;INPUT TYPE=hidden  NAME=&quot;mv_order_item&quot;  VALUE=&quot;TK200&quot;&gt;
   &lt;INPUT NAME=&quot;mv_order_quantity&quot; SIZE=3&gt; Super Toaster

   &lt;INPUT TYPE=submit VALUE=&quot;Order!&quot;&gt;
   &lt;/FORM&gt;
</PRE>
<P>Items that have a quantity of zero (or blank) will be skipped. Only items with a positive quantity will be placed in the basket.</P>
<P>Attributes like size or color may be specified at time of order. See the <A HREF="#accessories">accessories</A> tag for detail.</P>
<H2><A NAME="page">4.52. page</A></H2>
<P>Expands to a hyperlink to an Interchange page or action, including surrounding &lt;A&nbsp;HREF&nbsp;...&gt;. The URL within the link includes the Interchange session ID and supplied arguments. The optional [/page] is simply a macro for &lt;/A&gt;.</P>
<P>If you do not want the &lt;A&nbsp;HREF&nbsp;...&gt;, use the <A HREF="#area">area</A> tag instead&nbsp;-- these are equivalent:</P>
<PRE>
    [page href=dir/page arg=mv_arg]TargetName&lt;/A&gt;
    &lt;A HREF=&quot;[area href=dir/page arg=mv_arg]&quot;&gt;TargetName&lt;/A&gt;
</PRE>
<H3><A NAME="Summary">4.52.1. Summary</A></H3>
<PRE>
    [<B>page</B> href arg]
    [<B>page</B> href=dir/page arg=page_arguments <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
href
</TD>
<TD VALIGN='Top'>
Path to Interchange page or action
<UL>
<I>Special arguments</I><UL>
<LI>'scan' treats <B>arg</B> as a search argument
<LI>'http://...' external link (requires <B>form</B> attribute)</UL></UL>
</TD>
<TD VALIGN='Top'>
process
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
arg
</TD>
<TD VALIGN='Top'>
Interchange arguments to page or action
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<I>base</I>
</TD>
<TD VALIGN='Top'>
alias for <B>arg</B>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#page_extra">extra</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#page_form">form</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#page_search">search</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#page_secure">secure</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Macro
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has end tag
</TD>
<TD VALIGN='Top'>
<I>No</I> (<TT>[/page]</TT> is a macro for <TT>&lt;/A&gt;</TT>)
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [page href=dir/page.html arg=&quot;arg1=AA/arg2=BB&quot;]

    &lt;a href=&quot;www.here.com/cgi-bin/mycatalog/page.html?mv_session_id=6CZ2whqo&amp;\
    mv_pc=1&amp;mv_arg=arg1%3dAA/arg2%3dBB&quot;&gt;
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;page(  { href =&gt; <TT>&quot;dir/page&quot;</TT>,
                   arg  =&gt; <TT>&quot;arguments&quot;</TT>, }  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;page($href, $arg, $attribute_hash_reference);
</PRE>
<P>Using arrayref for joined search (see also <A HREF="#attr_array_hash">Attribute Arrays and Hashes</A>)</P>
<PRE>
    my $searchref = [ &quot;se=hammer/fi=products/sf=description&quot;,
                      &quot;se=plutonium/fi=products/sf=description&quot;, ];

    $Tag-&gt;page( { href   =&gt; 'scan',
                  search =&gt; $searchref, } );
</PRE>
<H4><A NAME="See Also">4.52.1.1. See Also</A></H4>
<P><A HREF="#area">area</A></P>
<H3><A NAME="Description">4.52.2. Description</A></H3>
<P>The <TT>page</TT> tag inserts a hyperlink to the specified Interchange page or action. For example, [<TT>page</TT> shirts] will expand into</P>
<PRE>
   &lt;a&nbsp;href=&quot;http://www.here.com/cgi-bin/mycatalog/shirts?mv_session_id=6CZ2whqo&amp;mv_pc=1&quot;&gt;
</PRE>
<P>The catalog page displayed will come from &quot;shirts.html&quot; in the pages directory.</P>
<P>The additional argument will be passed to Interchange and placed in the {arg} session parameter. This allows programming of a conditional page display based on where the link came from. The argument is then available with the tag [data session arg], or the embedded Perl session variable $Session-&gt;{arg}. Spaces and some other characters will be escaped with the %NN HTTP-style notation and unescaped when the argument is read back into the session.</P>
<P>For better performance, Interchange can prebuild and cache pages that would otherwise be generated dynamically. If Interchange has built such a static page for the target, the <TT>page</TT> tag produces a link to the cached page whenever the user has accepted and sent back a cookie with the session ID. If the user did not accept the cookie, Interchange cannot use the cache, since the link must then include the <I>mv_session_id</I> argument in order to preserve session.</P>
<H4><A NAME="page_extra"> </A>4.52.2.1. <A NAME="page_extra">extra</A></H4>
<H4><A NAME="page_form"> </A>4.52.2.2. <A NAME="page_form">form</A></H4>
<P>The optional <TT>form</TT> argument allows you to encode a form in the link.</P>
<PRE>
        [page form=&quot;mv_order_item=os28044
                    mv_order_size=15oz
                    mv_order_quantity=1
                    mv_separate_items=1
                    mv_todo=refresh&quot;] Order 15oz Framing Hammer&lt;/A&gt;
</PRE>
<P>The two form values <I>mv_session_id</I> and <I>mv_arg</I> are automatically added when appropriate. The form value <I>mv_arg</I> receives the value of the tag's <TT>arg</TT> parameter.</P>
<P>This would generate a form that ordered quantity one of item number <TT>os28044</TT> with size <TT>15oz</TT>. The item would appear on a separate line in the shopping cart, since <TT>mv_separate_items</TT> is set. Since the <TT>href</TT> is not set, you will go to the default shopping cart page&nbsp;-- alternatively, you could have set <TT>mv_orderpage=yourpage</TT> to go to <TT>yourpage</TT>.</P>
<P>All normal Interchange form caveats apply&nbsp;-- you must have an action, you must supply a page if you don't want to go to the default, etc.</P>
<P>You can theoretically submit any form with this, though none of the included values can have newlines or trailing whitespace. If you want to do something like that you will have to write a UserTag.</P>
<P>If the parameter <TT>href</TT> is not supplied, <I>process</I> is used, causing normal Interchange form processing.</P>
<P>If the <TT>href</TT> points to an http:// link, then no Interchange URL processing will be done, but the URL will include mv_session_id, mv_pc, and any arguments supplied with the <TT>arg</TT> attribute:</P>
<PRE>
       [page  href=&quot;http://www.elsewhere.net/cgi/script&quot;
              form=&quot;cgi_1=ONE
                    cgi_2=TWO&quot;
               arg=&quot;Interchange argument&quot;]External link&lt;/A&gt;

       &lt;A HREF=&quot;http://www.elsewhere.net/cgi/script?\
        mv_session_id=6CZ2whqo&amp;mv_pc=1&amp;mv_arg=Interchange%20argument&amp;\
        cgi_1=ONE&amp;cgi_2=TWO&quot;&gt;External link&lt;/A&gt;
</PRE>
<H4><A NAME="page_search"> </A>4.52.2.3. <A NAME="page_search">search</A></H4>
<P>Interchange allows you to pass a search in a URL. There are two ways to do this:</P>
<OL>
<LI>Place the search specification in the named <TT>search</TT> attribute.<UL>
<LI>Interchange will ignore the <TT>href</TT> parameter (the link will be set to 'scan'.</UL><UL>
<LI>If you give the <TT>arg</TT> parameter a value, that value will be available as [<A HREF="#value">value</A> mv_arg] within the search display page.</UL>
<LI>Set the <TT>href</TT> parameter to 'scan' and set <TT>arg</TT> to the search specification.<UL>
<LI>Note that you can use this form positionally&nbsp;-- the values go into <TT>href</TT> and <TT>arg</TT>, so you do not have to name parameters.</UL></OL>
<P>These are identical:</P>
<PRE>
    [page scan
          se=Impressionists
          sf=category]
        Impressionist Paintings
    &lt;/a&gt;

    [page href=scan
          arg=&quot;se=Impressionists
               sf=category&quot;]
        Impressionist Paintings
    &lt;/A&gt;

    [page search=&quot;se=Impressionists
                  sf=category&quot;]
        Impressionist Paintings
    &lt;/a&gt;
</PRE>
<P>Here is the same thing from a non-Interchange page (e.g., a home page), assuming '/cgi-bin/mycatalog' is the CGI path to Interchange's vlink):</P>
<PRE>
     &lt;A HREF=&quot;/cgi-bin/mycatalog/scan/se=Impressionists/sf=category&quot;&gt;
        Impressionist Paintings
     &lt;/A&gt;
</PRE>
<P>Sometimes, you will find that you need to pass characters that will not be interpreted positionally. In that case, you should quote the arguments:</P>
<PRE>
    [page href=scan
          arg=|
                se=&quot;Something with spaces&quot;
          |]
</PRE>
<P>See the <A HREF="#Search and Form Variables">Search and Form Variables</A> appendix for a listing of the form variables along with two-letter abbreviations and descriptions.</P>
<P>They can be treated just the same as form variables on the page, except that they can't contain spaces, '/' in a file name, or quote marks. These characters can be used in URL hex encoding, i.e. %20 is a space, %2F is a <TT>/</TT>, etc.&nbsp;-- <TT>&amp;sp;</TT> or <TT>&amp;#32;</TT> will not be recognized. If you use one of the methods below to escape these &quot;unsafe&quot; characters, you won't have to worry about this.</P>
<P>You may specify a one-click search in three different ways. The first is as used in previous versions, with the scan URL being specified completely as the page name. The second two use the &quot;argument&quot; parameter to the <TT>[page ...]</TT> or [<A HREF="#area">area</A> ...]&gt; tags to specify the search (an argument to a scan is never valid anyway).</P>
<H4><A NAME="page_secure"> </A>4.52.2.4. <A NAME="page_secure">secure</A></H4>
<H4><A NAME="Original syntax">4.52.2.5. Original syntax</A></H4>
<P>If you wish to do an OR search on the fields category and artist for the strings &quot;Surreal&quot; and &quot;Gogh&quot;, while matching substrings, you would do:</P>
<PRE>
 [page scan se=Surreal/se=Gogh/os=yes/su=yes/sf=artist/sf=category]
    Van Gogh -- compare to surrealists
 &lt;/a&gt;
</PRE>
<P>In this method of specification, to replace a / (slash) in a file name (for the sp, bd, or fi parameter) you must use the shorthand of ::, i.e. sp=results::standard. (This may not work for some browsers, so you should probably either put the page in the main pages directory or define the page in a search profile.)</P>
<H4><A NAME="Ampersand syntax">4.52.2.6. Ampersand syntax</A></H4>
<P>You can substitute &amp; for / in the specification and be able to use / and quotes and spaces in the specification.</P>
<PRE>
 [page scan se=&quot;Van Gogh&quot;&amp;sp=lists/surreal&amp;os=yes&amp;su=yes&amp;sf=artist&amp;sf=category]
    Van Gogh -- compare to surrealists
 &lt;/a&gt;
</PRE>
<P>Any &quot;unsafe&quot; characters will be escaped.</P>
<H4><A NAME="Multi-line syntax">4.52.2.7. Multi-line syntax</A></H4>
<P>You can specify parameters one to a line, as well.</P>
<PRE>
    [page scan
        se=&quot;Van Gogh&quot;
        sp=lists/surreal
        os=yes
        su=yes
        sf=artist
        sf=category
    ] Van Gogh -- compare to surrealists &lt;/a&gt;
</PRE>
<P>Any &quot;unsafe&quot; characters will be escaped. You may not search for trailing spaces in this method; it is allowed in the other notations.</P>
<H4><A NAME="Joined searches">4.52.2.8. Joined searches</A></H4>
<P>You can also specify a joined search using an attribute array (see <A HREF="#attr_array_hash">Attribute Arrays and Hashes</A>):</P>
<PRE>
    [page href=scan
      search.0=&quot;se=fragrant
                fi=products
                sf=smell&quot;
      search.1=&quot;se=purple
                sf=color&quot;
      search.2=&quot;se=perennial
                sf=type&quot;]
</PRE>
<P>The search routine called by the page tag automatically adds the other relevant search specification elements, including the 'co=yes' to indicate a combined search (<A HREF="icdatabase.html#Coordinated and Joined Searching">joined</A>&nbsp;searches are described in the Interchange database documentation).</P>
<H4><A NAME="E&lt;lbracket&gt;/page]">4.52.2.9. [/page]</A></H4>
<P>This is not an actual end tag, but simply a macro that expands to &lt;/A&gt;. The following two lines are equivalent:</P>
<PRE>
  [page shirts]Our shirt collection[/page]
  [page shirts]Our shirt collection&lt;/A&gt;
</PRE>
<P>Tip: In large pages, just use the &lt;/A&gt; tag for a small performance improvement.</P>
<H2><A NAME="perl">4.53. perl</A></H2>
<P>Executes the perl code contained by the tag. The code will run under the restrictions of Perl's <A HREF="http://www.perl.com/pub/doc/manual/html/lib/Safe.html">Safe</A> module by default. The tag expands to the value returned by the enclosed code (i.e., printing to STDOUT or STDERR is useless).</P>
<P>See also <A HREF="ictemplates.html#Programming">Interchange Programming</A>.</P>
<H3><A NAME="Summary">4.53.1. Summary</A></H3>
<PRE>
    [<B>perl</B> tables] <I>Code here</I> [/perl]
    [<B>perl</B> tables=&quot;db1 db2 ...&quot; <I>other_named_attributes</I>] <I>Code here</I> [/perl]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
tables
</TD>
<TD VALIGN='Top'>
Database tables to be made available to ASP Perl code
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
table
</TD>
<TD VALIGN='Top'>
Alias for <TT>tables</TT>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#perl_failure">failure</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#perl_no_return">no_return</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#perl_subs">subs</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#perl_subs">arg</A>=&quot;subs&quot;
</TD>
<TD VALIGN='Top'>
<I>Same as</I> <TT>subs</TT>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#perl_global">global</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#perl_file">file</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#perl_number_errors">number_errors</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#perl_eval_label">eval_label</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#perl_short_errors">short_errors</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#perl_trim_errors">trim_errors</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_reparse">reparse</A>
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [perl tables=&quot;products&quot; failure=&quot;Perl code error &lt;BR&gt;&quot;]
     <B>my</B> $result = <TT>&quot;Looked up SKU $Values-&gt;{code}. It is a &quot;</TT>;
     $result .= $Tag-&gt;data(<TT>'products'</TT>, <TT>'description'</TT>, $Values-&gt;{code} );
     <B>return</B> (<TT>&quot;$result &lt;br&gt;\n&quot;</TT>);
    [/perl]
---
    Looked up SKU os28044. It is a Framing Hammer &lt;br&gt;
</PRE>
<P><B>ASP-like Perl call:</B> (e.g., to use it like a runtime eval() within your code)</P>
<PRE>
    $Tag-&gt;perl(  { tables  =&gt; <TT>&quot;products&quot;</TT>, },
                 $code  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;perl( $tables, $attribute_hash_reference );
</PRE>
<H4><A NAME="See Also">4.53.1.1. See Also</A></H4>
<P>See also <A HREF="ictemplates.html#Programming">Interchange Programming</A>, [<A HREF="#calc">calc</A>], and [<A HREF="#mvasp">mvasp</A>].</P>
<H3><A NAME="Description">4.53.2. Description</A></H3>
<P>This tag allows you to embed perl code within an Interchange page. The code will run under the restrictions of Perl's <A HREF="http://www.perl.com/pub/doc/manual/html/lib/Safe.html">Safe</A> module by default. Perl's '<TT>warnings</TT>' and '<TT>strict</TT>' pragmas are both turned off, and <A HREF="http://www.perl.com/pub/doc/manual/html/lib/Safe.html">Safe</A> will block you from turning them on, since it blocks Perl's '<TT>use</TT>' command. (This is not usually a problem, since you should probably use an alternative such as a usertag if your code is complex enough to need <TT>strict</TT>.)</P>
<P>The tag expands to the value returned by the enclosed code (i.e., printing to STDOUT or STDERR is useless).</P>
<PRE>
    [perl]
        $name    = $Values-&gt;{name};
        $browser = $Session-&gt;{browser};
        <B>return</B> <TT>&quot;Hi, $name! How do you like your $browser?</TT>
    [/perl]
</PRE>
<P>Object references are available for most Interchange tags and functions, as well as direct references to Interchange session and configuration values.</P>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD>
<STRONG>Object</STRONG>
</TD>
<TD>
<STRONG>Description</STRONG>
</TD>
</TR>
<TR>
<TD>
$CGI-&gt;{key}
</TD>
<TD>
Hash reference to raw submitted values
</TD>
</TR>
<TR>
<TD>
$CGI_array-&gt;{key}
</TD>
<TD>
Arrays of submitted values
</TD>
</TR>
<TR>
<TD>
$Carts-&gt;{cartname}
</TD>
<TD>
Direct reference to shopping carts
</TD>
</TR>
<TR>
<TD>
$Config-&gt;{key}
</TD>
<TD>
Direct reference to $Vend::Cfg
</TD>
</TR>
<TR>
<TD>
$DbSearch-&gt;array(@args)
</TD>
<TD>
Do a DB search and get results
</TD>
</TR>
<TR>
<TD>
$Document-&gt;header()
</TD>
<TD>
Writes header lines
</TD>
</TR>
<TR>
<TD>
$Document-&gt;send()
</TD>
<TD>
Writes to output
</TD>
</TR>
<TR>
<TD>
$Document-&gt;write()
</TD>
<TD>
Writes to page
</TD>
</TR>
<TR>
<TD>
$Scratch-&gt;{key}
</TD>
<TD>
Direct reference to scratch area
</TD>
</TR>
<TR>
<TD>
$Session-&gt;{key}
</TD>
<TD>
Direct reference to session area
</TD>
</TR>
<TR>
<TD>
$Tag-&gt;tagname(@args)
</TD>
<TD>
Call a tag as a routine (UserTag too!)
</TD>
</TR>
<TR>
<TD>
$TextSearch-&gt;array(@args)
</TD>
<TD>
Do a text search and get results
</TD>
</TR>
<TR>
<TD>
$Values-&gt;{key}
</TD>
<TD>
Direct reference to user form values
</TD>
</TR>
<TR>
<TD>
$Variable-&gt;{key}
</TD>
<TD>
Config variables (same as $Config-&gt;{Variable});
</TD>
</TR>
<TR>
<TD>
&amp;HTML($html)
</TD>
<TD>
Same as $Document-&gt;write($html);
</TD>
</TR>
<TR>
<TD>
&amp;Log($msg)
</TD>
<TD>
Log to the error log
</TD>
</TR>
</TABLE>

<P>For full descriptions of these objects, see <A HREF="ictemplates.html#Interchange Perl Objects">Interchange Perl Objects</A>.</P>
<H4><A NAME="perl_tables"> </A>4.53.2.1. <A NAME="perl_tables">tables</A></H4>
<P>This should be a whitespace-separated list of database tables you want to make available within the Perl code.</P>
<P>If you wish to use database values in your Perl code, the tag must pre-open the table(s) you will be using. Here is an example using the products table:</P>
<PRE>
    [perl tables=products]
        <B>my</B> $cost = $Tag-&gt;data(<TT>'products'</TT>, <TT>'our_cost'</TT>, $Values-&gt;{code});
        $min_price = $cost * ( 1 + $min_margin );
        <B>return</B> ($min_price &gt; $sale_price) ? $min_price : $sale_price;
    [/perl]
</PRE>
<P>If you do not do this, your code will fail with a runtime <A HREF="http://www.perl.com/pub/doc/manual/html/lib/Safe.html">Safe</A> error when it tries to look up 'our_cost' in the products database with the <A HREF="#data">data</A> tag.</P>
<P>Even if you properly specify the tables to pre-open, some database operations will still be restricted because <TT>Safe</TT> mode prohibits creation of new objects. For SQL, most operations can be performed if the <TT>Safe::Hole</TT> module is installed. Otherwise, you may have to set the <A HREF="#perl_global">global</A><TT>=1</TT> attribute to use data from SQL tables.</P>
<P>Interchange databases can always be accessed as long as they are pre-opened by using an item first.</P>
<P>Technical note:</P>
<P><A HREF="http://www.perl.com/pub/doc/manual/html/lib/Safe.html">Safe</A> objects (including database handles) may persist within a page, and the <TT>perl</TT> tag does not necessarily destroy objects created earlier in the page. As a result, your code may work even though you did not set '<TT>tables</TT>' properly, only to break later when you change something elsewhere on the page.</P>
<P>For example, this will work because the first call to [<A HREF="#accessories">accessories</A>&nbsp;...] opens the (default) products table:</P>
<PRE>
    [accessories code=os28044 attribute=size]

    [perl]
        return $Tag-&gt;accessories( { attribute =&gt; 'size',
                                    code      =&gt; 'os28085' } );
    [/perl]
</PRE>
<P>If you remove the first [accessories ...] tag, then the $Tag-&gt;accessories call will fail with a <A HREF="http://www.perl.com/pub/doc/manual/html/lib/Safe.html">Safe</A> error unless you also set '<TT>tables</TT>=products' in the <TT>perl</TT> tag.</P>
<P>The moral of this story is to ensure that you pass all necessary tables in the <TT>perl</TT> tag.</P>
<H4><A NAME="perl_failure"> </A>4.53.2.2. <A NAME="perl_failure">failure</A></H4>
<P>If your code contains a compile or runtime error and fails to evaluate (i.e., eval($code) would set $@), the tag will return the value set for the <TT>failure</TT> attribute. The error will be logged as usual.</P>
<P>For example,</P>
<PRE>
    [perl failure=&quot;It Broke&quot;]
        <B>my</B> $cost = $Tag-&gt;data(<TT>'products'</TT>, <TT>'our_cost'</TT>, $Values-&gt;{code});
        $min_price = $cost * ( 1 + $min_margin );
        <B>return</B> ($min_price &gt; $sale_price) ? $min_price : $sale_price;
    [/perl]
</PRE>
<P>will return 'It Broke' because the $Tag-&gt;Data(...) call will fail under the <A HREF="http://www.perl.com/pub/doc/manual/html/lib/Safe.html">Safe</A> module (see <A HREF="#perl_tables">tables</A> above).</P>
<H4><A NAME="perl_no_return"> </A>4.53.2.3. <A NAME="perl_no_return">no_return</A></H4>
<P>If <TT>no_return=1</TT>, this attribute suppresses the return value of the perl code.</P>
<P>You can retrieve the return value from the session hash via <TT>[<A HREF="#data">data</A>&nbsp;session&nbsp;mv_perl_result]</TT> until it gets overwritten by another <TT>perl</TT> tag.</P>
<P>If <TT>no_return</TT> is set, the <TT>perl</TT> tag <I>will</I> return any output explicitly written with the &amp;HTML or $Document-&gt;write() functions.</P>
<P><HR WIDTH="80%" ALIGN="Left">
<STRONG>Note: </STRONG></P>
<P>If <TT>no_return</TT> is <I>not</I> set, then the $Document-&gt;write() buffer is not returned (unless you use $Document-&gt;hot(1) or $Document-&gt;send(), in which case the contents of the write buffer will probably appear before anything else on the page). See <A HREF="ictemplates.html#Interchange Perl Objects">Interchange Perl Objects</A> for more detail.</P>
<P><HR WIDTH="80%" ALIGN="Left"></P>
<P>Here is an example:</P>
<PRE>
    [perl tables=products no_return=1]
        <B>my</B> $cost = $Tag-&gt;data(<TT>'products'</TT>, <TT>'our_cost'</TT>, $Values-&gt;{code});
        $min_price = $cost * ( 1 + $min_margin );
        &amp;HTML( ($min_price &gt; $sale_price) ? $min_price : $sale_price );
        <B>return</B> ($min_price &gt; $sale_price) ? <TT>'too low'</TT> : <TT>'ok'</TT>;
    [/perl]
</PRE>
<P>This will put the same price on the page as our earlier example, but</P>
<P><TT>$Session-&gt;{mv_perl_result}</TT> will be either 'too low' or 'ok'.</P>
<P>The [<A HREF="#mvasp">mvasp</A>] tag is very similar to [perl&nbsp;no_return=1].</P>
<H4><A NAME="perl_subs"> </A>4.53.2.4. <A NAME="perl_subs">subs</A></H4>
<P>If you have set the <A HREF="icconfig.html#AllowGlobal *global*">AllowGlobal</A> catalog directive, setting <TT>subs=1</TT> will enable you to call <A HREF="icconfig.html#GlobalSub *global*">GlobalSub</A> routines within the enclosed perl code. Note that this can compromise security.</P>
<H4><A NAME="perl_global"> </A>4.53.2.5. <A NAME="perl_global">global</A></H4>
<P>If you have set the <A HREF="icconfig.html#AllowGlobal *global*">AllowGlobal</A> catalog directive, setting <TT>global=1</TT> will turn off <A HREF="http://www.perl.com/pub/doc/manual/html/lib/Safe.html">Safe</A> protection within the tag.</P>
<P>The code within the tag will then be able to do anything the user ID running Interchange can. This seriously compromises security, and you should know what you are doing before using it in a public site. It is especially dangerous if a single Interchange server is shared by multiple companies or user IDs.</P>
<P>Also, full '<TT>use strict</TT>' checking is turned on by default when in global mode. You can turn it off by using '<TT>no strict;</TT>' within your code. Note that any <TT>strict</TT> errors will go to the Interchange error logs, and the tag itself will fail silently within the page.</P>
<H4><A NAME="perl_file"> </A>4.53.2.6. <A NAME="perl_file">file</A></H4>
<P>This prepends the contents of the specified file or <TT>FileDatabase</TT> entry to the enclosed perl code (if any), then executes as usual.</P>
<P>For example,</P>
<PRE>
    [perl file=&quot;my_script.pl&quot;][/perl]
</PRE>
<P>would execute myscript.pl and expand to its return value.</P>
<P>Absolute filenames (or filenames containing '../') are prohibited by the <A HREF="icconfig.html#NoAbsolute *global*">NoAbsolute</A> catalog directive.</P>
<P>If the filename is not absolute, Interchange first looks for a file in the current directory, then in the list set with the <A HREF="icconfig.html#TemplateDir *global*">TemplateDir</A> catalog directive. If it fails to find a file by that name, it then looks for an entry by that name in the database specified with the <TT>FileDatabase</TT> catalog directive.</P>
<H4><A NAME="perl_number_errors"> </A>4.53.2.7. <A NAME="perl_number_errors">file</A></H4>
<P>Add line numbers to the source code displayed in the error.log, amazingly useful if some of the perl is being generated elsewhere and interpolated.</P>
<H4><A NAME="perl_eval_label"> </A>4.53.2.8. <A NAME="perl_eval_label">eval_label</A></H4>
<P>Set to a string, will replace the (eval ###) in the error message with this label, handy to quickly track down bugs when you have more than one perl block in the page, especially if you are using <A HREF="#perl_short_errors">short_errors</A>.</P>
<H4><A NAME="perl_short_errors"> </A>4.53.2.9. <A NAME="perl_short_errors">short_errors</A></H4>
<P>If set to a true value, syntax errors and the like in perl tags will log just the error, not the whole source code of the block in question, handy when you have the code open in an editor anyway and don't want the error itself to get scrolled away when running 'tail -f error.log'.</P>
<H4><A NAME="perl_trim_errors"> </A>4.53.2.10. <A NAME="perl_trim_errors">trim_errors</A></H4>
<P>If set to a number, and the error produced includes a line number, then only that number of lines before and after the broken line itself will be displayed, instead of the whole block.</P>
<H2><A NAME="price">4.54. price</A></H2>
<H3><A NAME="Summary">4.54.1. Summary</A></H3>
<P>Parameters: <B>code</B></P>
<P>Positional parameters in same order.</P>
<P><B>The attribute hash reference is passed</B> to the subroutine after the parameters as the last argument. <B>This may mean that there are parameters not shown here.</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>Invalidates cache: <B>no</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;price(
        {
         code =&gt; VALUE,
        }
    )

 OR

    $Tag-&gt;price($code, $ATTRHASH);
</PRE>
<P>Attribute aliases</P>
<PRE>
            base ==&gt; mv_ib
    [<B>price</B> code <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#price_base">base</A>
</TD>
<TD VALIGN='Top'>
Alias for mv_ib
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#price_code">code</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>no</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [price code]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;price(  { code =&gt; VALUE_code
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;price(code, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.54.2. Description</A></H3>
<P>Arguments:</P>
<PRE>
        code       Product code/SKU
        base       Only search in product table *base*
        quantity   Price for a quantity
        discount   If true(1), check discount coupons and apply
        noformat   If true(1), don't apply currency formatting
</PRE>
<P>Expands into the price of the product identified by code as found in the products database. If there is more than one products file defined, they will be searched in order unless constrained by the optional argument <B>base</B>. The optional argument <B>quantity</B> selects an entry from the quantity price list. To receive a raw number, with no currency formatting, use the option <TT>noformat=1</TT>.</P>
<P>Interchange maintains a price in its database for every product. The price field is the one required field in the product database&nbsp;-- it is necessary to build the price routines.</P>
<P>For speed, Interchange builds the code that is used to determine a product's price at catalog configuration time. If you choose to change a directive that affects product pricing you must reconfigure the catalog.</P>
<P>Quantity price breaks are configured by means of the <I>CommonAdjust</I> directive. There are a number of CommonAdjust recipes which can be used; the standard example in the demo calls for a separate pricing table called <TT>pricing</TT>. Observe the following:</P>
<PRE>
   CommonAdjust  pricing:q2,q5,q10,q25, ;products:price, ==size:pricing
</PRE>
<P>This says to check quantity and find the applicable column in the pricing database and apply it. In this case, it would be:</P>
<PRE>
    2-4      Column *q2*
    5-9      Column *q5*
    10-24    Column *q10*
    25 up    Column *q25*
</PRE>
<P>What happens if quantity is one? It &quot;falls back&quot; to the price that is in the table <TT>products</TT>, column <TT>price</TT>.</P>
<P>After that, if there is a size attribute for the product, the column in the pricing database corresponding to that column is checked for additions or subtractions (or even percentage changes).</P>
<P>If you use this tag in the demo:</P>
<PRE>
    [price code=99-102 quantity=10 size=XL]
</PRE>
<P>the price will be according to the <TT>q10</TT> column, adjusted by what is in the XL column. (The row is of course 99-102.) The following entry in pricing:</P>
<PRE>
  code    q2   q5   q10  q25  XL
  99-102  10   9    8    7    .50
</PRE>
<P>Would yield 8.50 for the price. Quantity of 10 in the <TT>q10</TT> column, with 50 cents added for extra large (XL).</P>
<P>Following are several examples based on the above entry as well as this the entry in the <TT>products</TT> table:</P>
<PRE>
  code    description   price    size
  99-102  T-Shirt       10.00    S=Small, M=Medium, L=Large*, XL=Extra Large
</PRE>
<P>NOTE: The examples below assume a US locale with 2 decimal places, use of commas to separate, and a dollar sign ($) as the currency formatting.</P>
<PRE>
  TAG                                          DISPLAYS
  ----------------------------------------     --------
  [price 99-102]                               $10.00
  [price code=&quot;99-102&quot;]                        $10.00
  [price code=&quot;99-102&quot; quantity=1]             $10.00
  [price code=&quot;99-102&quot; noformat=1]             10
  [price code=&quot;99-102&quot; quantity=5]             $9.00
  [price code=&quot;99-102&quot; quantity=5 size=XL]     $9.50
  [price code=&quot;99-102&quot; size=XL]                $10.50
  [price code=&quot;99-102&quot; size=XL noformat=1]     10.5
</PRE>
<P>Product discounts for specific products, all products, or the entire order can be configured with the [discount ...] tag. Discounts are applied on a per-user basis&nbsp;-- you can gate the discount based on membership in a club or other arbitrary means.</P>
<P>Adding [discount 99-102] $s * .9[/discount] deducts 10% from the price at checkout, but the price tag will not show that unless you add the discount=1 parameter.</P>
<PRE>
    [price code=&quot;99-102&quot;]            --&gt;   $10.00
    [price code=&quot;99-102&quot; discount=1] --&gt;   $9.00
</PRE>
<P>See <I>Product Discounts</I>.</P>
<H4><A NAME="price_base"> </A>4.54.2.1. <A NAME="price_base">base</A></H4>
<H4><A NAME="price_code"> </A>4.54.2.2. <A NAME="price_code">code</A></H4>
<H2><A NAME="process">4.55. process</A></H2>
<P>This is a shortcut for the 'process' action, expanding to your catalog URL and session ID. It is analogous to the <A HREF="#area">area</A> tag for the 'process' page, but is more limited. The following expansion is illustrative:</P>
<PRE>
    [process target=targetframe]
---
    http://www.here.com/cgi-bin/mycatalog/process.html?\
    id=6CZ2whqo&quot; TARGET=&quot;targetframe
</PRE>
<P>(the trailing backslash indicates continuation, i.e., the result should be only one line)</P>
<P>Note the mismatched quotes in the expansion.  Your surrounding HTML should supply the containing quotes, like this:</P>
<PRE>
   &lt;A HREF=&quot;[process target=targetframe]&quot;&gt;...
</PRE>
<P>Aliases:  <B>process_target</B>, <B>process_order</B></P>
<H3><A NAME="Summary">4.55.1. Summary</A></H3>
<PRE>
    [<B>process</B> target secure]
    [<B>process</B> target=<I>targetframe</I> secure=1 <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
target
</TD>
<TD VALIGN='Top'>
The target frame or window
</TD>
<TD VALIGN='Top'>
<I>None</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
secure
</TD>
<TD VALIGN='Top'>
Boolean.  If true (secure=1), the URL will link to your secure server.
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [process targetframe 1]
---
    http://secure.here.com/cgi-bin/mycatalog/process.html?\
    id=6CZ2whqo&quot; TARGET=&quot;targetframe
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;process(  { target =&gt; <TT>'frametarget'</TT>,
                      secure =&gt; 1, } );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;process($target, $secure, $attribute_hash_reference);
</PRE>
<H2><A NAME="process-search">4.56. process-search</A></H2>
<P>This is an exact alias for [<A HREF="#area">area</A>&lt;C search&gt;].</P>
<H2><A NAME="query">4.57. query</A></H2>
<P>Passes SQL statements through to SQL databases, or allows SQL queries via Interchange's database abstraction into non-SQL databases and text files. The latter requires the Perl <A HREF="http://search.cpan.org/doc/JWIED/SQL-Statement-0.1017/lib/SQL/Statement.pm">SQL Statement</A> module (included with Bundle::Interchange from CPAN).</P>
<H3><A NAME="Summary">4.57.1. Summary</A></H3>
<PRE>
    [<B>query</B> sql]
    [<B>query</B> sql=&quot;SQL_query_text&quot; <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#query_sql">sql</A>
</TD>
<TD VALIGN='Top'>
The SQL statement.
<UL>
<LI>Passed directly through to an SQL database.
<LI>For a non-SQL table, the tag interprets your SQL first. See the <A HREF="http://search.cpan.org/doc/JWIED/SQL-Statement-0.1017/lib/SQL/Statement.pm">SQL Statement</A> module for limitations and detail.</UL>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#query_sql">query</A>
</TD>
<TD VALIGN='Top'>
Alias for <TT>sql</TT>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#query_table">table</A>
</TD>
<TD VALIGN='Top'>
products
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#query_table">base</A> (alias for <TT>table</TT>)
</TD>
<TD VALIGN='Top'>
products
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#query_type">type</A> (row_count, html, list, textref)
</TD>
<TD VALIGN='Top'>
<I>none: uses arrayref=&quot;&quot; if no type</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#query_arrayref">arrayref</A>
</TD>
<TD VALIGN='Top'>
<I>arrayref=&quot;&quot; if no</I> <TT>type</TT> <I>given</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#query_arrayref">hashref</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#query_more">more</A> (type=list)
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#query_form_variables">xx</A> form var. abbrev. (type=list)
</TD>
<TD VALIGN='Top'>
<I>see form variable</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#query_prefix">&nbsp;</A> (type=list)
</TD>
<TD VALIGN='Top'>
sql
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#query_list_prefix">list_prefix</A> (type=list)
</TD>
<TD VALIGN='Top'>
list
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#query_random">random</A> (type=list)
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#query_safe_data">safe_data</A> (type=list)
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#query_label">label</A> (type=list)
</TD>
<TD VALIGN='Top'>
current
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#query_form">form</A> (type=list)
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#query_wantarray">wantarray</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_reparse">reparse</A>
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has <A HREF="#query_subtags">subtags</A>
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag usage example:</B></P>
<P>This will list sku, description and price for ten products per page, followed by hyperlinks to the other pages of the list. Note that you may interpolate Interchange tags in the usual way if you double-quote the SQL statement.</P>
<PRE>
    [query sql=&quot;select sku, description, price from products where price &lt; [value mv_arg]&quot;
         type=list
         more=1
           ml=10]

      [on_match]Matched&lt;br&gt;[/on_match]
      [no_match]Not Found&lt;br&gt;[/no_match]

      [list]
        [sql-code] [sql-param description] [sql-price]
      [/list]

      [more_list]
        [more]
      [/more_list]
    [/query]
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   <B>my</B> $sql = <TT>&quot;select * from products order by price&quot;</TT>;
   <B>my</B> $result_array = $Tag-&gt;query( { sql =&gt; $sql,  },
                                   $body );
   <B>my</B> ($same_results, $col_name_hash, $col_name_array) =
                      $Tag-&gt;query( { sql =&gt; $sql,  },
                                   $body );

   <B>my</B> $result_hasharray = $Tag-&gt;query( { sql     =&gt; $sql,
                                         hashref =&gt; <TT>'my_results'</TT>,  },
                                       $body );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;query( $sql, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.57.2. Description</A></H3>
<P>The <TT>query</TT> tag allows you to make SQL queries. If you are using an SQL database table, the tag will pass your SQL statement directly to the database and return the result.</P>
<P>If your table is not in an SQL database (for example, GDBM, text, LDAP, and in-memory tables), Interchange will internally convert it to an Interchange search specification with the Perl <A HREF="http://search.cpan.org/doc/JWIED/SQL-Statement-0.1017/lib/SQL/Statement.pm">SQL Statement</A> module (included with Bundle::Interchange from CPAN). This means that you can use simple SQL queries regardless of the underlying database implementation.</P>
<H4><A NAME="query_subtags"> </A>4.57.2.1. <A NAME="query_subtags">Subtags</A></H4>
<P>For list queries (<A HREF="#query_type">type</A>=list), the following subtags are available:</P>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Subtag</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Usage</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
on_match
</TD>
<TD VALIGN='Top'>
<PRE>
 [on_match]
   <I>do this if something matched</I>
 [/on_match]
</PRE>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
no_match
</TD>
<TD VALIGN='Top'>
<PRE>
 [no_match]
   <I>do this if nothing matched</I>
 [/no_match]
</PRE>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
list
</TD>
<TD VALIGN='Top'>
<PRE>
 [<A HREF="#query_list_prefix">list_prefix</A>]
   <I>do this for each matched item</I>
 [/<I>list_prefix</I>]
</PRE>
<P>The '<TT>list</TT>' subtag defines a region where you can use any of the looping subtags that work in array-list context (see <A HREF="#Looping tags and Sub-tags">Looping tags and Sub-tags</A>).</P>
<P>The default looping tag prefix will be 'sql'. Note however that you can override this by setting the <A HREF="#query_prefix">prefix</A> attribute in the enclosing <TT>query</TT> tag.</P>
<P>Similarly, the <TT>list_prefix</TT> attribute renames the [list] subtag itself to the value you set (see <A HREF="#query_list_prefix">list_prefix</A> below).</P>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
more_list
</TD>
<TD VALIGN='Top'>
<PRE>
 [more_list]
   [more]
 [/more_list]
</PRE>
<P>The '<TT>more_list</TT>' and '<TT>more</TT>' subtags are used when paginating the query results (see '<A HREF="#query_more">more</A>' attribute). The [<TT>more</TT>] subtag will expand to a list of links to the other pages of the query results.</P>
</TD>
</TR>
</TABLE>

<P>See also the example at the end of the Summary section above.</P>
<H4><A NAME="Perl and ASP usage">4.57.2.2. Perl and ASP usage</A></H4>
<P>If you are calling $Tag-&gt;query within a <TT>perl</TT> tag (or whenever the code is secured by the <A HREF="http://www.perl.com/pub/doc/manual/html/lib/Safe.html">Safe.pm</A> module), you must be sure to set the <A HREF="#perl_tables">tables</A> attribute properly in the enclosing <TT>perl</TT> tag (see the <A HREF="#perl">perl</A> tag documentation for detail).</P>
<P>The <A HREF="#query_type">types</A> that return text to a page (i.e., row_count, html, and textref) work as usual, returning an appropriate string. Note that you may also have access to the results as an array reference in $Vend::Interpolate::Tmp-&gt;{''} for the life of the page.</P>
<P>If you do not set a <A HREF="#query_type">type</A>, the tag will return a reference to an array of array references, since the default with no <A HREF="#query_type">type</A> is <TT>arrayref=&quot;&quot;</TT>.</P>
<P>If you call $Tag-&gt;query in scalar context and set <A HREF="#query_arrayref">arrayref</A> or <A HREF="#query_arrayref">hashref</A>, it will return your results as a reference to an array of either arrayrefs or hashrefs, respectively (i.e., the same data structures you would get from Perl's DBI.pm module with fetchall_arrayref).</P>
<P>In list context, the first returned element is the aforementioned reference to your results. The second element is a hash reference to your column names, and the third element is an an array reference to the list of column names.</P>
<P>The following examples should be illustrative:</P>
<PRE>
  [perl tables=products]
    <B>my</B> $sql = <TT>&quot;select sku, price, description from products</TT>
               <TT>where price &lt; 10 order by price&quot;</TT>;

    <B>my</B> $results = $Tag-&gt;query( { sql =&gt; $sql, } );
    <B>my</B> ( $same_results, $col_name_hashref, $col_name_arrayref)
        = $Tag-&gt;query( { sql =&gt; $sql, } );

    <B>my</B> $hash_results = $Tag-&gt;query( {     sql =&gt; $sql,
                                      hashref =&gt; <TT>'my_results'</TT> } );

    <I># $Vend::Interpolate::Tmp-&gt;{my_results} == $hash_results</I>
    <I># $Vend::Interpolate::Tmp-&gt;{''} == $results == $same_results</I>

    <B>return</B> $Tag-&gt;uneval( $results );
  [/perl]
</PRE>
<P><HR WIDTH="80%" ALIGN="Left">
<STRONG>Technical Note: </STRONG>The $Tag-&gt;query() call works a bit differently in GlobalSubs and UserTags than within a <A HREF="#perl">perl</A> tag.  Specifically, in a GlobalSub or global UserTag, if you call query() in list context and want the three references (i.e., results, column hash and column array), then you need to set the '<A HREF="#query_wantarray">wantarray</A>=1' attribute in the query() call.  See the <A HREF="#query_wantarray">wantarray</A> attribute.</P>
<P><HR WIDTH="80%" ALIGN="Left"></P>
<H4><A NAME="query_sql"> </A>4.57.2.3. <A NAME="query_sql">sql</A></H4>
<P>This is the text of your SQL statement. The standard Interchange quoting rules apply. For example, use double quotes (&quot;) if you want to interpolate Interchange tags within your SQL statement, backticks (`) to calculate a value, <I>etc.</I></P>
<PRE>
    [query sql=&quot;select description, price from products
               where price &lt; [value mv_arg]&quot; ...]
        ...
    [/query]
</PRE>
<H4><A NAME="query_table"> </A>4.57.2.4. <A NAME="query_table">table</A></H4>
<P>The table attribute sets the database to use for the query. The default will typically be the database containing the '<TT>products</TT>' table (unless you have changed the first entry in $Vend::Cfg-&gt;{ProductFiles}).</P>
<H4><A NAME="query_type"> </A>4.57.2.5. <A NAME="query_type">type</A></H4>
<P>If you are not setting the '<A HREF="#query_arrayref">arrayref</A>' or '<A HREF="#query_arrayref">hashref</A>' attributes, then the type attribute defines the way the query will return its results. The <TT>type</TT> should be one of the following:</P>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Type</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Returns</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
html
</TD>
<TD VALIGN='Top'>
The html type returns the results in an html table. You will need to supply the enclosing &lt;TABLE ...&gt; and &lt;/TABLE&gt; html tags. The following is an example of typical usage:
<PRE>
 &lt;TABLE&gt;
   [query sql=&quot;select * from products
               where price &gt; 12
               order by price&quot;
         type=html]
   [/query]
 &lt;/TABLE&gt;
</PRE>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
list
</TD>
<TD VALIGN='Top'>
This allows you to use subtags to control the query output and pagination. See the <A HREF="#query_subtags">Subtags</A> section above for detail.
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
row_count
</TD>
<TD VALIGN='Top'>
This causes the tag to return the number of rows in the query result.
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
textref
</TD>
<TD VALIGN='Top'>
This causes the tag to return a the query results as a serialized array of arrays that Perl can evaluate with its <B>eval()</B> function. Here is an illustrative example:
<PRE>
  my $rows = eval( $Tag-&gt;query( { sql  =&gt; &quot;select * from products&quot;
                                  type =&gt; &quot;textref&quot; } )
                 );
&nbsp;
  my $r3_c0 = $rows-&gt;[3]-&gt;[0];
</PRE>
</TD>
</TR>
</TABLE>

<P>If you do not specify a type, the tag will create an arrayref as if you had set 'arrayref=&quot;&quot;'.</P>
<H4><A NAME="query_arrayref"> </A>4.57.2.6. <A NAME="query_arrayref">arrayref and hashref</A></H4>
<P>If you set '<TT>arrayref</TT>=<I>keyname</I>' or '<TT>hashref</TT>=<I>keyname</I>', the query will not return results to the page. Instead, it will place the results of your query in the $Vend::Interpolate::Tmp hash. Using '<TT>arrayref</TT>=my_query' sets $Vend::Interpolate::Tmp-&gt;{my_query} to refer to an array of array references, while '<TT>hashref</TT>=my_query' creates an array of hash references.</P>
<P>Note that this is useful only if you intend to access the results within Perl code (for example, within a [<A HREF="#perl">perl</A>] tag), since there is no direct output to the returned page.</P>
<P>The $Vend::Interpolate::Tmp hash persists only for the life of the template page being processed. If you need the query results array reference to outlive the page, you will have to save the reference somewhere more persistent such as the $Session hash:</P>
<PRE>
   $Session-&gt;{my_query} = $Vend::Interpolate::Tmp-&gt;{my_query};
</PRE>
<P>Beware the impact on performance if you do this with large result sets.</P>
<P>Technical note&nbsp;-- the string returned by the '<TT>textref</TT>' <A HREF="#query_type">type</A> will <B>eval</B>() to the '<TT>arrayref</TT>' data structure.</P>
<H4><A NAME="query_more"> </A>4.57.2.7. <A NAME="query_more">more</A></H4>
<P>Requires '<A HREF="#query_type">type</A>=list'.</P>
<P>You must set <TT>more</TT>=1 to properly paginate your results from <TT>list</TT> queries (see '<A HREF="#query_type">type</A>=list' above. If you do not set <TT>more</TT>=1, then the links to later pages will merely redisplay the first page of your results.</P>
<H4><A NAME="query_form_variables"> </A>4.57.2.8. <A NAME="query_form_variables">form variable abbreviations</A></H4>
<P>Requires '<A HREF="#query_type">type</A>=list'.</P>
<P>See the <A HREF="#Search and Form Variables">Search and Form Variables</A> appendix for a list of form variables. Note that you must use the two-letter abbreviation rather than the full form variable name.</P>
<P>A few deserve special mention:</P>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Abbr</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Name</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
ml
</TD>
<TD VALIGN='Top'>
mv_matchlimit
</TD>
<TD VALIGN='Top'>
Sets number of rows to return. If paginating (<A HREF="#query_more">more</A>=1), sets rows returned per page.
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
fm
</TD>
<TD VALIGN='Top'>
mv_first_match
</TD>
<TD VALIGN='Top'>
Start displaying search at specified match
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
sp
</TD>
<TD VALIGN='Top'>
mv_search_page
</TD>
<TD VALIGN='Top'>
Sets the page for search display
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
st
</TD>
<TD VALIGN='Top'>
mv_searchtype
</TD>
<TD VALIGN='Top'>
Forces a specific search type (text, glimpse, db or sql), overriding the default determined from your database implementation.
</TD>
</TR>
</TABLE>

<H4><A NAME="query_prefix"> </A>4.57.2.9. <A NAME="query_prefix"></A></H4>
<P>Requires '<A HREF="#query_type">type</A>=list'.</P>
<P>Setting '<TT>prefix</TT>=foo' overrides the default prefix of 'sql' for loop subtags within a list region (see <A HREF="#Looping tags and Sub-tags">Looping tags and Sub-tags</A>).</P>
<P>See the <A HREF="#query_list_prefix">list_prefix</A> attribute below for an illustrative example.</P>
<H4><A NAME="query_list_prefix"> </A>4.57.2.10. <A NAME="query_list_prefix">list_prefix</A></H4>
<P>Requires '<A HREF="#query_type">type</A>=list'.</P>
<P>Setting '<TT>list_prefix</TT>=bar' overrides the default region tagname of 'list'. The best way to show this is by example. Compare the following two examples of list queries, the first using the defaults and the second with explicitly set <TT>prefix</TT> and <TT>list_prefix</TT>.</P>
<PRE>
    [query sql=&quot;select sku, description, price from products
               where price &lt; 20&quot;
         type=list
         more=1
           ml=10]

      [on_match]Matched&lt;br&gt;[/on_match]
      [no_match]Not Found&lt;br&gt;[/no_match]

      [list]
        [sql-code] [sql-param description] [sql-price]
      [/list]

      [more_list]
        [more]
      [/more_list]
    [/query]
---
    [query  sql=&quot;select sku, description, price from products
                where price &lt; 20&quot;
           type=list
         <B>prefix=foo</B>
    <B>list_prefix=bar</B>
           more=1
             ml=10]

      [on_match]Matched&lt;br&gt;[/on_match]
      [no_match]Not Found&lt;br&gt;[/no_match]

      [bar]
        [foo-code] [foo-param description] [foo-price]
      [/bar]

      [more_list]
        [more]
      [/more_list]
    [/query]
</PRE>
<H4><A NAME="query_random"> </A>4.57.2.11. <A NAME="query_random">random</A></H4>
<P>Requires '<A HREF="#query_type">type</A>=list'.</P>
<P>You can use the '<TT>random</TT>' attribute to randomly select a set of rows from the whole result set of your query. In other words, setting '<TT>random</TT>=<I>n</I>', where <I>n</I> &gt; 0, causes the [<TT>list</TT>] region to loop over <I>n</I> randomly chosen rows rather than the full query result set.</P>
<P>The example below would display three randomly chosen products priced under 20.</P>
<PRE>
    [query sql=&quot;select * from products
               where price &lt; 20&quot;
         type=list
       random=3]

      [list]
        [sql-code] [sql-param description] [sql-price]
      [/list]

    [/query]
</PRE>
<H4><A NAME="query_safe_data"> </A>4.57.2.12. <A NAME="query_safe_data">safe_data</A></H4>
<P>Requires '<A HREF="#query_type">type</A>=list'.</P>
<P>Note&nbsp;-- you should not set this unless you need it and know what you are doing.</P>
<P>Setting '<TT>safe_data</TT>=1' allows the [sql-data] tag to return values containing the '[' character. See also <A HREF="#Looping tags and Sub-tags">Looping tags and Sub-tags</A>.</P>
<P>Beware of reparsing issues.</P>
<H4><A NAME="query_label"> </A>4.57.2.13. <A NAME="query_label">label</A></H4>
<P>Requires '<A HREF="#query_type">type</A>=list'.</P>
<P>If you are setting up multiple simultaneously active search objects within a page, this allows you to distinguish them. The default label is 'current'. Most people will not need this.</P>
<H4><A NAME="query_form"> </A>4.57.2.14. <A NAME="query_form">form</A></H4>
<P>Requires '<A HREF="#query_type">type</A>=list'.</P>
<P>You can use this to pass one CGI form variable in the pagination links of a [more-list]. For example, '<TT>form</TT>=&quot;foo=bar&quot;' to include '&amp;foo=bar' in the URL of each of the pagination links.</P>
<P>Note that the variable will not be available in the initial result set since the query returns the first page directly (i.e., you did not follow a pagination link).</P>
<H4><A NAME="query_wantarray"> </A>4.57.2.15. <A NAME="query_wantarray">wantarray</A></H4>
<P>This is relevant only when calling $Tag-&gt;query( ... ) within global Perl code such as a globalsub or global usertag where $MVSAFE::Safe is not defined. In these cases, setting '<TT>wantarray</TT>=1' allows the call to</P>
<PRE>
  $Tag-&gt;query( { wantarray =&gt; 1, ... }, ... );
</PRE>
<P>to return references as it would if called within an ordinary [<A HREF="#perl">perl</A>] tag. Note that it does not force list context if you call $Tag-&gt;query in scalar context.</P>
<P>Technical note&nbsp;-- the ordinary [<TT>query</TT>&nbsp;...]&nbsp;...&nbsp;[<TT>/query</TT>] usage forces scalar context on the query call and suppresses the return value for those <A HREF="#query_type">types</A> that would return references if $Tag-&gt;query were called within a [<A HREF="#perl">perl</A>] tag. The wantarray option is needed because global subs and usertags are also affected by this unless you set wantarray.</P>
<H2><A NAME="read-cookie">4.58. read-cookie</A></H2>
<P>Returns the value of the named cookie. Returns nothing if the cookie does not exist.</P>
<H3><A NAME="Summary">4.58.1. Summary</A></H3>
<PRE>
    [read-cookie name]
    [read-cookie name=mycookie]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#read_cookie_name">name</A>
</TD>
<TD VALIGN='Top'>
The name of the cookie whose value you want
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Usage example:</B></P>
<PRE>
    [read-cookie name=MV_SESSION_ID]
---
    6CZ2whqo
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;read_cookie(  { name =&gt; $name, }  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;read_cookie( $name );
</PRE>
<H3><A NAME="Description">4.58.2. Description</A></H3>
<P>This tag expands to the value of the named cookie (or nothing if the cookie does not exist).</P>
<P>See the Netscape specification at <A HREF="http://www.netscape.com/newsref/std/cookie_spec.html">http://www.netscape.com/newsref/std/cookie_spec.html</A> if you need more cookie-specific detail.</P>
<H4><A NAME="read_cookie_name"> </A>4.58.2.1. <A NAME="read_cookie_name">name</A></H4>
<P>This is the name of the cookie whose value you want to retrieve.</P>
<H4><A NAME="read_cookie_HTTP_COOKIE"> </A>4.58.2.2. <A NAME="read_cookie_HTTP_COOKIE">Parsing an HTTP_COOKIE string</A></H4>
<P>If you pass this tag a second parameter within a Perl call, it will use your value as the HTTP_COOKIE string (ignoring the real one). This only applies if you pass the values positionally within a perl call since there is no name for the HTTP_COOKIE string input:</P>
<PRE>
  $Tag-&gt;read_cookie(<TT>'MV_SESSION_ID'</TT>, <TT>&quot;MV_SESSION_ID=UnHyaDQj:127.0.0.1; ...&quot;</TT>);
</PRE>
<H2><A NAME="restrict">4.59. restrict</A></H2>
<P>Restrict tag execution in a region. If a restricted tag is encountered, it is simply output.</P>
<H3><A NAME="Summary">4.59.1. Summary</A></H3>
<PRE>
    [<B>restrict</B> tag1 tag2]
    [<B>restrict</B> policy=deny enable=&quot;page area value&quot;]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#restrict_policy">policy</A>
</TD>
<TD VALIGN='Top'>
Whether to allow or deny by default.
</TD>
<TD VALIGN='Top'>
<B>deny</B>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#restrict_enable">enable</A>
</TD>
<TD VALIGN='Top'>
Tags to enable when default policy is deny.
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#restrict_disable">disable</A>
</TD>
<TD VALIGN='Top'>
Tags to disable. Overrides enable.
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Usage example:</B></P>
<PRE>
    [read-cookie name=MV_SESSION_ID]
---
    6CZ2whqo
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    N/A. Cannot be called effectively.
</PRE>
<H3><A NAME="Description">4.59.2. Description</A></H3>
<P>Restrict tag execution in a region. If a restricted tag is encountered, it is simply output. It can be used to allow certain tags in a user-editable region, while denying dangerous tags. Or it can be used to restrict all tag execution in a region.</P>
<H4><A NAME="restrict_policy"> </A>4.59.2.1. <A NAME="restrict_policy">policy</A></H4>
<P>Default is <TT>deny</TT>, which makes most sense. You then specifically enable certain ITL tags. If you set <TT>allow</TT> by default, you must be very careful that you really are disabling all of what you consider to be dangerous tags.</P>
<H4><A NAME="restrict_enable"> </A>4.59.2.2. <A NAME="restrict_enable">enable</A></H4>
<P>A space-separated or comma-separated list of tags to disable when the default policy is <TT>deny</TT>. Has no effect when the default policy is <TT>allow</TT>, and any tags passed in the disable parameter override the enable.</P>
<H4><A NAME="restrict_disable"> </A>4.59.2.3. <A NAME="restrict_disable">disable</A></H4>
<P>A space-separated or comma-separated list of tags to disable when the default policy is <TT>allow</TT>. If you have a list of tags that are enabled, perhaps stored in a scratch variable, you can disable some of those tags since this takes precedence over the enable.</P>
<H2><A NAME="row">4.60. row</A></H2>
<H3><A NAME="Summary">4.60.1. Summary</A></H3>
<P>Parameters: <B>width</B></P>
<P>Positional parameters in same order.</P>
<P>Pass attribute hash as last to subroutine: <B>no</B></P>
<P>Interpolates <B>container text</B> by default.</P>
<P>This is a container tag, i.e. [row] FOO [/row]. Nesting: NO</P>
<P>Invalidates cache: <B>no</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;row(
        {
         width =&gt; VALUE,
        },
        BODY
    )

 OR

    $Tag-&gt;row($width, $BODY);
    [<B>row</B> width]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#row_width">width</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_reparse">reparse</A>
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>no</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [row width]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;row(  { width =&gt; VALUE_width
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;row(width, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.60.2. Description</A></H3>
<P>Formats text in tables. Intended for use in emailed reports or &lt;PRE&gt;&lt;/PRE&gt; HTML areas. The parameter <I>nn</I> gives the number of columns to use. Inside the row tag, [col param=value ...] tags may be used.</P>
<H4><A NAME="E&lt;lbracket&gt;col width=nn wrap=yes|no gutter=n align=left|right|input spacing=n]">4.60.2.1. [col width=nn wrap=yes|no gutter=n align=left|right|input spacing=n]</A></H4>
<P>Sets up a column for use in a [row]. This parameter can only be contained inside a [row nn] [/row] tag pair. Any number of columns (that fit within the size of the row) can be defined.</P>
<P>The parameters are:</P>
<PRE>
    width=nn        The column width, I&lt;including the gutter&gt;. Must be
                    supplied, there is no default. A shorthand method
                    is to just supply the number as the I&lt;first&gt; parameter,
                    as in [col 20].

    gutter=n        The number of spaces used to separate the column (on
                    the right-hand side) from the next. Default is 2.

    spacing=n       The line spacing used for wrapped text. Default is 1,
                    or single-spaced.

    wrap=(yes|no)   Determines whether text that is greater in length than
                    the column width will be wrapped to the next line. Default
                    is I&lt;yes&gt;.

    align=(L|R|I)   Determines whether text is aligned to the left (the default),
                    the right, or in a way that might display an HTML text
                    input field correctly.
</PRE>
<H4><A NAME="E&lt;lbracket&gt;/col]">4.60.2.2. [/col]</A></H4>
<P>Terminates the column field.</P>
<H4><A NAME="row_width"> </A>4.60.2.3. <A NAME="row_width">width</A></H4>
<H2><A NAME="salestax">4.61. salestax</A></H2>
<H3><A NAME="Summary">4.61.1. Summary</A></H3>
<P>Parameters: <B>name noformat</B></P>
<P>Positional parameters in same order.</P>
<P>Pass attribute hash as last to subroutine: <B>no</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>Invalidates cache: <B>YES</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;salestax(
        {
         name =&gt; VALUE,
         noformat =&gt; VALUE,
        }
    )

 OR

    $Tag-&gt;salestax($name, $noformat);
</PRE>
<P>Attribute aliases</P>
<PRE>
            cart ==&gt; name
    [<B>salestax</B> name noformat]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#salestax_name">cart</A>
</TD>
<TD VALIGN='Top'>
Alias for name
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#salestax_name">name</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#salestax_noformat">noformat</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>YES</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [salestax name noformat]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;salestax(  { name =&gt; VALUE_name
                       noformat =&gt; VALUE_noformat
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;salestax(name,noformat, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.61.2. Description</A></H3>
<P>Expands into the sales tax on the subtotal of all the items ordered so far for the cart, default cart is <TT>main</TT>. If there is no key field to derive the proper percentage, such as state or zip code, it is set to 0. If the noformat tag is present and non-zero, the raw number with no currency formatting will be given.</P>
<H4><A NAME="salestax_name"> </A>4.61.2.1. <A NAME="salestax_name">name</A></H4>
<H4><A NAME="salestax_noformat"> </A>4.61.2.2. <A NAME="salestax_noformat">noformat</A></H4>
<H2><A NAME="scratch">4.62. scratch</A></H2>
<H3><A NAME="Summary">4.62.1. Summary</A></H3>
<P>Parameters: <B>name</B></P>
<P>Positional parameters in same order.</P>
<P>Pass attribute hash as last to subroutine: <B>no</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>Invalidates cache: <B>YES</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;scratch(
        {
         name =&gt; VALUE,
        }
    )

 OR

    $Tag-&gt;scratch($name);
    [<B>scratch</B> name]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#scratch_name">name</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>YES</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [scratch name]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;scratch(  { name =&gt; VALUE_name
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;scratch(name, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.62.2. Description</A></H3>
<P>Returns the contents of a scratch variable to the page. (A scratch variable is set with a [set] value [/set] container pair.)</P>
<H4><A NAME="scratch_name"> </A>4.62.2.1. <A NAME="scratch_name">name</A></H4>
<H2><A NAME="scratchd">4.63. scratchd</A></H2>
<P>Deletes the named scratch variable and returns its value before the deletion. For example,</P>
<PRE>
    [<B>scratchd</B> <I>varname_to_delete</I>]
</PRE>
<P>deletes the scratch variable <I>varname_to_delete</I>.</P>
<P>See also the <A HREF="#scratch">scratch</A> and <A HREF="#set">set</A> tags.</P>
<H3><A NAME="Summary">4.63.1. Summary</A></H3>
<PRE>
    [<B>scratchd</B> P_PARAM]
    [<B>scratchd</B> N_PARAM <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
name
</TD>
<TD VALIGN='Top'>
Name of scratch variable to delete
</TD>
<TD VALIGN='Top'>
<I>None</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [set myvar]This is myvar[/set]
    .
    .
    .
    [scratchd myvar]
---
    This is myvar
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;scratchd($name, $attribute_hash_reference);
</PRE>
<H3><A NAME="Description">4.63.2. Description</A></H3>
<P>Deletes the named scratch variable and returns its value before the deletion.</P>
<H2><A NAME="search-list">4.64. search-list</A></H2>
<P>Formats results returned by a search. Must be enclosed within a <A HREF="#search-region">search-region</A>. Has sub-tags (see <A HREF="#Looping tags and Sub-tags">Looping tags and Sub-tags</A>).</P>
<H2><A NAME="search-region">4.65. search-region</A></H2>
<H3><A NAME="Summary">4.65.1. Summary</A></H3>
<P>Parameters: <B>arg</B></P>
<P><B>The attribute hash reference is passed</B> after the parameters but before the container text argument. <B>This may mean that there are parameters not shown here.</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>This is a container tag, i.e. [search-region] FOO [/search-region]. Nesting: NO</P>
<P>Invalidates cache: <B>no</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;search_region(
        {
         arg =&gt; VALUE,
        },
        BODY
    )

 OR

    $Tag-&gt;search_region($arg, $ATTRHASH, $BODY);
</PRE>
<P>Attribute aliases</P>
<PRE>
            args ==&gt; arg
            params ==&gt; arg
            search ==&gt; arg
    [search-region arg <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#search_region_arg">arg</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#search_region_arg">args</A>
</TD>
<TD VALIGN='Top'>
Alias for arg
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#search_region_arg">params</A>
</TD>
<TD VALIGN='Top'>
Alias for arg
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#search_region_arg">search</A>
</TD>
<TD VALIGN='Top'>
Alias for arg
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_reparse">reparse</A>
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>no</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [search-region arg]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;search_region(  { arg =&gt; VALUE_arg
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;search_region(arg, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.65.2. Description</A></H3>
<P><B>NO Description</B></P>
<H4><A NAME="search_region_arg"> </A>4.65.2.1. <A NAME="search_region_arg">arg</A></H4>
<H2><A NAME="selected">4.66. selected</A></H2>
<H3><A NAME="Summary">4.66.1. Summary</A></H3>
<P>Parameters: <B>name value</B></P>
<P>Positional parameters in same order.</P>
<P><B>The attribute hash reference is passed</B> to the subroutine after the parameters as the last argument. <B>This may mean that there are parameters not shown here.</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>Invalidates cache: <B>YES</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;selected(
        {
         name =&gt; VALUE,
         value =&gt; VALUE,
        }
    )

 OR

    $Tag-&gt;selected($name, $value, $ATTRHASH);
    [<B>selected</B> name value <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#selected_case">case</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#selected_cgi">cgi</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#selected_default">default</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#selected_name">name</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#selected_multiple">multiple</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#selected_value">value</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>YES</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [value name=example set=neato]
    &lt;OPTION[selected example neato]&gt;Neato
    &lt;OPTION[selected example silly]&gt;Silly
---
    &lt;OPTION SELECTED&gt;Neato
    &lt;OPTION&gt;Silly
</PRE>
<H3><A NAME="Description">4.66.2. Description</A></H3>
<P>You can provide a &quot;memory&quot; for drop-down menus, radio buttons, and checkboxes with the [checked] and [selected] tags.</P>
<P>This will output SELECTED if the variable <TT>var_name</TT> is equal to <TT>value</TT>. If the optional MULTIPLE argument is present, it will look for any of a variety of values. Not case sensitive unless the optional <TT>case=1</TT> parameter is used.</P>
<P>Here is a drop-down menu that remembers an item-modifier color selection:</P>
<PRE>
    &lt;SELECT NAME=&quot;color&quot;&gt;
    &lt;OPTION [selected color blue]&gt; Blue
    &lt;OPTION [selected color green]&gt; Green
    &lt;OPTION [selected color red]&gt; Red
    &lt;/SELECT&gt;
</PRE>
<P>Here is the same thing, but for a shopping-basket color selection:</P>
<PRE>
    &lt;SELECT NAME=&quot;[modifier-name color]&quot;&gt;
    &lt;OPTION [selected [modifier-name color] blue]&gt; Blue
    &lt;OPTION [selected [modifier-name color] green]&gt; Green
    &lt;OPTION [selected [modifier-name color] red]&gt; Red
    &lt;/SELECT&gt;
</PRE>
<P>By default, the Values space (i.e. [value foo]) is checked&nbsp;-- if you want to use the volatile CGI space (i.e. [cgi foo]) use the parameter <TT>cgi=1</TT>.</P>
<P>Use the parameter <TT>default=1</TT> to specify the option that should be marked SELECTED if the value/CGI variable has never been set.</P>
<P>If the parameter <TT>multiple=1</TT> is set, the <TT>value</TT> parameter can contain multiple (stacked) values that should be selected, separated by ASCII null characters (&quot;\0&quot; in Perl).</P>
<H4><A NAME="selected_case"> </A>4.66.2.1. <A NAME="selected_case">case</A></H4>
<H4><A NAME="selected_cgi"> </A>4.66.2.2. <A NAME="selected_cgi">cgi</A></H4>
<H4><A NAME="selected_default"> </A>4.66.2.3. <A NAME="selected_default">default</A></H4>
<H4><A NAME="selected_name"> </A>4.66.2.4. <A NAME="selected_name">name</A></H4>
<H4><A NAME="selected_multiple"> </A>4.66.2.5. <A NAME="selected_multiple">multiple</A></H4>
<H4><A NAME="selected_value"> </A>4.66.2.6. <A NAME="selected_value">value</A></H4>
<H2><A NAME="set">4.67. set</A></H2>
<H3><A NAME="Summary">4.67.1. Summary</A></H3>
<P>Parameters: <B>name</B></P>
<P>Positional parameters in same order.</P>
<P>Pass attribute hash as last to subroutine: <B>no</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>This is a container tag, i.e. [set] FOO [/set]. Nesting: NO</P>
<P>Invalidates cache: <B>YES</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;set(
        {
         name =&gt; VALUE,
        },
        BODY
    )

 OR

    $Tag-&gt;set($name, $BODY);
    [<B>set</B> name]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#set_name">name</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_reparse">reparse</A>
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>YES</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;set(  { name =&gt; VALUE_name
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;set(name, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.67.2. Description</A></H3>
<P>Sets a scratch variable to <I>value</I>.</P>
<P>Most of the mv_* variables that are used for search and order conditionals are in another namespace&nbsp;-- they can be set by means of hidden fields in a form.</P>
<P>You can set an order profile with:</P>
<PRE>
  [set checkout]
  name=required
  address=required
  [/set]
  &lt;INPUT TYPE=hidden NAME=mv_order_profile VALUE=&quot;checkout&quot;&gt;
</PRE>
<P>A search profile would be set with:</P>
<PRE>
  [set substring_case]
  mv_substring_match=yes
  mv_case=yes
  [/set]
  &lt;INPUT TYPE=hidden NAME=mv_profile VALUE=&quot;substring_case&quot;&gt;
</PRE>
<P>Any of these profile values can be set in the OrderProfile files as well.</P>
<H4><A NAME="set_name"> </A>4.67.2.1. <A NAME="set_name">name</A></H4>
<H2><A NAME="set-cookie">4.68. set-cookie</A></H2>
<P>Sets browser cookie(s) with the specified attributes.</P>
<H3><A NAME="Summary">4.68.1. Summary</A></H3>
<PRE>
    [set-cookie <I>named_attributes</I>]
</PRE>
<P>Parameters must be named (no positional usage except in Perl call)</P>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#set_cookie_name">name</A>
</TD>
<TD VALIGN='Top'>
The name you give the cookie
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#set_cookie_value">value</A>
</TD>
<TD VALIGN='Top'>
The value (automatically html-escaped by Interchange)
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#set_cookie_expire">expire</A>
</TD>
<TD VALIGN='Top'>
Expiration date as
<UL>
&quot;Wdy, DD-Mon-YYYY HH:MM:SS GMT&quot;</UL>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#set_cookie_domain">domain</A>
</TD>
<TD VALIGN='Top'>
Overrides the domain(s) set in <A HREF="icconfig.html#CookieDomain">CookieDomain</A>
</TD>
<TD VALIGN='Top'>
<I>Domain(s), if any, defined in the</I> <A HREF="icconfig.html#CookieDomain">CookieDomain</A> <I>directive</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#set_cookie_path">path</A>
</TD>
<TD VALIGN='Top'>
legal URL paths for the cookie
</TD>
<TD VALIGN='Top'>
<I>URL path(s) to your catalog, including aliases</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Usage example:</B></P>
<PRE>
    [set-cookie name=mycookie
               value=&quot;the value&quot;
              expire=&quot;Tue, 03-Apr-2001 17:00:00 GMT&quot;]
---
    <I>This tag returns no value in the page</I>
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;set_cookie(  { name   =&gt; $name,
                         value  =&gt; $value,
                         expire =&gt; $expire,
                         domain =&gt; $domain,
                         path   =&gt; $path, }  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;set_cookie( $name, $value, $expire, $domain, $path );
</PRE>
<H3><A NAME="Description">4.68.2. Description</A></H3>
<P>This tag sets one or more browser cookies with your specified name, value, and expiration. (Interchange will set more than one cookie if needed to ensure that the cookie is visible from all <A HREF="icconfig.html#Catalog *global*">Catalog</A> URL path aliases and <A HREF="icconfig.html#CookieDomain">CookieDomains</A>.)</P>
<P>See the Netscape specification at <A HREF="http://www.netscape.com/newsref/std/cookie_spec.html">http://www.netscape.com/newsref/std/cookie_spec.html</A> for more cookie-specific detail.</P>
<P>If you need access to the cookie from outside of your Interchange catalog, you can also set the domain and URL paths for which the cookie will be valid. If you need the cookie only within your catalog and the domains specified by the <A HREF="icconfig.html#CookieDomain">CookieDomain</A> directive, you probably should not override the Interchange domain and path defaults.</P>
<H4><A NAME="set_cookie_name"> </A>4.68.2.1. <A NAME="set_cookie_name">name</A></H4>
<P>This is the name of the cookie. This is the key you will use when reading the cookie later.</P>
<H4><A NAME="set_cookie_value"> </A>4.68.2.2. <A NAME="set_cookie_value">value</A></H4>
<P>This is the value to store in the cookie.</P>
<H4><A NAME="set_cookie_expire"> </A>4.68.2.3. <A NAME="set_cookie_expire">expire</A></H4>
<P>Persistent cookies (that outlive a browser session) require an expiration date. The date must be a string of the form:</P>
<UL>
&quot;Wdy,&nbsp;DD-Mon-YYYY&nbsp;HH:MM:SS&nbsp;GMT&quot;</UL>
<P>and the timezone must be GMT.</P>
<P>If you do not supply a date, the cookie will disappear when the user closes the browser.</P>
<H4><A NAME="set_cookie_domain"> </A>4.68.2.4. <A NAME="set_cookie_domain">domain</A></H4>
<P>The value you set will override the Interchange default domain(s). You might set this if you need access to the cookie from outside the Interchange catalog, but it is usually better to set the <A HREF="icconfig.html#CookieDomain">CookieDomain</A> directive in your catalog.</P>
<P>The default is to use your catalog's domain or all <A HREF="icconfig.html#CookieDomain">CookieDomain</A> values.</P>
<H4><A NAME="set_cookie_path"> </A>4.68.2.5. <A NAME="set_cookie_path">path</A></H4>
<P>The value you set will override the Interchange default URL path(s).</P>
<P>The default is to set a cookie with a path for each catalog alias (see the <A HREF="icconfig.html#Catalog *global*">Catalog</A> directive). This ensures that the cookie will be visible regardless of how the end user returns to your catalog.</P>
<H2><A NAME="seti">4.69. seti</A></H2>
<H3><A NAME="Summary">4.69.1. Summary</A></H3>
<P>Parameters: <B>name</B></P>
<P>Positional parameters in same order.</P>
<P>Pass attribute hash as last to subroutine: <B>no</B></P>
<P>Interpolates <B>container text</B> by default.</P>
<P>This is a container tag, i.e. [seti] FOO [/seti]. Nesting: NO</P>
<P>Invalidates cache: <B>YES</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;seti(
        {
         name =&gt; VALUE,
        },
        BODY
    )

 OR

    $Tag-&gt;seti($name, $BODY);
    [<B>seti</B> name]value[/seti]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#seti_name">name</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_reparse">reparse</A>
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>YES</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [seti name]value[/seti]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;seti(  { name =&gt; VALUE_name
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;seti(name, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.69.2. Description</A></H3>
<P>Equivalent to the [<A HREF="#set">set</A>] tag, except that it <A HREF="#attr_interpolate">interpolates</A> by default.</P>
<H4><A NAME="seti_name"> </A>4.69.2.1. <A NAME="seti_name">name</A></H4>
<H2><A NAME="setlocale">4.70. setlocale</A></H2>
<P>Sets locale and/or currency for the current page. Can be made persistent for the user with the 'persist' option. Resets default locale if called without arguments.  See also <A HREF="ictemplates.html#Setting the Locale">Setting the Locale</A> in the template documentation.</P>
<H3><A NAME="Summary">4.70.1. Summary</A></H3>
<PRE>
    [<B>setlocale</B>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#setlocale_currency">currency</A>
</TD>
<TD VALIGN='Top'>
The currency format to use.
<UL>
<LI>Default: [scratch mv_currency] (see also 'persist' attribute)</UL>
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#setlocale_locale">locale</A>
</TD>
<TD VALIGN='Top'>
The locale to use.
<UL>
<LI>Default: [scratch mv_locale] (see also 'persist' attribute)</UL>
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#setlocale_persist">persist</A>
</TD>
<TD VALIGN='Top'>
Setting '<TT>persist=1</TT>' also sets the scratch variables, <B>mv_locale</B> and <B>mv_currency</B> to specified locale and currency. This makes the locale settings persistent for the user's session. Otherwise (<TT>persist=0</TT>), the <TT>setlocale</TT> tag affects the remainder of the current page only.
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>no</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [setlocale]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;setlocale(  {
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;setlocale(, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.70.2. Description</A></H3>
<P>Immediately sets the locale to <TT>locale</TT>, and will cause it to persist in future user pages if the <TT>persist</TT> is set to a non-zero, non-blank value. If the <TT>currency</TT> attribute is set, the pricing and currency-specific locale keys and Interchange configuration directives are modified to that locale. If there are no arguments, it sets it back to the user's default locale as defined in the scratch variables <TT>mv_locale</TT> and <TT>mv_currency</TT>.</P>
<P>This allows:</P>
<PRE>
    Dollar Pricing:

    [setlocale en_US]
    [item-list]
    [item-code]: [item-price]&lt;BR&gt;
    [/item-list]

    Franc Pricing:

    [setlocale fr_FR]
    [item-list]
    [item-code]: [item-price]&lt;BR&gt;
    [/item-list]

    [comment] Return to the user's default locale [/comment]
    [setlocale]
</PRE>
<H4><A NAME="setlocale_currency"> </A>4.70.2.1. <A NAME="setlocale_currency">currency</A></H4>
<P>The currency format to use.</P>
<UL>
<LI>Default: [scratch mv_currency] (see also 'persist' attribute)</UL>
<H4><A NAME="setlocale_locale"> </A>4.70.2.2. <A NAME="setlocale_locale">locale</A></H4>
<P>The locale to use.</P>
<UL>
<LI>Default: [scratch mv_locale] (see also 'persist' attribute)</UL>
<H4><A NAME="setlocale_persist"> </A>4.70.2.3. <A NAME="setlocale_persist">persist</A></H4>
<P>Setting '<TT>persist=1</TT>' also sets the scratch variables, <B>mv_locale</B> and <B>mv_currency</B> to specified locale and currency. This makes the locale settings persistent for the user's session. Otherwise (<TT>persist=0</TT>), the <TT>setlocale</TT> tag affects the remainder of the current page only.</P>
<H2><A NAME="shipping">4.71. shipping</A></H2>
<P>Returns the cost of shipping the items in the cart via the shipping mode set with the <B>mode</B> parameter. See also the <A HREF="icdatabase.html#Shipping">Shipping</A> section of the Database documentation.</P>
<H3><A NAME="Summary">4.71.1. Summary</A></H3>
<PRE>
    [<B>shipping</B> mode]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#shipping_add">add</A>
</TD>
<TD VALIGN='Top'>
Adds the argument to <B>add</B> as data for a shipping.asc file (in $Vend::Cfg-&gt;{ScratchDir}/) and sets it.
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#shipping_cart">cart</A>
</TD>
<TD VALIGN='Top'>
<UL>
<LI>Alias: <B>carts</B> Comma-delimited list of names of carts to calculate shipping cost for.
<LI>Default: current cart</UL>
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#shipping_cart">carts</A>
</TD>
<TD VALIGN='Top'>
Alias for cart
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#shipping_convert">convert</A>
</TD>
<TD VALIGN='Top'>
Applies the conversion (if any) set with the <A HREF="icconfig.html#PriceDivide">PriceDivide</A> catalog configuration directive.
<UL>
<LI>Default: True</UL>
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#shipping_default">default</A>
</TD>
<TD VALIGN='Top'>
Resets shipping mode to default of [value mv_shipmode]
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#shipping_file">file</A>
</TD>
<TD VALIGN='Top'>
Filename to read shipping from (default is usual shipping database, e.g., shipping.asc)
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#shipping_format">format</A>
</TD>
<TD VALIGN='Top'>
Format for results with <B>label</B> attribute.
<UL>
<LI>Default: '&lt;OPTION VALUE=&quot;%M&quot;%S&gt;%D (%F)'
<LI>For example,</UL>
<PRE>
    [shipping mode=&quot;FLAT&quot;
             label=1
            format=&quot;My Format Desc %D Price %F&quot;]
</PRE>
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#shipping_handling">handling</A>
</TD>
<TD VALIGN='Top'>
Boolean-- use [value mv_handling] rather than [value mv_shipping] as first default for <B>mode</B>. Note that this attribute matters only if you do not specify the <B>mode</B> in the tag.
<UL>
<LI>Note that this is set by the [<A HREF="#handling">handling</A> tag (which calls the <TT>shipping</TT> tag internally).  You should probably use the handling tag rather than setting this directly.
<LI>Default: False</UL>
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#shipping_hide">hide</A>
</TD>
<TD VALIGN='Top'>
Suppresses output
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#shipping_label">label</A>
</TD>
<TD VALIGN='Top'>
By default, returns HTML &lt;OPTION ...&gt; widget for shipping mode(s), including description and cost. You can override the widget with the <B>format</B> attribute.  Note that <B>label</B> overrides <B>noformat</B>.
<UL>
<LI>Here is an example from the foundation checkout.html page:</UL>
<PRE>
    [shipping
        label=1
        mode=|[data table=country key='[default country US]' col=shipmodes]|
    ]
</PRE>
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#shipping_mode">mode</A>
</TD>
<TD VALIGN='Top'>
<UL>
<LI>Aliases: <B>name</B>, <B>modes</B> Whitespace, null or comma delimited list of modes for which to calculate shipping cost.  See also mv_shipmode.
<LI>Default: [value mv_handling] if <B>handling=1</B> or [value mv_shipmode] or 'default'</UL>
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#shipping_mode">modes</A>
</TD>
<TD VALIGN='Top'>
Alias for mode
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#shipping_mode">name</A>
</TD>
<TD VALIGN='Top'>
Alias for mode
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#shipping_noformat">noformat</A>
</TD>
<TD VALIGN='Top'>
Returns result as a number rather than a string formatted for the current locale's currency.
<UL>
<LI>Default: True</UL>
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#shipping_reset_message">reset_message</A>
</TD>
<TD VALIGN='Top'>
Boolean. Blanks the session's current shipping message (i.e., $Session-&gt;{ship_message}).
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#shipping_reset_modes">reset_modes</A>
</TD>
<TD VALIGN='Top'>
Clears list of modes in $Vend::Cfg-&gt;{Shipping_line}
<UL>
<LI>Default: False</UL>
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#shipping_table">table</A>
</TD>
<TD VALIGN='Top'>
<UL>
<LI>Alias: <B>tables</B> Whitespace-delimited list of tables containing shipping data required for perl or query calculations (<I>e.g.</I>, in the 'PERL' field of your shipping database&nbsp;-- see <A HREF="icdatabase.html#Shipping">Shipping</A>). You must specify the tables to get past the Perl '<A HREF="http://www.perl.com/pub/doc/manual/html/lib/Safe.html">Safe.pm</A>' protection. For example, you will get '<A HREF="http://www.perl.com/pub/doc/manual/html/lib/Safe.html">Safe</A>' errors if you refer to an SQL table without specifying it here.
<LI>Default: None</UL>
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#shipping_table">tables</A>
</TD>
<TD VALIGN='Top'>
Alias for table
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>YES</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [shipping mode]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;shipping(  { mode =&gt; VALUE_mode
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;shipping(mode, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.71.2. Description</A></H3>
<P>This tag calculates the shipping cost for items in the current cart via the specified shipping mode (usually set in the mv_shipmode variable).  See the <A HREF="icdatabase.html#Shipping">Shipping</A> section of the Database documentation for detail.</P>
<H4><A NAME="Rounding">4.71.2.1. Rounding</A></H4>
<P>Note that the tag rounds the calculated shipping cost to a locale-specific number of fractional digits (e.g., to the nearest penny, or 2 digits after the decimal point in the USA).</P>
<H4><A NAME="shipping_add"> </A>4.71.2.2. <A NAME="shipping_add">add</A></H4>
<P>Adds the argument to <B>add</B> as data for a shipping.asc file (in $Vend::Cfg-&gt;{ScratchDir}/) and sets it.</P>
<H4><A NAME="shipping_cart"> </A>4.71.2.3. <A NAME="shipping_cart">cart</A></H4>
<UL>
<LI>Alias: <B>carts</B> Comma-delimited list of names of carts to calculate shipping cost for.
<LI>Default: current cart</UL>
<H4><A NAME="shipping_convert"> </A>4.71.2.4. <A NAME="shipping_convert">convert</A></H4>
<P>Applies the conversion (if any) set with the <A HREF="icconfig.html#PriceDivide">PriceDivide</A> catalog configuration directive.</P>
<UL>
<LI>Default: True</UL>
<H4><A NAME="shipping_default"> </A>4.71.2.5. <A NAME="shipping_default">default</A></H4>
<P>Resets shipping mode to default of [value mv_shipmode]</P>
<H4><A NAME="shipping_file"> </A>4.71.2.6. <A NAME="shipping_file">file</A></H4>
<P>Filename to read shipping from (default is usual shipping database, e.g., shipping.asc)</P>
<H4><A NAME="shipping_format"> </A>4.71.2.7. <A NAME="shipping_format">format</A></H4>
<P>Format for results with <B>label</B> attribute.</P>
<UL>
<LI>Default: '&lt;OPTION VALUE=&quot;%M&quot;%S&gt;%D (%F)'
<LI>For example,</UL>
<PRE>
    [shipping mode=&quot;FLAT&quot;
             label=1
            format=&quot;My Format Desc %D Price %F&quot;]
</PRE>
<H4><A NAME="shipping_handling"> </A>4.71.2.8. <A NAME="shipping_handling">handling</A></H4>
<P>Boolean-- use [value mv_handling] rather than [value mv_shipping] as first default for <B>mode</B>. Note that this attribute matters only if you do not specify the <B>mode</B> in the tag.</P>
<UL>
<LI>Note that this is set by the [<A HREF="#handling">handling</A> tag (which calls the <TT>shipping</TT> tag internally).  You should probably use the handling tag rather than setting this directly.
<LI>Default: False</UL>
<H4><A NAME="shipping_hide"> </A>4.71.2.9. <A NAME="shipping_hide">hide</A></H4>
<P>Suppresses output</P>
<H4><A NAME="shipping_label"> </A>4.71.2.10. <A NAME="shipping_label">label</A></H4>
<P>By default, returns HTML &lt;OPTION ...&gt; widget for shipping mode(s), including description and cost. You can override the widget with the <B>format</B> attribute.  Note that <B>label</B> overrides <B>noformat</B>.</P>
<UL>
<LI>Here is an example from the foundation checkout.html page:</UL>
<PRE>
    [shipping
        label=1
        mode=|[data table=country key='[default country US]' col=shipmodes]|
    ]
</PRE>
<H4><A NAME="shipping_mode"> </A>4.71.2.11. <A NAME="shipping_mode">mode</A></H4>
<UL>
<LI>Aliases: <B>name</B>, <B>modes</B> Whitespace, null or comma delimited list of modes for which to calculate shipping cost.  See also mv_shipmode.
<LI>Default: [value mv_handling] if <B>handling=1</B> or [value mv_shipmode] or 'default'</UL>
<H4><A NAME="shipping_noformat"> </A>4.71.2.12. <A NAME="shipping_noformat">noformat</A></H4>
<P>Returns result as a number rather than a string formatted for the current locale's currency.</P>
<UL>
<LI>Default: True</UL>
<H4><A NAME="shipping_reset_message"> </A>4.71.2.13. <A NAME="shipping_reset_message">reset_message</A></H4>
<P>Boolean. Blanks the session's current shipping message (i.e., $Session-&gt;{ship_message}).</P>
<H4><A NAME="shipping_reset_modes"> </A>4.71.2.14. <A NAME="shipping_reset_modes">reset_modes</A></H4>
<P>Clears list of modes in $Vend::Cfg-&gt;{Shipping_line}</P>
<UL>
<LI>Default: False</UL>
<H4><A NAME="shipping_table"> </A>4.71.2.15. <A NAME="shipping_table">table</A></H4>
<UL>
<LI>Alias: <B>tables</B> Whitespace-delimited list of tables containing shipping data required for perl or query calculations (<I>e.g.</I>, in the 'PERL' field of your shipping database&nbsp;-- see <A HREF="icdatabase.html#Shipping">Shipping</A>). You must specify the tables to get past the Perl '<A HREF="http://www.perl.com/pub/doc/manual/html/lib/Safe.html">Safe.pm</A>' protection. For example, you will get '<A HREF="http://www.perl.com/pub/doc/manual/html/lib/Safe.html">Safe</A>' errors if you refer to an SQL table without specifying it here.
<LI>Default: None</UL>
<H2><A NAME="shipping-desc">4.72. shipping-desc</A></H2>
<P>Returns the shipping description for the specified shipping <B>mode</B>.  See the <A HREF="icdatabase.html#Shipping">Shipping</A> section of the Database documentation.  See also shipping.asc database for shipping modes.</P>
<P>Alias: <B>shipping-description</B></P>
<P>The two tags below are identical in operation:</P>
<PRE>
   [shipping-desc mode]
   [shipping-description mode]
</PRE>
<H3><A NAME="Summary">4.72.1. Summary</A></H3>
<PRE>
    [<B>shipping-desc</B> mode]
    [<B>shipping-desc</B> mode=<I>shipping_mode</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
mode
</TD>
<TD VALIGN='Top'>
Shipping mode. This is a key into the shipping.asc database. See <A HREF="icdatabase.html#Shipping">Shipping</A> documentation.
</TD>
<TD VALIGN='Top'>
<TT>mv_shipmode</TT>, or 'default' if <TT>mv_shipmode</TT> not set
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
Yes, but only if no <B>mode</B> given
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [shipping-desc 1DM]
---
    UPS Next Day Air Early AM
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;shipping_desc( $mode );
</PRE>
<H2><A NAME="soap">4.73. soap</A></H2>
<H3><A NAME="Summary">4.73.1. Summary</A></H3>
<P>Parameters: <B>call uri proxy</B></P>
<P>Positional parameters in same order.</P>
<P><B>The attribute hash reference is passed</B> to the subroutine after the parameters as the last argument. <B>This may mean that there are parameters not shown here.</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>Invalidates cache: <B>YES</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;soap(
        {
         call =&gt; VALUE,
         uri =&gt; VALUE,
         proxy =&gt; VALUE,
        }
    )

 OR

    $Tag-&gt;soap($call, $uri, $proxy, $ATTRHASH);
    [<B>soap</B> call uri proxy <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#soap_call">call</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#soap_proxy">proxy</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#soap_uri">uri</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>YES</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [soap call uri proxy]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;soap(  { call =&gt; VALUE_call
                   proxy =&gt; VALUE_proxy
                   uri =&gt; VALUE_uri
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;soap(call,uri,proxy, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.73.2. Description</A></H3>
<P><B>NO Description</B></P>
<H4><A NAME="soap_call"> </A>4.73.2.1. <A NAME="soap_call">call</A></H4>
<H4><A NAME="soap_proxy"> </A>4.73.2.2. <A NAME="soap_proxy">proxy</A></H4>
<H4><A NAME="soap_uri"> </A>4.73.2.3. <A NAME="soap_uri">uri</A></H4>
<H2><A NAME="strip">4.74. strip</A></H2>
<P>Strips leading and trailing whitespace from the contained body text.</P>
<H3><A NAME="Summary">4.74.1. Summary</A></H3>
<PRE>
    [<B>strip</B>]
       Body text to strip
    [<B>/strip</B>]
</PRE>
<P>No parameters.</P>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;strip($BODY);
</PRE>
<P>or even better, just do it directly like this</P>
<PRE>
   $BODY =~ s/^\s+//;
   $BODY =~ s/\s+$//;
</PRE>
<H2><A NAME="subtotal">4.75. subtotal</A></H2>
<H3><A NAME="Summary">4.75.1. Summary</A></H3>
<P>Parameters: <B>name noformat</B></P>
<P>Positional parameters in same order.</P>
<P>Pass attribute hash as last to subroutine: <B>no</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>Invalidates cache: <B>YES</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;subtotal(
        {
         name =&gt; VALUE,
         noformat =&gt; VALUE,
        }
    )

 OR

    $Tag-&gt;subtotal($name, $noformat);
</PRE>
<P>Attribute aliases</P>
<PRE>
            cart ==&gt; name
    [<B>subtotal</B> name noformat]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#subtotal_name">cart</A>
</TD>
<TD VALIGN='Top'>
Alias for name
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#subtotal_name">name</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#subtotal_noformat">noformat</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>YES</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [subtotal name noformat]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;subtotal(  { name =&gt; VALUE_name
                       noformat =&gt; VALUE_noformat
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;subtotal(name,noformat, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.75.2. Description</A></H3>
<P>Positional: [subtotal cart* noformat*]</P>
<P>mandatory: NONE</P>
<P>optional: cart noformat</P>
<P>Expands into the subtotal cost, exclusive of sales tax, of all the items ordered so far for the optional <TT>cart</TT>. If the noformat tag is present and non-zero, the raw number with no currency formatting will be given.</P>
<H4><A NAME="subtotal_name"> </A>4.75.2.1. <A NAME="subtotal_name">name</A></H4>
<H4><A NAME="subtotal_noformat"> </A>4.75.2.2. <A NAME="subtotal_noformat">noformat</A></H4>
<H2><A NAME="tag">4.76. tag</A></H2>
<H3><A NAME="Summary">4.76.1. Summary</A></H3>
<P>Parameters: <B>op arg</B></P>
<P>Positional parameters in same order.</P>
<P><B>The attribute hash reference is passed</B> after the parameters but before the container text argument. <B>This may mean that there are parameters not shown here.</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>This is a container tag, i.e. [tag] FOO [/tag]. Nesting: NO</P>
<P>Invalidates cache: <B>no</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;tag(
        {
         op =&gt; VALUE,
         arg =&gt; VALUE,
        },
        BODY
    )

 OR

    $Tag-&gt;tag($op, $arg, $ATTRHASH, $BODY);
</PRE>
<P>Attribute aliases</P>
<PRE>
            description ==&gt; arg
    [<B>tag</B> op arg <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#tag_arg">arg</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#tag_arg">description</A>
</TD>
<TD VALIGN='Top'>
Alias for arg
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#tag_op">op</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_reparse">reparse</A>
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>no</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [tag op arg]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;tag(  { arg =&gt; VALUE_arg
                  op =&gt; VALUE_op
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;tag(op,arg, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.76.2. Description</A></H3>
<P>Performs any of a number of operations, based on the presence of <TT>arg</TT>. The arguments that may be given are:</P>
<H4><A NAME="tag_export"> </A>4.76.2.1. <A NAME="tag_export">export database file* type*</A></H4>
<P>Exports a complete Interchange database to its text source file (or any specified file). The integer <TT>n</TT>, if specified, will select export in one of the enumerated Interchange export formats. The following tag will export the products database to products.txt (or whatever you have defined its source file as), in the format specified by the <I>Database</I> directive:</P>
<PRE>
    [tag export products][/tag]
</PRE>
<P>Same thing, except to the file products/new_products.txt:</P>
<PRE>
    [tag export products products/newproducts.txt][/tag]
</PRE>
<P>Same thing, except the export is done with a PIPE delimiter:</P>
<PRE>
    [tag export products products/newproducts.txt 5][/tag]
</PRE>
<P>The file is relative to the catalog directory, and only may be an absolute path name if <I>NoAbsolute</I> is set to <TT>No</TT>.</P>
<H4><A NAME="tag_flag"> </A>4.76.2.2. <A NAME="tag_flag">flag arg</A></H4>
<P>Sets an Interchange condition.</P>
<P>The following enables writes on the <TT>products</TT> and <TT>sizes</TT> databases held in Interchange internal DBM format:</P>
<PRE>
    [tag flag write]products sizes[/tag]
</PRE>
<P>SQL databases are always writable if allowed by the SQL database itself&nbsp;-- in-memory databases will never be written.</P>
<P>The [tag flag build][/tag] combination forces static build of a page, even if dynamic elements are contained. Similarly, the [tag flag cache][/tag] forces search or page caching (not usually wise).</P>
<H4><A NAME="tag_log"> </A>4.76.2.3. <A NAME="tag_log">log dir/file</A></H4>
<P>Logs a message to a file, fully interpolated for Interchange tags. The following tag will send every item code and description in the user's shopping cart to the file logs/transactions.txt:</P>
<PRE>
    [tag log logs/transactions.txt]
    [item-list][item-code]  [item-description]
    [/item-list][/tag]
</PRE>
<P>The file is relative to the catalog directory, and only may be an absolute path name if <I>NoAbsolute</I> is set to <TT>No</TT>.</P>
<H4><A NAME="tag_mime_description_string"> </A>4.76.2.4. <A NAME="tag_mime_description_string">mime description_string</A></H4>
<P>Returns a MIME-encapsulated message with the boundary as employed in the other mime tags, and the <TT>description_string</TT> used as the Content-Description. For example</P>
<PRE>
   [tag mime My Plain Text]Your message here.[/tag]
</PRE>
<P>will return</P>
<PRE>
  Content-Type: TEXT/PLAIN; CHARSET=US-ASCII
  Content-ID: [sequential, lead as in mime boundary]
  Content-Description: My Plain Text

  Your message here.
</PRE>
<P>When used in concert with [tag mime boundary], [tag mime header], and [tag mime id], allows MIME attachments to be included&nbsp;-- typically with PGP-encrypted credit card numbers. See the demo page ord/report.html for an example.</P>
<H4><A NAME="tag_mime_boundary"> </A>4.76.2.5. <A NAME="tag_mime_boundary">mime boundary</A></H4>
<P>Returns a MIME message boundary with unique string keyed on session ID, page count, and time.</P>
<H4><A NAME="tag_mime_header"> </A>4.76.2.6. <A NAME="tag_mime_header">mime header</A></H4>
<P>Returns a MIME message header with the proper boundary for that session ID, page count, and time.</P>
<H4><A NAME="tag_mime_id"> </A>4.76.2.7. <A NAME="tag_mime_id">mime id</A></H4>
<P>Returns a MIME message id with the proper boundary for that session ID, page count, and time.</P>
<H4><A NAME="tag_show_tags"> </A>4.76.2.8. <A NAME="tag_show_tags">show_tags</A></H4>
<P>The encased text will not be substituted for with Interchange tags, with &lt; and [ characters changed to <TT>&amp;</TT>#lt; and <TT>&amp;</TT>#91; respectively.</P>
<PRE>
    [tag show_tags][value whatever][/tag]
</PRE>
<H4><A NAME="tag_time"> </A>4.76.2.9. <A NAME="tag_time">time</A></H4>
<P>Formats the current time according to POSIX strftime arguments. The following is the string for Thursday, April 30, 1997.</P>
<PRE>
    [tag time]%A, %B %d, %Y[/tag]
</PRE>
<H4><A NAME="tag_touch"> </A>4.76.2.10. <A NAME="tag_touch">touch</A></H4>
<P>Touches a database to allow use of the tag_data() routine in user-defined subroutines. If this is not done, the routine will error out if the database has not previously been accessed on the page.</P>
<PRE>
    [tag touch products][/tag]
</PRE>
<H4><A NAME="tag_arg"> </A>4.76.2.11. <A NAME="tag_arg">arg</A></H4>
<H4><A NAME="tag_op"> </A>4.76.2.12. <A NAME="tag_op">op</A></H4>
<H2><A NAME="time">4.77. time</A></H2>
<H3><A NAME="Summary">4.77.1. Summary</A></H3>
<P>Parameters: <B>locale</B></P>
<P>Positional parameters in same order.</P>
<P><B>The attribute hash reference is passed</B> after the parameters but before the container text argument. <B>This may mean that there are parameters not shown here.</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>This is a container tag, i.e. [time] FOO [/time]. Nesting: NO</P>
<P>Invalidates cache: <B>no</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;time(
        {
         locale =&gt; VALUE,
        },
        BODY
    )

 OR

    $Tag-&gt;time($locale, $ATTRHASH, $BODY);
    [<B>time</B> locale <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#time_adjust">adjust</A>
</TD>
<TD VALIGN='Top'>
Temporarily adjust the time for display purposes.
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#time_gmt">gmt</A>
</TD>
<TD VALIGN='Top'>
Display time as GMT.
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#time_locale">locale</A>
</TD>
<TD VALIGN='Top'>
Format the time according to the named locale.
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#time_tz">tz</A>
</TD>
<TD VALIGN='Top'>
Use the passed timezone to display the time.
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#time_zerofix">zerofix</A>
</TD>
<TD VALIGN='Top'>
Strips leading zeroes from numbers.
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_reparse">reparse</A>
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>no</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [time locale]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;time(  { locale =&gt; VALUE_locale
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;time(locale, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.77.2. Description</A></H3>
<P>Formats the current time according to POSIX strftime arguments. The following is the string for Monday, January 1, 2001.</P>
<PRE>
    [time]%A, %B %d, %Y[/tag]
</PRE>
<P>See the <TT>strftime</TT> man page for information on the arguments (which are the same as modern UNIX date commands).</P>
<P>Accepts the following options:</P>
<H4><A NAME="time_adjust"> </A>4.77.2.1. <A NAME="time_adjust">adjust</A></H4>
<P>If you wish to temporarily adjust the time for display purposes, you can pass an <TT>adjust</TT> parameter with the number of hours (plus or minus).</P>
<PRE>
        [time]%c[/time]
        [time adjust=&quot;-3&quot;]%c[/time]
</PRE>
<P>Will display:</P>
<PRE>
 Mon 01 Jan 2001 11:29:03 AM EST
 Mon 01 Jan 2001 08:29:03 AM EST
</PRE>
<P>If the number ends in zero and has 3 digits or more, it is assumed that the number is in timezone format (i.e +500) the local time or from GMT:</P>
<PRE>
        [time]%c[/time]
        [time adjust=&quot;-330&quot;]%c[/time]
        [time adjust=&quot;-300&quot;]%c[/time]
</PRE>
<P>Will display:</P>
<PRE>
 Mon 01 Jan 2001 11:29:03 AM EST
 Mon 01 Jan 2001 07:59:03 AM EST
 Mon 01 Jan 2001 08:29:03 AM EST
</PRE>
<P>If you want to force the number to be just a number of hours, add the <TT>hours</TT> parameter:</P>
<PRE>
        [time]%c[/time]
        [time adjust=&quot;100&quot; hours=1]%c[/time]
</PRE>
<P>Will display:</P>
<PRE>
 Mon 01 Jan 2001 11:29:03 AM EST
 Fri 05 Jan 2001 15:29:03 PM EST
</PRE>
<P>If <TT>adjust</TT> is an Interchange time duration with a suffix of <TT>sec</TT>, <TT>min</TT>, <TT>hrs</TT>, <TT>days</TT>, or <TT>weeks</TT>, that will be used.</P>
<PRE>
        [time]%c[/time]
        [time adjust=&quot;2 days&quot;]%c[/time]
</PRE>
<P>Will display:</P>
<PRE>
 Mon 01 Jan 2001 11:29:03 AM EST
 Wed 03 Jan 2001 11:29:03 AM EST
</PRE>
<P>Note that the time zone does not change&nbsp;-- you should either pick a format which doesn't display zone, use the <TT>tz</TT> parameter, or manage it yourself.</P>
<P>NOTE: You can adjust time globally for an Interchange installation by setting the $ENV{TZ} variable on many systems. Set TZ in your environment and then restart Interchange:</P>
<PRE>
        ## bash/ksh/sh
        TZ=PST7PDT; export TZ
        interchange -restart

        ## csh/tcsh
        setenv TZ PST7PDT
        interchange -restart
</PRE>
<P>On most modern UNIX systems, all times will now be in the PST zone.</P>
<H4><A NAME="time_gmt"> </A>4.77.2.2. <A NAME="time_gmt">gmt</A></H4>
<P>If you want to display time as GMT, use the <TT>gmt</TT> parameter:</P>
<PRE>
        [time]%c[/time]
        [time gmt=1]%c[/time]
</PRE>
<P>will display:</P>
<PRE>
        Mon 01 Jan 2001 11:33:26 AM EST
        Mon 01 Jan 2001 04:33:26 PM EST
</PRE>
<P>Once again, the zone will not be set to GMT, so you should pick a format string which doesn't use zone, use the <TT>tz</TT> parameter, or manage it yourself.</P>
<H4><A NAME="time_locale"> </A>4.77.2.3. <A NAME="time_locale">locale</A></H4>
<P>Format the time according to the named <TT>locale</TT>, assuming that locale is available on your operating system. For example, the following:</P>
<PRE>
        [time locale=en_US]%B %d, %Y[/time]
        [time locale=fr_FR]%B %d, %Y[/time]
</PRE>
<P>should display:</P>
<PRE>
        January 01, 2001
        janvier 01, 2001
</PRE>
<H4><A NAME="time_tz"> </A>4.77.2.4. <A NAME="time_tz">tz</A></H4>
<P>Use the passed timezone to display the time. Will adjust for hours difference.</P>
<P>Example:</P>
<PRE>
        [time tz=GMT0]
        [time tz=CST6CDT]
        [time tz=PST8PDT]
</PRE>
<P>will display:</P>
<PRE>
        Mon 01 Jan 2001 04:43:02 PM GMT
        Mon 01 Jan 2001 10:43:02 AM CST
        Mon 01 Jan 2001 08:43:02 AM PST
</PRE>
<P>Note that the first alphabetical string is the zone name when not under daylight savings time, the digit is the number of hours displacement from GMT, and the second alphabetical string is the zone name when in daylight savings time. NOTE: This may not work on all operating systems.</P>
<H4><A NAME="time_zerofix"> </A>4.77.2.5. <A NAME="time_zerofix">zerofix</A></H4>
<P>Strips leading zeroes from numbers.</P>
<H2><A NAME="timed-build">4.78. timed-build</A></H2>
<H3><A NAME="Summary">4.78.1. Summary</A></H3>
<P>Parameters: <B>file</B></P>
<P>Positional parameters in same order.</P>
<P><B>The attribute hash reference is passed</B> after the parameters but before the container text argument. <B>This may mean that there are parameters not shown here.</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>This is a container tag, i.e. [timed-build] FOO [/timed-build]. Nesting: NO</P>
<P>Invalidates cache: <B>no</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;timed_build(
        {
         file =&gt; VALUE,
        },
        BODY
    )

 OR

    $Tag-&gt;timed_build($file, $ATTRHASH, $BODY);
    [timed-build file <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#timed_build_auto">auto</A>
</TD>
<TD VALIGN='Top'>
Turn on automatic region processing.
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#timed_build_file">file</A>
</TD>
<TD VALIGN='Top'>
Name of the cache file.
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#timed_build_if">if</A>
</TD>
<TD VALIGN='Top'>
Conditional display of the cached region.
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#timed_build_minutes">minutes</A>
</TD>
<TD VALIGN='Top'>
Number of minutes after which the timed build should be repeated.
</TD>
<TD VALIGN='Top'>
60
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#timed_build_period">period</A>
</TD>
<TD VALIGN='Top'>
Alternative way of expressing time.
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_reparse">reparse</A>
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>no</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [timed-build file]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;timed_build(  { file =&gt; VALUE_file
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;timed_build(file, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.78.2. Description</A></H3>
<P>Allows you to build CPU-intensive regions of ITL tags on a timed basis.</P>
<P>In the simplest case, surround a region of ITL with [<A HREF="#timed-build">timed-build</A>] and <TT>[/timed-build]</TT>:</P>
<PRE>
        [timed-build]
                Built at [time]%c[/time].
        [/timed-build]
</PRE>
<P>If a <TT>file</TT> parameter is not passed, saves to the directory <I>timed</I> in catalog root, with the file name of the current page. If the <TT>minutes</TT> parameter is not passed specifying how often the page should be rebuilt, then it will not be rebuilt until the output file is removed.</P>
<P>Accepts the following parameters:</P>
<H4><A NAME="timed_build_auto"> </A>4.78.2.1. <A NAME="timed_build_auto">auto</A></H4>
<P>Turns on automatic region processing. The text of the timed-build region is processed to determine a unique checksum or digest (using MD5), and that file name is checked in the directory tmp/auto-timed (assuming <TT>ScratchDir</TT> is set to <TT>tmp</TT>). If no number of minutes is supplied, <TT>60</TT> is assumed.</P>
<P>This is designed to automatically build regions of commonly used areas without having to manage the file name yourself.</P>
<P>Implies <TT>login=1</TT>, but will still abort if no session ID cookie has been sent. Use <TT>force=1</TT> to ignore cookie status.</P>
<H4><A NAME="timed_build_file"> </A>4.78.2.2. <A NAME="timed_build_file">file</A></H4>
<P>Name of the file to save the results in. Relative to catalog root. The directory must exist.</P>
<H4><A NAME="timed_build_if"> </A>4.78.2.3. <A NAME="timed_build_if">if</A></H4>
<P>Allows you to to only display the cached region when the <TT>if</TT> parameter is true. For example, you can do:</P>
<PRE>
        [timed-build if=&quot;[value timed]&quot;]
        ITL tags....
        [/timed-build]
</PRE>
<P>The cached region will only be displayed if the variable <TT>timed</TT> is set to a non-zero, non-blank value. Otherwise, the ITL tags will be re-interpreted every time.</P>
<H4><A NAME="timed_build_minutes"> </A>4.78.2.4. <A NAME="timed_build_minutes">minutes</A></H4>
<P>The number of minutes after which the timed build should be repeated. If set to 0, it will be built once and then not rebuilt until the output file is removed.</P>
<H4><A NAME="timed_build_period"> </A>4.78.2.5. <A NAME="timed_build_period">period</A></H4>
<P>Alternative way of expressing time. You can pass a string describing the rebuild time period:</P>
<PRE>
        [timed-build period=&quot;4 hours&quot;]
        ITL tags....
        [/timed-build]
</PRE>
<P>This is really the same as <TT>minutes=240</TT>. Useful for passing seconds:</P>
<PRE>
        [timed-build period=&quot;5 seconds&quot;]
        ITL tags....
        [/timed-build]
</PRE>
<P>The region will be rebuilt every 5 seconds.</P>
<P>Performance Tip: use minutes of .08 instead; avoids having to parse the period string.</P>
<P>If you have the StaticDir catalog.cfg parameter set to a writable path, you can build a cached static version of your catalog over time. Simply place a [timed-build] tag at the top of pages you wish to build statically. Assuming the catalog is not busy and write lock can be obtained, the StaticDBM database will be updated to mark the page as static and the next time a link is made for that page the static version will be presented.</P>
<H2><A NAME="tmp">4.79. tmp</A></H2>
<H3><A NAME="Summary">4.79.1. Summary</A></H3>
<P>Parameters: <B>name</B></P>
<P>Positional parameters in same order.</P>
<P>Pass attribute hash as last to subroutine: <B>no</B></P>
<P>Interpolates <B>container text</B> by default.</P>
<P>This is a container tag, i.e. [tmp] FOO [/tmp]. Nesting: NO</P>
<P>Invalidates cache: <B>YES</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;tmp(
        {
         name =&gt; VALUE,
        },
        BODY
    )

 OR

    $Tag-&gt;tmp($name, $BODY);
    [<B>tmp</B> name]value[/tmp]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#tmp_name">name</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_reparse">reparse</A>
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>YES</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [tmp name]value[/tmp]
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;tmp(  { name =&gt; VALUE_name
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;tmp(name, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.79.2. Description</A></H3>
<P>Sets a scratch variable to <I>value</I>, but at the end of the user session the Scratch key is deleted. This saves session write time in many cases.</P>
<P>This tag interpolates automatically. (Interpolation can be turned off with <TT>interpolate=0</TT>.)</P>
<P>IMPORTANT NOTE: the [tmp ...][/tmp] tag is not appropriate for setting order profiles or <TT>mv_click</TT> actions. If you want to avoid that, use a profile stored via the catalog.cfg directive <TT>OrderProfile</TT>.</P>
<H4><A NAME="tmp_name"> </A>4.79.2.1. <A NAME="tmp_name">name</A></H4>
<H2><A NAME="tmpn">4.80. tmpn</A></H2>
<H3><A NAME="Summary">4.80.1. Summary</A></H3>
<P>Parameters: <B>name</B></P>
<P>Positional parameters in same order.</P>
<P>Pass attribute hash as last to subroutine: <B>no</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>This is a container tag, i.e. [tmpn] FOO [/tmpn]. Nesting: NO</P>
<P>Invalidates cache: <B>YES</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;tmpn(
        {
         name =&gt; VALUE,
        },
        BODY
    )

 OR

    $Tag-&gt;tmpn($name, $BODY);
    [<B>tmpn</B> name]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#tmpn_name">name</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_reparse">reparse</A>
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>YES</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;tmpn(  { name =&gt; VALUE_name
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;tmpn(name, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.80.2. Description</A></H3>
<P>Equivalent to the [<A HREF="#tmp">tmp</A>] tag, except that it does not <A HREF="#attr_interpolate">interpolate</A> by default.</P>
<P>NOTE: This tag was introduced in Interchange 4.9 and is therefore not available in earlier versions.</P>
<H4><A NAME="tmpn_name"> </A>4.80.2.1. <A NAME="tmpn_name">name</A></H4>
<H2><A NAME="total-cost">4.81. total-cost</A></H2>
<H3><A NAME="Summary">4.81.1. Summary</A></H3>
<P>Parameters: <B>name noformat</B></P>
<P>Positional parameters in same order.</P>
<P>Pass attribute hash as last to subroutine: <B>no</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>Invalidates cache: <B>YES</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;total_cost(
        {
         name =&gt; VALUE,
         noformat =&gt; VALUE,
        }
    )

 OR

    $Tag-&gt;total_cost($name, $noformat);
</PRE>
<P>Attribute aliases</P>
<PRE>
            cart ==&gt; name
    [total-cost name noformat]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#total_cost_name">cart</A>
</TD>
<TD VALIGN='Top'>
Alias for name
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#total_cost_name">name</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#total_cost_noformat">noformat</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>YES</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [total-cost name noformat]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;total_cost(  { name =&gt; VALUE_name
                         noformat =&gt; VALUE_noformat
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;total_cost(name,noformat, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.81.2. Description</A></H3>
<P>Expands into the total cost of all the items in the current shopping cart, including sales tax (if any).</P>
<H4><A NAME="total_cost_name"> </A>4.81.2.1. <A NAME="total_cost_name">name</A></H4>
<H4><A NAME="total_cost_noformat"> </A>4.81.2.2. <A NAME="total_cost_noformat">noformat</A></H4>
<H2><A NAME="tree">4.82. tree</A></H2>
<H3><A NAME="Summary">4.82.1. Summary</A></H3>
<P>Parameters: <B>table master subordinate start</B></P>
<P><B>The attribute hash reference is passed</B> after the parameters but before the container text argument. <B>This may mean that there are parameters not shown here.</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>This is a container tag, i.e. [tree] FOO [/tree]. Nesting: NO</P>
<P>Invalidates cache: <B>no</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;tree(
        {
         table =&gt; VALUE,
         master =&gt; VALUE,
         subordinate =&gt; VALUE,
         start =&gt; VALUE,
        },
        BODY
    )

 OR

    $Tag-&gt;tree($table, $master, $subordinate, $start, $ATTRHASH, $BODY);
</PRE>
<P>Attribute aliases</P>
<PRE>
            sub ==&gt; subordinate
    [<B>tree</B> table master subordinate start <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#tree_master">master</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#tree_start">start</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#tree_subordinate">sub</A>
</TD>
<TD VALIGN='Top'>
Alias for subordinate
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#tree_subordinate">subordinate</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#tree_table">table</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_reparse">reparse</A>
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>no</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [tree table master subordinate start]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;tree(  { master =&gt; VALUE_master
                   start =&gt; VALUE_start
                   subordinate =&gt; VALUE_subordinate
                   table =&gt; VALUE_table
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;tree(table,master,subordinate,start, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.82.2. Description</A></H3>
<P>Provides iterative list capability for binary trees. It produces hash-based rows use the same tags as [<A HREF="#item-list">item-list</A>]; sets some additional hash key entries to describe the tree and provide display control.</P>
<P>Works on a data set with the structure:</P>
<PRE>
    parent  child
    99      a
    a       b
    a       c
    a       d
    a       x
    x       y
    x       z
    99      m
    99      n
    99      o
    o       e
    o       f
    o       g
</PRE>
<P>Sets several keys which assist in walking and displaying the tree.</P>
<H4><A NAME="tree_key_mv_level"> </A>4.82.2.1. <A NAME="tree_key_mv_level">mv_level</A></H4>
<P>Level of the item. If it is in the first level, it is 0. Sublevels are infinite (except for performance).</P>
<H4><A NAME="tree_key_mv_increment"> </A>4.82.2.2. <A NAME="tree_key_mv_increment">mv_increment</A></H4>
<P>Increment label for the item. Normally goes from 1...n, but can be changed to A...Z or a...z in outline mode.</P>
<H4><A NAME="tree_key_mv_children"> </A>4.82.2.3. <A NAME="tree_key_mv_children">mv_children</A></H4>
<P>If in autodetect mode, set to the number of children this branch has. If a leaf, set to 0.</P>
<H4><A NAME="tree_key_mv_spacing"> </A>4.82.2.4. <A NAME="tree_key_mv_spacing">mv_spacing</A></H4>
<P>A multiple of level times the spacing option. Useful for setting width of spacer images.</P>
<P>The above sample data placed in a table named &quot;tree&quot; would produce:</P>
<PRE>
    a           mv_level=0, mv_increment=1, mv_children=4
        b       mv_level=1, mv_increment=1, mv_children=0
        c       mv_level=1, mv_increment=2, mv_children=0
        d       mv_level=1, mv_increment=3, mv_children=0
        x       mv_level=1, mv_increment=4, mv_children=2
            y   mv_level=2, mv_increment=1, mv_children=0
            z   mv_level=2, mv_increment=2, mv_children=0
    m           mv_level=0, mv_increment=1, mv_children=0
    n           mv_level=0, mv_increment=2, mv_children=0
    o           mv_level=0, mv_increment=3, mv_children=3
        e       mv_level=1, mv_increment=1, mv_children=0
        f       mv_level=1, mv_increment=2, mv_children=0
        g       mv_level=1, mv_increment=3, mv_children=0
</PRE>
<P>from the tag call:</P>
<PRE>
        &lt;table&gt;
    [tree   start=99
            table=tree
            master=parent
            subordinate=child
            autodetect=1
            spacing=4
            full=1]
        &lt;tr&gt;
        &lt;td&gt;
        [if-item-param mv_level]
                [item-calc]
                        return '&amp;nbsp' x [item-param mv_spacing];
                [/item-calc]
        [/if-item-param]
        [item-param child]
        &lt;/td&gt;
        &lt;td&gt;
                mv_level=[item-param mv_level],
                mv_increment=[item-param mv_increment],
                mv_children=[item-param mv_children]
        &lt;/td&gt;
        &lt;/tr&gt;
        [/tree]
        &lt;/table&gt;
</PRE>
<P>Accepts the following parameters:</P>
<H4><A NAME="tree_table"> </A>4.82.2.5. <A NAME="tree_table">table</A></H4>
<P>Database table which contains the tree. Must be a valid Interchange table identifier.</P>
<H4><A NAME="tree_master"> </A>4.82.2.6. <A NAME="tree_master">master</A></H4>
<P>The column which is used to determine the parent of the item.</P>
<H4><A NAME="tree_subordinate"> </A>4.82.2.7. <A NAME="tree_subordinate">subordinate</A></H4>
<P>The child column, which determines which items are sub-items of the current one. Used to re-query for items with its value in <TT>master</TT>.</P>
<H4><A NAME="tree_start_item"> </A>4.82.2.8. <A NAME="tree_start_item">start_item</A></H4>
<P>The first item to be followed, i.e. the <TT>master</TT> value of all the top-level items.</P>
<H4><A NAME="tree_autodetect"> </A>4.82.2.9. <A NAME="tree_autodetect">autodetect</A></H4>
<P>Specifies that the next level should be followed to detect the number of child items contained. Not recursive; only follows far enough to determine the children of the current item.</P>
<H4><A NAME="tree_full"> </A>4.82.2.10. <A NAME="tree_full">full</A></H4>
<P>Specifies that all items should be followed. Essentially the same as specifying <TT>memo</TT> and passing the <TT>explode</TT> variable, but not dependent on them. Useful for building lists for inclusion in embedded Perl, among other things.</P>
<H4><A NAME="tree_stop"> </A>4.82.2.11. <A NAME="tree_stop">stop</A></H4>
<P>An optional <TT>stop</TT> field which, when the value is true, can stop the following of the branch.</P>
<H4><A NAME="tree_continue"> </A>4.82.2.12. <A NAME="tree_continue">continue</A></H4>
<P>An optional <TT>continue</TT> field which, when the value is true, can force the branch to be followed.</P>
<H4><A NAME="tree_sort"> </A>4.82.2.13. <A NAME="tree_sort">sort</A></H4>
<P>The column which should be used for ordering the items&nbsp;-- determines the order in which they will be displayed under the current parent.</P>
<H4><A NAME="tree_outline"> </A>4.82.2.14. <A NAME="tree_outline">outline</A></H4>
<P>Sets outline mode, where <TT>mv_increment</TT> will be displayed with letter values or numeral values. If set to specifically <TT>1</TT>, will produced outline increments like:</P>
<PRE>
    1
        A
        B
            1
            2
        C
            1
            2
                a
                b
                    1
                    2
                        a
                        b
    2
</PRE>
<H4><A NAME="tree_memo"> </A>4.82.2.15. <A NAME="tree_memo">memo</A></H4>
<P>Indicates that the collapse/explode/toggle features are to be used, and names a <TT>Scratch</TT> variable where the values should be stored.</P>
<H4><A NAME="tree_collapse"> </A>4.82.2.16. <A NAME="tree_collapse">collapse</A></H4>
<P>The name of a variable in the user's session which will determine that the tree should be &quot;collapsed&quot;. When collapsed, the child items will not be followed unless they are set to be followed with <TT>toggle</TT>. Zeros all toggles.</P>
<P>Requires <TT>memo</TT> to be set if values are to be retained.</P>
<H4><A NAME="tree_toggle"> </A>4.82.2.17. <A NAME="tree_toggle">toggle</A></H4>
<P>The name of a variable in the user's session which will determine that the current item should be either followed or not followed. The first time the <TT>toggle</TT> variable corresponding to its primary key is passed, the item will be expanded. The next call will &quot;collapse&quot; the item.</P>
<P>Requires <TT>memo</TT> to be set if values are to be retained.</P>
<H4><A NAME="tree_explode"> </A>4.82.2.18. <A NAME="tree_explode">explode</A></H4>
<P>The name of a variable in the user's session which will determine that the tree should be &quot;exploded&quot;. When exploded, all child items are followed and the full tree can be displayed.</P>
<P>Requires <TT>memo</TT> to be set if values are to be retained.</P>
<H4><A NAME="tree_pedantic"> </A>4.82.2.19. <A NAME="tree_pedantic">pedantic</A></H4>
<P>When set to a true value, and an endless tree is detected (i.e. the child branch contains a parent) then the error will be logged to the catalog error log and the tree call will return with an error.</P>
<P>If <TT>pedantic</TT> is not set (the default), the current leaf will be shown but never followed. This allows partial display of the tree.</P>
<H4><A NAME="tree_log_error"> </A>4.82.2.20. <A NAME="tree_log_error">log_error</A></H4>
<P>When set to a true value, and an endless tree is detected (i.e. the child branch contains a parent) then the error will be logged to the catalog error log. No logging done by default.</P>
<H4><A NAME="tree_show_error"> </A>4.82.2.21. <A NAME="tree_show_error">show_error</A></H4>
<P>When set to a true value, and an endless tree is detected (i.e. the child branch contains a parent) then the error will be returned in the page. Errors are NOT shown by default.</P>
<P>In addition to the above values, all valid options for a list tag are in force. For example, you can set a &quot;SELECTED&quot; value on an option list with <TT>option=1</TT>, set the tag prefix with <TT>prefix</TT>, etc.</P>
<H4><A NAME="tree_master"> </A>4.82.2.22. <A NAME="tree_master">master</A></H4>
<H4><A NAME="tree_start"> </A>4.82.2.23. <A NAME="tree_start">start</A></H4>
<H4><A NAME="tree_subordinate"> </A>4.82.2.24. <A NAME="tree_subordinate">subordinate</A></H4>
<H4><A NAME="tree_table"> </A>4.82.2.25. <A NAME="tree_table">table</A></H4>
<H2><A NAME="try">4.83. try</A></H2>
<P>Allows you to trap errors. Interchange processes the body text of the [<TT>try</TT>][<TT>/try</TT>] block and returns it normally if it does not generate an error. If it does generate an error, Interchange executes the [<TT>catch</TT>][<TT>/catch</TT>] block.</P>
<P>See also '<A HREF="#catch">catch</A>'.</P>
<H3><A NAME="Summary">4.83.1. Summary</A></H3>
<PRE>
    [<B>try</B> label=<I>my_label</I> <I>other_named_attributes</I>]
        <I>Body text to return if no error</I>
    [<B>/try</B>]
    .
    .
    .
    [<B>catch</B> <I>my_label</I>]
        <I>Body text to return if try block caused an error</I>
    [<B>/catch</B>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#try_label">label</A>
</TD>
<TD VALIGN='Top'>
The label shared by the paired <TT>try</TT> and <A HREF="#catch">catch</A> blocks
</TD>
<TD VALIGN='Top'>
'default'
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#try_status">status</A>
</TD>
<TD VALIGN='Top'>
Returns 0 (failed) or 1 (succeeded) instead of page output
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#try_hide">hide</A>
</TD>
<TD VALIGN='Top'>
Suppresses page output
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#try_clean">clean</A>
</TD>
<TD VALIGN='Top'>
Suppress <TT>try</TT> block output if it has an error
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate</A>
</TD>
<TD VALIGN='Top'>
See <A HREF="#attr_interpolate">Interpolating Parameters</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_reparse">reparse</A>
</TD>
<TD VALIGN='Top'>
See <A HREF="#attr_reparse">Interpolating Parameters</A>
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [set divisor]0[/set]
    [try label=div]
        [calc] 1 / [scratch divisor] [/calc]
    [/try]
    [catch div]Division error[/catch]
---
    Division Error
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;try(    { label  =&gt; I&lt;'try_catch_label'&gt;,
                    status =&gt; 1, },
                  $try_body  );

    $Tag-&gt;catch(  { label  =&gt; I&lt;'try_catch_label'&gt;, },
                  $catch_body )
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;try($label, $attribute_hash_reference, $try_body);
    $Tag-&gt;catch($label, $attribute_hash_reference, $catch_body);
</PRE>
<H4><A NAME="See Also">4.83.1.1. See Also</A></H4>
<P><A HREF="#catch">catch</A></P>
<H3><A NAME="Description">4.83.2. Description</A></H3>
<P>Allows you to trap errors. Interchange processes the body text of the [<TT>try</TT>][<TT>/try</TT>] block and returns it normally if it does not generate an error. If it does generate an error, interchange executes the [<TT>catch</TT>][<TT>/catch</TT>] block. The catch block executes where it is on the page (<I>i.e.</I>, it does not replace the output of the try block).</P>
<P>Note that the <TT>catch</TT> block must occur after the [try] block in the document.</P>
<H4><A NAME="try_label"> </A>4.83.2.1. <A NAME="try_label">label</A></H4>
<P>The try and catch blocks are matched by this label.</P>
<P>Technical note:</P>
<P>The try tag will also place a result in the $Session object.  For example, the following returns the 'Illegal division by zero...' error message if it occurs:</P>
<PRE>
    [try label=divide][calc] 1 / [scratch divisor] [/calc][/try]

    [catch divide]
        [calc]$Session-&gt;{try}{divide}[/calc]
    [/catch]
</PRE>
<P>The $Session-&gt;{try}{divide} object will be set to the empty string ('') if there was no error, or it will contain the error message if there was an error.</P>
<P>The [<A HREF="#perl">perl</A>] and [<A HREF="#calc">calc</A>] tags also set $Session-&gt;{try}-&gt;{<I>active_label</I>} on errors.</P>
<H4><A NAME="try_status"> </A>4.83.2.2. <A NAME="try_status">status</A></H4>
<P>Suppresses <TT>try</TT> block output and returns 1 if no error or 0 if an error occurred instead.  Executes the <TT>catch</TT> block as usual in case of an error.</P>
<H4><A NAME="try_hide"> </A>4.83.2.3. <A NAME="try_hide">hide</A></H4>
<P>Suppresses <TT>try</TT> block output (regardless of success or failure).  Executes the <TT>catch</TT> block as usual in case of an error.</P>
<H4><A NAME="try_clean"> </A>4.83.2.4. <A NAME="try_clean">clean</A></H4>
<P>Setting '<TT>clean=1</TT>' will cause the <TT>try</TT> block to suppress its output only if it has an error. Otherwise (<TT>clean=0</TT> or not set), the <TT>try</TT> block will return whatever partial output it has completed before the error.  The <A HREF="#catch">catch</A> block will work as usual.</P>
<H2><A NAME="update">4.84. update</A></H2>
<P>Forces an update of the specified interchange function. Function may be one of the following:</P>
<UL>
<LI><B>cart</B> (updates current or named cart)
<LI><B>process</B> (updates order or search)
<LI><B>values</B> (updates user-entered fields)
<LI><B>data</B> (updates database, using current <B>mv_</B> CGI form variables)</UL>
<H3><A NAME="Summary">4.84.1. Summary</A></H3>
<PRE>
    [<B>update</B> function]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#update_function">function</A>
</TD>
<TD VALIGN='Top'>
<UL>
<LI>cart<UL>
<LI>Updates current or named cart (see <TT>name</TT> attribute)</UL>
<LI>process<UL>
<LI>Updates an order or a search page</UL>
<LI>values<UL>
<LI>Updates user-entered fields</UL>
<LI>data<UL>
<LI>Updates database, using current <B>mv_</B> CGI form variables, for example:<UL>
<LI><B>mv_data_table</B> Table to update
<LI><B>mv_data_key</B> Key into table
<LI><B>mv_data_fields</B> Fields to update (space or null delimited)
<LI><B>mv_data_function</B> One of the following:<UL>
<LI>delete
<LI>update
<LI>insert
<LI>delete</UL>
<LI>etc.</UL></UL></UL>
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#update_name">name</A>
</TD>
<TD VALIGN='Top'>
Cart name to update (if 'function=cart')
<UL>
<LI>Default: current cart</UL>
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>YES</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [update function]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;update(  { function =&gt; VALUE_function
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;update(function, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.84.2. Description</A></H3>
<P>Forces an update of the specified interchange function. Function may be one of the following:</P>
<UL>
<LI><B>cart</B> (updates current or named cart)
<LI><B>process</B> (updates order or search)
<LI><B>values</B> (updates user-entered fields)
<LI><B>data</B> (updates database, using current <B>mv_</B> CGI form variables)</UL>
<H4><A NAME="update_function"> </A>4.84.2.1. <A NAME="update_function">function</A></H4>
<UL>
<LI>cart<UL>
<LI>Updates current or named cart (see <TT>name</TT> attribute)</UL>
<LI>process<UL>
<LI>Updates an order or a search page</UL>
<LI>values<UL>
<LI>Updates user-entered fields</UL>
<LI>data<UL>
<LI>Updates database, using current <B>mv_</B> CGI form variables, for example:<UL>
<LI><B>mv_data_table</B> Table to update
<LI><B>mv_data_key</B> Key into table
<LI><B>mv_data_fields</B> Fields to update (space or null delimited)
<LI><B>mv_data_function</B> One of the following:<UL>
<LI>delete
<LI>update
<LI>insert
<LI>delete</UL>
<LI>etc.</UL></UL></UL>
<H4><A NAME="update_name"> </A>4.84.2.2. <A NAME="update_name">name</A></H4>
<P>Cart name to update (if 'function=cart')</P>
<UL>
<LI>Default: current cart</UL>
<H2><A NAME="userdb">4.85. userdb</A></H2>
<H3><A NAME="Summary">4.85.1. Summary</A></H3>
<P>Parameters: <B>function</B></P>
<P>Positional parameters in same order.</P>
<P><B>The attribute hash reference is passed</B> to the subroutine after the parameters as the last argument. <B>This may mean that there are parameters not shown here.</B></P>
<P>Invalidates cache: <B>YES</B></P>
<P>Attribute aliases</P>
<PRE>
            name ==&gt; nickname
            table ==&gt; db
    [<B>userdb</B> function <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#userdb_function">function</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#userdb_nickname">name</A>
</TD>
<TD VALIGN='Top'>
Alias for nickname
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#userdb_db">table</A>
</TD>
<TD VALIGN='Top'>
Alias for db
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>YES</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [userdb function]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;userdb({
       function =&gt; VALUE
   });
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;userdb(function, $attribute_hash_reference);
</PRE>
<H3><A NAME="Description">4.85.2. Description</A></H3>
<P>Interchange provides a <TT>[userdb ...]</TT> tag to access the UserDB functions.</P>
<PRE>
    [userdb
        function=function_name
        username=&quot;username&quot;*
        password=&quot;password&quot;*
        verify=&quot;password&quot;*
        oldpass=&quot;old password&quot;*
        shipping=&quot;fields for shipping save&quot;
        billing=&quot;fields for billing save&quot;
        preferences=&quot;fields for preferences save&quot;
        force_lower=1
        param1=value*
        param2=value*
        hide=1
        show=1
        ...
    ]
</PRE>
<P>* Optional</P>
<P>It is normally called in an <TT>mv_click</TT> or <TT>mv_check</TT> setting, as in:</P>
<PRE>
    [set Login]
    mv_todo=return
    mv_nextpage=welcome
    [userdb function=login]
    [/set]

    &lt;FORM ACTION=&quot;[process]&quot; METHOD=POST&gt;
    &lt;INPUT TYPE=hidden NAME=mv_click VALUE=Login&gt;
    Username &lt;INPUT NAME=mv_username SIZE=10&gt;
    Password &lt;INPUT NAME=mv_password SIZE=10&gt;
    &lt;/FORM&gt;
</PRE>
<P>There are several global parameters that apply to any use of the <TT>userdb</TT> functions. Most importantly, by default the database table is set to be <I>userdb</I>. If you must use another table name, then you should include a <TT>database=table</TT> parameter with any call to <TT>userdb</TT>. The global parameters (default in parentheses):</P>
<PRE>
    database     Sets user database table (userdb)
    hide         Hide the return value of certain functions
                 (including login, new_account, save, load)
    show         Show the return value of certain functions
                 or the error message, if any (0)
    force_lower  Force possibly upper-case database fields
                 to lower case session variable names (0)
    billing      Set the billing fields (see Accounts)
    shipping     Set the shipping fields (see Address Book)
    preferences  Set the preferences fields (see Preferences)
    bill_field   Set field name for accounts (accounts)
    addr_field   Set field name for address book (address_book)
    pref_field   Set field name for preferences (preferences)
    cart_field   Set field name for cart storage (carts)
    pass_field   Set field name for password (password)
    time_field   Set field for storing last login time (time)
    expire_field Set field for expiration date (expire_date)
    acl          Set field for simple access control storage (acl)
    file_acl     Set field for file access control storage (file_acl)
    db_acl       Set field for database access control storage (db_acl)
</PRE>
<H4><A NAME="userdb_function"> </A>4.85.2.1. <A NAME="userdb_function">function</A></H4>
<H4><A NAME="userdb_nickname"> </A>4.85.2.2. <A NAME="userdb_nickname">name</A></H4>
<H4><A NAME="userdb_db"> </A>4.85.2.3. <A NAME="userdb_db">table</A></H4>
<H2><A NAME="value">4.86. value</A></H2>
<P>Returns the the current value of the named form input field. HTML-escapes Interchange tags in the result for security.</P>
<P>Can also set a new value within the current page.</P>
<H3><A NAME="Summary">4.86.1. Summary</A></H3>
<PRE>
    [<B>value</B> name]
    [<B>value</B> name=<I>form_var_name</I> <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#value_name">name</A>
</TD>
<TD VALIGN='Top'>
This is the name of the form variable whose value you want.
</TD>
<TD VALIGN='Top'>
<I>None</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#value_set">set</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#value_hide">hide</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#value_filter">filter</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#value_keep">keep</A> (with filter)
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#value_scratch">scratch</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#value_default">default</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#value_enable_html">enable_html</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<P>Assuming form variable 'foo' = 'bar',</P>
<PRE>
    [value foo]
---
    bar
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;value( { name =&gt; var_name } );

    <I># or if you simply want the value:</I>
    $Values-&gt;{var_name};
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;value($name, $attribute_hash_reference);
</PRE>
<H3><A NAME="Description">4.86.2. Description</A></H3>
<P>Usage example:</P>
<PRE>
   &lt;INPUT TYPE=&quot;text&quot; NAME=&quot;name&quot; VALUE=&quot;[value name]&quot;&gt;
   &lt;INPUT TYPE=&quot;text&quot; NAME=&quot;name&quot; VALUE=&quot;[value name=name]&quot;&gt;
</PRE>
<P>Expands into the current value of the <A HREF="#value_name">named</A> customer/form input field. When the value is returned, any Interchange tags present in the value will be escaped. This prevents users from entering Interchange tags in form values, which would be a serious security risk.</P>
<H4><A NAME="value_name"> </A>4.86.2.1. <A NAME="value_name">name</A></H4>
<P>This is the name of the form variable whose value you want.</P>
<H4><A NAME="value_set"> </A>4.86.2.2. <A NAME="value_set">set</A></H4>
<P>You can change a value with '<TT>set</TT>=<I>new_value</I>'. The tag will return the value you set unless you also set the <A HREF="#value_hide">hide</A>=1 attribute.</P>
<P>Use this to &quot;uncheck&quot; a checkbox or set other form variable values to defaults. If you simply want a place to store your own data, use the <A HREF="#set">set</A> and <A HREF="#scratch">scratch</A> tags instead.</P>
<P>Note that this is only available in new-style tags, for safety reasons.</P>
<H4><A NAME="value_hide"> </A>4.86.2.3. <A NAME="value_hide">hide</A></H4>
<P>Setting <TT>hide</TT>=1 suppresses the tag's return value, which can be useful with the <A HREF="#value_set">set</A> attribute.</P>
<H4><A NAME="value_filter"> </A>4.86.2.4. <A NAME="value_filter">filter</A></H4>
<P>See the <A HREF="#filter">filter</A> tag for a list of filters.</P>
<P>Setting '<TT>filter</TT>=&quot;<I>filter</I>&quot;' modifies the named value with the specified filter.</P>
<H4><A NAME="value_keep (with filter)"> </A>4.86.2.5. <A NAME="value_keep">keep</A> (with filter)</H4>
<P>Set <TT>keep</TT>=1 if you want the tag to return a filtered result but do not want the filter to modify the form value itself in the $::Values hash.</P>
<H4><A NAME="value_scratch"> </A>4.86.2.6. <A NAME="value_scratch">scratch</A></H4>
<P>Setting '<TT>scratch</TT>=1' places a copy of the value in the $::Scratch hash. An illustrative example:</P>
<PRE>
   foo is [value name=foo scratch=1] in the Values hash
   foo is now also [scratch foo] in the Scratch hash
</PRE>
<H4><A NAME="value_default"> </A>4.86.2.7. <A NAME="value_default">default</A></H4>
<P>This sets a return value in case the named value is missing or otherwise false. The following will expand to &quot;Using default&quot;:</P>
<PRE>
    [value name=myname set=0 hide=1]
    [value name=myname default=&quot;Using default&quot;]
</PRE>
<H4><A NAME="value_enable_html"> </A>4.86.2.8. <A NAME="value_enable_html">enable_html</A></H4>
<P>Any '&lt;' characters will normally be converted into '&amp;lt;' for safety reasons. This conversion can be disabled using '<TT>enable_html</TT>=1'.</P>
<H2><A NAME="value-extended">4.87. value-extended</A></H2>
<H3><A NAME="Summary">4.87.1. Summary</A></H3>
<P>Parameters: <B>name</B></P>
<P>Positional parameters in same order.</P>
<P><B>The attribute hash reference is passed</B> to the subroutine after the parameters as the last argument. <B>This may mean that there are parameters not shown here.</B></P>
<P>Must pass named parameter interpolate=1 to cause interpolation.</P>
<P>Invalidates cache: <B>YES</B></P>
<P>Called Routine:</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;value_extended(
        {
         name =&gt; VALUE,
        }
    )

 OR

    $Tag-&gt;value_extended($name, $ATTRHASH);
    [value-extended name <I>other_named_attributes</I>]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#value_extended_name">name</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
DEFAULT_VALUE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#value_extended_umask">umask</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#attr_interpolate">interpolate (reparse)</A>
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Invalidates cache
</TD>
<TD VALIGN='Top'>
<I>YES</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Container tag
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Has Subtags
</TD>
<TD VALIGN='Top'>
<I>No</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
Nests
</TD>
<TD VALIGN='Top'>
<I>Yes</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [value-extended name]
---
    TODO: (tag result)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
   $Tag-&gt;value_extended(  { name =&gt; VALUE_name
}, $body  );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;value_extended(name, $attribute_hash_reference, $body);
</PRE>
<H3><A NAME="Description">4.87.2. Description</A></H3>
<P>Named call example:</P>
<PRE>
   [value-extended
            name=formfield
            outfile=filename*
            umask=octal*
            ascii=1*
            yes=&quot;Yes&quot;*
            no=&quot;No&quot;*
            joiner=&quot;char|string&quot;*
            test=&quot;isfile|length|defined&quot;*
            index=&quot;N|N..N|*&quot;
            file_contents=1*
            elements=1*
   ]
</PRE>
<P>Expands into the current value of the customer/form input field named by field. If there are multiple elements of that variable, it will return the value at <TT>index</TT>; by default all joined together with a space.</P>
<P>If the variable is a file variable coming from a multipart/form-data file upload, then the contents of that upload can be returned to the page or optionally written to the <TT>outfile</TT>.</P>
<H4><A NAME="tree_name"> </A>4.87.2.1. <A NAME="tree_name">name</A></H4>
<P>The form variable NAME. If no other parameters are present, then the value of the variable will be returned. If there are multiple elements, then by default they will all be returned joined by a space. If <TT>joiner</TT> is present, then they will be joined by its value.</P>
<P>In the special case of a file upload, the value returned is the name of the file as passed for upload.</P>
<H4><A NAME="tree_joiner"> </A>4.87.2.2. <A NAME="tree_joiner">joiner</A></H4>
<P>The character or string that will join the elements of the array. Will accept string literals such as &quot;\n&quot; or &quot;\r&quot;.</P>
<H4><A NAME="tree_test"> </A>4.87.2.3. <A NAME="tree_test">test</A></H4>
<P>Three tests&nbsp;-- <TT>isfile</TT> returns true if the variable is a file upload. <TT>length</TT> returns the length. <TT>defined</TT> returns whether the value has ever been set at all on a form.</P>
<H4><A NAME="tree_index"> </A>4.87.2.4. <A NAME="tree_index">index</A></H4>
<P>The index of the element to return if not all are wanted. This is useful especially for pre-setting multiple search variables. If set to <TT>*</TT>, will return all (joined by <TT>joiner</TT>). If a range, such as <TT>0 .. 2</TT>, will return multiple elements.</P>
<H4><A NAME="tree_file_contents"> </A>4.87.2.5. <A NAME="tree_file_contents">file_contents</A></H4>
<P>Returns the contents of a file upload if set to a non-blank, non-zero value. If the variable is not a file, returns nothing.</P>
<H4><A NAME="tree_outfile"> </A>4.87.2.6. <A NAME="tree_outfile">outfile</A></H4>
<P>Names a file to write the contents of a file upload to. It will not accept an absolute file name; the name must be relative to the catalog directory. If you wish to write images or other files that would go to HTML space, you must use the HTTP server's <TT>Alias</TT> facilities or make a symbolic link.</P>
<H4><A NAME="tree_outfile"> </A>4.87.2.7. <A NAME="tree_outfile">umask</A></H4>
<P>Permission mask (in octal) to apply to the uploaded file's permission bits. You may want to set this to make a file world-readable, or to keep it from being group-readable. See the UNIX chmod(1) manpage for details.</P>
<H4><A NAME="tree_ascii"> </A>4.87.2.8. <A NAME="tree_ascii">ascii</A></H4>
<P>To do an auto-ASCII translation before writing the <TT>outfile</TT>, set the <TT>ascii</TT> parameter to a non-blank, non-zero value. Default is no translation.</P>
<H4><A NAME="tree_yes"> </A>4.87.2.9. <A NAME="tree_yes">yes</A></H4>
<P>The value that will be returned if a test is true or a file is written successfully. Defaults to <TT>1</TT> for tests and the empty string for uploads.</P>
<H4><A NAME="tree_no"> </A>4.87.2.10. <A NAME="tree_no">no</A></H4>
<P>The value that will be returned if a test is false or a file write fails. Defaults to the empty string.</P>
<H4><A NAME="value_extended_umask"> </A>4.87.2.11. <A NAME="value_extended_umask">umask</A></H4>
<H4><A NAME="value_extended_name"> </A>4.87.2.12. <A NAME="value_extended_name">name</A></H4>
<HR>
<H1><A NAME="User-defined Tags">5. User-defined Tags</A></H1>
<P>To define a tag that is catalog-specific, place <I>UserTag</I> directives in your catalog.cfg file. For server-wide tags, define them in interchange.cfg. Catalog-specific tags take precedence if both are defined&nbsp;-- in fact, you can override the base Interchange tag set with them. The directive takes the form:</P>
<PRE>
   UserTag  tagname  property  value
</PRE>
<P>where <TT>tagname</TT> is the name of the tag, <TT>property</TT> is the attribute (described below), and <TT>value</TT> is the value of the property for that tagname.</P>
<P>The user tags can either be based on Perl subroutines or just be aliases for existing tags. Some quick examples are below.</P>
<P>An alias:</P>
<PRE>
    UserTag product_name Alias     data products title
</PRE>
<P>This will change [product_name 99-102] into [data products title 99-102], which will output the <TT>title</TT> database field for product code <TT>99-102</TT>. Don't use this with <TT>[item-data ...]</TT> and <TT>[item-field ...]</TT>, as they are parsed separately. You can do <TT>[product-name [item-code]]</TT>, though.</P>
<P>A simple subroutine:</P>
<PRE>
    UserTag company_name Routine   sub { &quot;Your company name&quot; }
</PRE>
<P>When you place a [company-name] tag in an Interchange page, the text <TT>Your company name</TT> will be substituted.</P>
<P>A subroutine with a passed text as an argument:</P>
<PRE>
    UserTag caps   Routine   sub { return &quot;\U@_&quot; }
    UserTag caps   HasEndTag
</PRE>
<P>The tag [caps]This text should be all upper case[/caps] will become <TT>THIS TEXT SHOULD BE ALL UPPER CASE</TT>.</P>
<P>Here is a useful one you might wish to use:</P>
<PRE>
    UserTag quick_table HasEndTag
    UserTag quick_table Interpolate
    UserTag quick_table Order   border
    UserTag quick_table Routine &lt;&lt;EOF
    sub {
        my ($border,$input) = @_;
        $border = &quot; BORDER=$border&quot; if $border;
        my $out = &quot;&lt;TABLE ALIGN=LEFT$border&gt;&quot;;
        my @rows = split /\n+/, $input;
        my ($left, $right);
        for(@rows) {
            $out .= '&lt;TR&gt;&lt;TD ALIGN=RIGHT VALIGN=TOP&gt;';
            ($left, $right) = split /\s*:\s*/, $_, 2;
            $out .= '&lt;B&gt;' unless $left =~ /&lt;/;
            $out .= $left;
            $out .= '&lt;/B&gt;' unless $left =~ /&lt;/;
            $out .= '&lt;/TD&gt;&lt;TD VALIGN=TOP&gt;';
            $out .= $right;
            $out .= '&lt;/TD&gt;&lt;/TR&gt;';
            $out .= &quot;\n&quot;;
        }
        $out .= '&lt;/TABLE&gt;';
    }
    EOF
</PRE>
<P>Called with:</P>
<PRE>
    [quick-table border=2]
    Name: [value name]
    City: [value city][if value state], [value state][/if] [value country]
    [/quick_table]
</PRE>
<P>As is the case with [<A HREF="#perl">perl</A>] tag, user tags run under the Perl <A HREF="http://www.perl.com/pub/doc/manual/html/lib/Safe.html">Safe.pm</A> module with warnings disabled. Unlike [<A HREF="#perl">perl</A>] tags, however, user tags use Perl's '<TT>strict</TT>' pragma.</P>
<P>The properties for UserTag are:</P>
<H2><A NAME="Alias">5.1. Alias</A></H2>
<P>An alias for an existing (or other user-defined) tag. It takes the form:</P>
<PRE>
    UserTag tagname Alias    tag to insert
</PRE>
<P>An Alias is the only property that does not require a <I>Routine</I> to process the tag.</P>
<H2><A NAME="attrAlias">5.2. attrAlias</A></H2>
<P>An alias for an existing attribute for defined tag. It takes the form:</P>
<PRE>
    UserTag tagname attrAlias   alias attr
</PRE>
<P>As an example, the standard Interchange <TT>value</TT> tag takes a named attribute of <TT>name</TT> for the variable name, meaning that [<A HREF="#value">value</A> name=var] will display the value of form field <TT>var</TT>. If you put this line in catalog.cfg:</P>
<PRE>
    UserTag value attrAlias   identifier name
</PRE>
<P>then [<A HREF="#value">value</A> identifier=var] will be an equivalent tag.</P>
<H2><A NAME="CanNest">5.3. CanNest</A></H2>
<P>Notifies Interchange that this tag must be checked for nesting. Only applies to tags that have <I>HasEndTag</I> defined, of course. NOTE: Your routine must handle the subtleties of nesting, so don't use this unless you are quite conversant with parsing routines. See the routines <TT>tag_loop_list</TT> and <TT>tag_if</TT> in lib/Vend/Interpolate.pm for an example of a nesting tag.</P>
<PRE>
    UserTag tagname CanNest
</PRE>
<H2><A NAME="HasEndTag">5.4. HasEndTag</A></H2>
<P>Defines an ending [/tag] to encapsulate your text&nbsp;-- the text in between the beginning <TT>[tagname]</TT> and ending <TT>[/tagname]</TT> will be the last argument sent to the defined subroutine.</P>
<PRE>
    UserTag tagname HasEndTag
</PRE>
<H2><A NAME="Implicit">5.5. Implicit</A></H2>
<P>This defines a tag as implicit, meaning it can just be an <TT>attribute</TT> instead of an <TT>attribute=value</TT> pair. It must be a recognized attribute in the tag definition, or there will be big problems. Use this with caution!</P>
<PRE>
    UserTag tagname Implicit attribute value
</PRE>
<P>If you want to set a standard include file to a fixed value by default, but don't want to have to specify [<A HREF="#include">include</A> file=&quot;/long/path/to/file&quot;] every time, you can just put:</P>
<PRE>
    UserTag include Implicit file file=/long/path/to/file
</PRE>
<P>and [<A HREF="#include">include</A> file] will be the equivalent. You can still specify another value with [<A HREF="#include">include</A> file=&quot;/another/path/to/file&quot;].</P>
<H2><A NAME="Interpolate">5.6. Interpolate</A></H2>
<P>The behavior for this attribute depends on whether the tag is a container (i.e. <TT>HasEndTag</TT> is defined). If it is not a container, the <TT>Interpolate</TT> attribute causes the <B>the resulting HTML</B> from the <TT>UserTag</TT> to be re-parsed for more Interchange tags. If it is a container, <TT>Interpolate</TT> causes the contents of the tag to be parsed <B>before</B> the tag routine is run.</P>
<PRE>
    UserTag tagname Interpolate
</PRE>
<H2><A NAME="InvalidateCache">5.7. InvalidateCache</A></H2>
<P>If this is defined, the presence of the tag on a page will prevent search cache, page cache, and static builds from operating on the page.</P>
<PRE>
    UserTag tagname InvalidateCache
</PRE>
<P>It does not override [tag flag build][/tag], though.</P>
<H2><A NAME="Order">5.8. Order</A></H2>
<P>The optional arguments that can be sent to the tag. This defines not only the order in which they will be passed to <I>Routine</I>, but the name of the tags. If encapsulated text is appropriate (<I>HasEndTag</I> is set), it will be the last argument.</P>
<PRE>
    UserTag tagname Order param1 param2
</PRE>
<H2><A NAME="PosRoutine">5.9. PosRoutine</A></H2>
<P>Identical to the Routine argument&nbsp;-- a subroutine that will be called when the new syntax is not used for the call, i.e. <TT>[usertag argument]</TT> instead of <TT>[usertag ARG=argument]</TT>. If not defined, <I>Routine</I> is used, and Interchange will usually do the right thing.</P>
<H2><A NAME="Routine">5.10. Routine</A></H2>
<P>An inline subroutine that will be used to process the arguments of the tag. It must not be named, and will be allowed to access unsafe elements only if the <TT>interchange.cfg</TT> parameter <I>AllowGlobal</I> is set for the catalog.</P>
<PRE>
    UserTag tagname Routine  sub { &quot;your perl code here!&quot; }
</PRE>
<P>The routine may use a &quot;here&quot; document for readability:</P>
<PRE>
    UserTag tagname Routine &lt;&lt;EOF
    sub {
        my ($param1, $param2, $text) = @_;
        return &quot;Parameter 1 is $param1, Parameter 2 is $param2&quot;;
    }
    EOF
</PRE>
<P>The usual <I>here documents</I> caveats apply.</P>
<P>Parameters defined with the <I>Order</I> property will be sent to the routine first, followed by any encapsulated text (<I>HasEndTag</I> is set).</P>
<P>Note that the UserTag facility, combined with AllowGlobal, allows the user to define tags just as powerful as the standard Interchange tags. This is not recommended for the novice, though&nbsp;-- keep it simple. 8-)</P>
<HR>
<H1><A NAME="Standard Usertags">6. Standard Usertags</A></H1>
<P>The distribution includes a number of prebuilt usertags in the <TT>usertag</TT> directory in the Interchange software directory. Some of these are used by the foundation catalog or its administrative interface.</P>
<H2><A NAME="bar_button">6.1. bar_button</A></H2>
<P>Displays content based on current page. Could be used for building e.g. menu bars.</P>
<H3><A NAME="Summary">6.1.1. Summary</A></H3>
<PRE>
    [<B>bar-button</B> page current]...[selected]...[/selected][/bar-button]
    [<B>bar-button</B> page=page current=current-page]...[selected]...[/selected][/bar-button]
</PRE>
<P><HR WIDTH="80%" ALIGN="Left">
<STRONG>Positional parameters: </STRONG>The first line shows the usage with positional parameters (given in order). The second line shows usage with named parameters.</P>
<P><HR WIDTH="80%" ALIGN="Left"></P>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#bar_button_page">page</A>
</TD>
<TD VALIGN='Top'>
Name of page for which this bar-button is defined
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#bar_button_current">current</A>
</TD>
<TD VALIGN='Top'>
Name of the current page
</TD>
<TD VALIGN='Top'>
Current page: MV_PAGE
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD>
Invalidates cache
</TD>
<TD>
<I>No</I>
</TD>
</TR>
<TR>
<TD>
Macro
</TD>
<TD>
<I>No</I>
</TD>
</TR>
<TR>
<TD>
Has end tag
</TD>
<TD>
[/bar-button]
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<P>To build a simple '3-button' menu bar one could put the following on each of the pages. The results of this code for page2 are shown below.</P>
<PRE>
        &lt;table&gt;&lt;tr&gt;
        [bar-button page=page1]
        &lt;TD&gt;&lt;A HREF=&quot;[area page1]&quot;&gt;PAGE-1&lt;/A&gt;&lt;/TD&gt;
        [selected]
        &lt;TD bgcolor=&quot;red&quot;&gt;&lt;A HREF=&quot;[area page1]&quot;&gt;&lt;B&gt;PAGE-1-selected&lt;/B&gt;&lt;/A&gt;&lt;/TD&gt;
        [/selected]
        [/bar-button]
        [bar-button page=page2]
        &lt;TD&gt;&lt;A HREF=&quot;[area page2]&quot;&gt;PAGE-2&lt;/A&gt;&lt;/TD&gt;
        [selected]
        &lt;TD bgcolor=&quot;red&quot;&gt;&lt;A HREF=&quot;[area page2]&quot;&gt;&lt;B&gt;PAGE-2-selected&lt;/B&gt;&lt;/A&gt;&lt;/TD&gt;
        [/selected]
        [/bar-button]
        [bar-button page=page3]
        &lt;TD&gt;&lt;A HREF=&quot;[area page3]&quot;&gt;PAGE-3&lt;/A&gt;&lt;/TD&gt;
        [selected]
        &lt;TD bgcolor=&quot;red&quot;&gt;&lt;A HREF=&quot;[area page3]&quot;&gt;&lt;B&gt;PAGE-3-selected&lt;/B&gt;&lt;/A&gt;&lt;/TD&gt;
        [/selected]
        [/bar-button]
        &lt;/tr&gt;&lt;/table&gt;
---
        PAGE-1    PAGE-2-selected    PAGE-3
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;button_bar(  { page =&gt; $page,
                     current  =&gt; $current,
                         body =&gt; $body}  );
</PRE>
<P>or similarly,</P>
<PRE>
    $Tag-&gt;area($page, $current, $body);
</PRE>
<H4><A NAME="See Also">6.1.1.1. See Also</A></H4>
<P>bar_link routine</P>
<H3><A NAME="Description">6.1.2. Description</A></H3>
<P>Displays content based on current page. The content between the [selected][/selected] tags will be displayed only if the name of the current page matches the name that was passed to the page parameter (page=page-name). The default content will be displayed when there is no match.</P>
<H4><A NAME="bar_button_page"> </A>6.1.2.1. <A NAME="bar_button_page">page</A></H4>
<P>The name of the page for which this definition of the bar-button is defined.</P>
<H4><A NAME="bar_button_current"> </A>6.1.2.2. <A NAME="bar_button_current">current</A></H4>
<P>The name of the current page. Defaults to current page MV_PAGE.</P>
<H2><A NAME="button">6.2. button</A></H2>
<H2><A NAME="convert_date">6.3. convert_date</A></H2>
<P>This tag converts a given date format into another format.</P>
<H3><A NAME="Summary">6.3.1. Summary</A></H3>
<PRE>
    [<B>convert_date</B> day* <I>other_named_attributes</I>[/convert_date]
    [<B>convert_date</B> day=n* <I>other_named_attributes</I>[/convert_date]
</PRE>
<P><HR WIDTH="80%" ALIGN="Left">
<STRONG>Positional parameters: </STRONG>The first line shows the usage with positional parameters (given in order). The second line shows usage with named parameters.</P>
<P><HR WIDTH="80%" ALIGN="Left"></P>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
days
</TD>
<TD VALIGN='Top'>
The number of days from or before today
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#convert_date_format">format</A>
</TD>
<TD VALIGN='Top'>
'%d-%b-%Y %I:%M%p' or '%d-%b-%Y'
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
fmt - Alias for format
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#convert_date_raw">raw</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#convert_date_zerofix">zerofix</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD>
Invalidates cache
</TD>
<TD>
<I>No</I>
</TD>
</TR>
<TR>
<TD>
Macro
</TD>
<TD>
<I>No</I>
</TD>
</TR>
<TR>
<TD>
Has end tag
</TD>
<TD>
[/convert_date]
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
  a. [convert-date][/convert-date]
  b. [convert-date 1][/convert-date]
  c. [convert-date -1][/convert-date]
  d. [convert-date]2001-5-1[/convert-date]
  e. [convert-date]2001-05-01[/convert-date]
  f. [convert-date]20010515[/convert-date]
  g. [convert-date raw=1]2001-05-18[/convert-date]
  h. [convert-date fmt=&quot;%d-%m-%Y&quot;]2001-05-18[/convert-date]
  i. [convert-date]200 1 -  --051 =9[/convert-date]
  j. [convert-date]2001 -  --05 -20 11 1 5[/convert-date]
  k. [convert-date raw=1]2001-05-21 11:15[/convert-date]
---
  a. 18-May-2001 03:15AM (todays day and time)
  b. 19-May-2001 03:15AM (today + 1 day)
  c. 17-May-2001 03:15AM (today - 1 day)
  d. 01-May-2001
  e. 01-May-2001
  f. 15-May-2001
  g. 20010518
  h. 18-05-2001
  i. 19-May-2001
  j. 20-May-2001 11:15AM
  k. 200105211115
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;convert_date( { days =&gt; 1 } );

    $Tag-&gt;convert_date( { body =&gt; <TT>&quot;2001-05-19 15:35&quot;</TT>,
                       <B>format</B> =&gt; <TT>&quot;%d-%m-%Y %H:%M&quot;</TT>, } );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;convert_date( 1 );
</PRE>
<H3><A NAME="Description">6.3.2. Description</A></H3>
<P>This tag converts almost any given date format into another, possibly user defined, format.</P>
<H4><A NAME="convert_date_days"> </A>6.3.2.1. <A NAME="convert_date_days">days</A></H4>
<P>Number of days from or before today's date and time. Will only be used if nothing is supplied between the tags.</P>
<H4><A NAME="convert_date_format"> </A>6.3.2.2. <A NAME="convert_date_format">format</A></H4>
<P>POSIX time format string of your choice. See Unix strftime(3) manpage for complete details.</P>
<H4><A NAME="convert_date_raw"> </A>6.3.2.3. <A NAME="convert_date_raw">raw</A></H4>
<P>If this option is set to true, will display given date in raw format, e.g. yyyymmdd or yyyymmddHHMM.</P>
<H4><A NAME="convert_date_zerofix"> </A>6.3.2.4. <A NAME="convert_date_zerofix">zerofix</A></H4>
<P>Strips leading zeroes from numbers.</P>
<H2><A NAME="db_date">6.4. db_date</A></H2>
<P>This tag returns the time of last access of the database source file.</P>
<H3><A NAME="Summary">6.4.1. Summary</A></H3>
<PRE>
    [<B>db_date</B> table* format*]
</PRE>
<P><HR WIDTH="80%" ALIGN="Left">
<STRONG>Positional parameters: </STRONG>The first line shows the usage with positional parameters (given in order). The second line shows usage with named parameters.</P>
<P><HR WIDTH="80%" ALIGN="Left"></P>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#db_date_table">table</A>
</TD>
<TD VALIGN='Top'>
Table name.
</TD>
<TD VALIGN='Top'>
products
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#db_date_format">format</A>
</TD>
<TD VALIGN='Top'>
POSIX time format string
</TD>
<TD VALIGN='Top'>
%A %d %b %Y
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD>
Invalidates cache
</TD>
<TD>
<I>No</I>
</TD>
</TR>
<TR>
<TD>
Macro
</TD>
<TD>
<I>No</I>
</TD>
</TR>
<TR>
<TD>
Has end tag
</TD>
<TD>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [db-date]
    [db-date cat]
    [db-date table=cat format=&quot;%d %b %Y&quot;]
---
    Wednesday 02 May 2001 (products.txt)
    Wednesday 03 May 2001 (cat.txt)
    03 May 2001 (cat.txt)
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;db_date( { table =&gt; cat,
                    <B>format</B> =&gt; <TT>&quot;%d %b %Y&quot;</TT>, } );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;db_date( <TT>&quot;cat&quot;</TT>, <TT>&quot;%d %b %Y&quot;</TT> );
</PRE>
<H3><A NAME="Description">6.4.2. Description</A></H3>
<P>This tag returns the time of last access of the database source file.</P>
<H4><A NAME="db_date_table"> </A>6.4.2.1. <A NAME="db_date_table">table</A></H4>
<P>Table name. Defaults to products if not specified.</P>
<H4><A NAME="db_date_format"> </A>6.4.2.2. <A NAME="db_date_format">format</A></H4>
<P>POSIX time format string. See Unix strftime(3) manpage for details. Defaults to '%A %d %b %Y' when not specified.</P>
<H2><A NAME="delete_cart">6.5. delete_cart</A></H2>
<P>This tag deletes a cart from the userdb.</P>
<H3><A NAME="Summary">6.5.1. Summary</A></H3>
<PRE>
    [<B>delete_cart</B> nickname]
    [<B>delete_cart</B> nickname=&quot;cart-name&quot;]
</PRE>
<P><HR WIDTH="80%" ALIGN="Left">
<STRONG>Positional parameters: </STRONG>The first line shows the usage with positional parameters (given in order). The second line shows usage with named parameters.</P>
<P><HR WIDTH="80%" ALIGN="Left"></P>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#delete_cart_nickname">nickname</A>
</TD>
<TD VALIGN='Top'>
Must be an existing nickname
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD>
Invalidates cache
</TD>
<TD>
<I>No</I>
</TD>
</TR>
<TR>
<TD>
Macro
</TD>
<TD>
<I>No</I>
</TD>
</TR>
<TR>
<TD>
Has end tag
</TD>
<TD>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [delete_cart mycart]
    [delete_cart nickname=&quot;mycart&quot;]
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;delete_cart( { nickname =&gt; <TT>&quot;mycart&quot;</TT>, } );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;delete_cart( <TT>&quot;mycart&quot;</TT> );
</PRE>
<H4><A NAME="See Also">6.5.1.1. See Also</A></H4>
<P><A HREF="#userdb">userdb</A>, <A HREF="#load_cart">load_cart</A>, <A HREF="#save_cart">save_cart</A> and pages templates/components/saved_carts_list_small, pages/saved_carts.html for more examples.</P>
<H3><A NAME="Description">6.5.2. Description</A></H3>
<P>Deletes a cart with name nickname from the user database. Basically the same as [userdb function=delete_cart nickname=mycart].</P>
<H4><A NAME="delete_cart_nickname"> </A>6.5.2.1. <A NAME="delete_cart_nickname">nickname</A></H4>
<P>Nickname of cart to be deleted.</P>
<H2><A NAME="email">6.6. email</A></H2>
<P>This tag takes a recipient address and a body text and uses the SendmailProgram with -t option to send email.</P>
<H3><A NAME="Summary">6.6.1. Summary</A></H3>
<PRE>
    [<B>email</B> to subject* reply* from* extra*]Your message[/email]
    [<B>email</B> to=to_address subject=subject reply=reply_address
        from=from_address extra=extra_headers]Your message[/email]
</PRE>
<P><HR WIDTH="80%" ALIGN="Left">
<STRONG>Positional parameters: </STRONG>The first line shows the usage with positional parameters (given in order). The second line shows usage with named parameters.</P>
<P><HR WIDTH="80%" ALIGN="Left"></P>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
to
</TD>
<TD VALIGN='Top'>
Email address of recipient
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
subject
</TD>
<TD VALIGN='Top'>
Subject line
</TD>
<TD VALIGN='Top'>
String: &lt;no subject&gt;
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
reply
</TD>
<TD VALIGN='Top'>
Email address to be used for the reply-to header
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
from
</TD>
<TD VALIGN='Top'>
Senders email address
</TD>
<TD VALIGN='Top'>
First address in MailOrderTo configuration variable
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
extra
</TD>
<TD VALIGN='Top'>
Additional headers to be included
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD>
Invalidates cache
</TD>
<TD>
<I>No</I>
</TD>
</TR>
<TR>
<TD>
Macro
</TD>
<TD>
<I>No</I>
</TD>
</TR>
<TR>
<TD>
Has end tag
</TD>
<TD>
[/email]
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [email
           to=&quot;foo@bar.com&quot;
      subject=&quot;Greetings&quot;
         from=&quot;bar@foo.com&quot;
    ]
    Hello World
    [/email]
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;email(  { to =&gt; $to,
                  from =&gt; $from,
               subject =&gt; $subject,
                 reply =&gt; $reply,
                 extra =&gt; $extra,
                  body =&gt; $body }  );
</PRE>
<P>or similarly,</P>
<PRE>
    $Tag-&gt;email($to, $subject, $reply, $from, $extra, $body);
</PRE>
<H4><A NAME="See Also">6.6.1.1. See Also</A></H4>
<P><A HREF="#email_raw">email_raw</A> and etc/mail_receipt, pages/process_return.html, pages/stock-alert-added.html for examples.</P>
<H3><A NAME="Description">6.6.2. Description</A></H3>
<P>Will send the content between the [email][/email] tags as an email to the recipient (to) using the SendmailProgram with -t option.</P>
<H4><A NAME="extra">6.6.2.1. extra</A></H4>
<P>Extra headers to be included. Example: Errors-To: errors@yourdomain.com</P>
<H4><A NAME="from">6.6.2.2. from</A></H4>
<P>Email address identifying the sender of the message. Will use the first email address of the MailOrderTo configuration variable if it is not supplied.</P>
<H4><A NAME="reply">6.6.2.3. reply</A></H4>
<P>Email address to be used for the Reply-to header. No Reply-to header will be present if this parameter is omitted.</P>
<H4><A NAME="subject">6.6.2.4. subject</A></H4>
<P>Short text describing the content of the message. The Subject line of an email message. The string &lt;no subject&gt; will be substituted if this parameter is omitted.</P>
<H4><A NAME="to">6.6.2.5. to</A></H4>
<P>Valid email address(es) of the recipient(s). This parameter is required.</P>
<H2><A NAME="email_raw">6.7. email_raw</A></H2>
<P>This tag takes a raw email message, <B>including headers</B>, and uses the SendmailProgram with -t option.</P>
<H3><A NAME="Summary">6.7.1. Summary</A></H3>
<PRE>
    [<B>email_raw</B>]Your message including headers[/email_raw]
</PRE>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD>
Invalidates cache
</TD>
<TD>
<I>No</I>
</TD>
</TR>
<TR>
<TD>
Macro
</TD>
<TD>
<I>No</I>
</TD>
</TR>
<TR>
<TD>
Has end tag
</TD>
<TD>
[/email_raw]
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [email_raw]
From: foo@bar.com
To: bar@foo.com
Subject: baz

The text of the message.
    [/email_raw]
</PRE>
<P>The headers must be at the beginning of the line, and the header must have a valid To: or it will not be delivered.</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;email_raw(  { body =&gt; $body }  );
</PRE>
<P>or similarly,</P>
<PRE>
    $Tag-&gt;email_raw($body);
</PRE>
<H4><A NAME="See Also">6.7.1.1. See Also</A></H4>
<P><A HREF="#email">email</A></P>
<H3><A NAME="Description">6.7.2. Description</A></H3>
<P>Will send the content between the [email_raw][/email_raw] tags as a raw email message to the recipient specified in the supplied headers using the SendmailProgram with -t option.</P>
<H2><A NAME="fedex_query">6.8. fedex_query</A></H2>
<H2><A NAME="formel">6.9. formel</A></H2>
<H2><A NAME="fortune">6.10. fortune</A></H2>
<P>This tag uses the <TT>fortune(1)</TT> command to display a random saying.</P>
<PRE>
Options:

        short=yes|no* Select only short (&lt; 160 chars) fortunes
        a=1           Select from all fortunes, even potentially offensive ones.
        o=1           Select only from potentially offensive fortunes.
        raw=1         Don't do any HTML formatting

Example:

        [fortune short=yes]

</PRE>
<H2><A NAME="get-url">6.11. get-url</A></H2>
<P>Fetch a URL and return the contents.</P>
<H3><A NAME="Summary">6.11.1. Summary</A></H3>
<PRE>
    [<B>get-url</B> url]
    [<B>get-url</B> url=&quot;valid-url&quot; strip=1*]
</PRE>
<P><HR WIDTH="80%" ALIGN="Left">
<STRONG>Positional parameters: </STRONG>The first line shows the usage with positional parameters (given in order). The second line shows usage with named parameters.</P>
<P><HR WIDTH="80%" ALIGN="Left"></P>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#get_url_url">url</A>
</TD>
<TD VALIGN='Top'>
Must be a valid URL. Meaning, you have to supply the protocol.
<UL>
Example<UL>
<LI>http://demo.akopia.com/
<LI>ftp://ftp.akopia.com/</UL></UL>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#get_url_strip">strip</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD>
Invalidates cache
</TD>
<TD>
<I>No</I>
</TD>
</TR>
<TR>
<TD>
Macro
</TD>
<TD>
<I>No</I>
</TD>
</TR>
<TR>
<TD>
Has end tag
</TD>
<TD>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [get-url http://demo.akopia.com/]
    [get-url url=&quot;http://demo.akopia.com/&quot; strip=1]
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;get_url( { url =&gt; <TT>&quot;http://demo.akopia.com/&quot;</TT>, } );

    $Tag-&gt;get_url( { url =&gt; <TT>&quot;http://demo.akopia.com/&quot;</TT>,
                   strip =&gt; 1, } );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;get_url( <TT>&quot;http://demo.akopia.com/&quot;</TT> );
</PRE>
<H3><A NAME="Description">6.11.2. Description</A></H3>
<P>Uses the LWP libraries (LWP::Simple) to fetch a URL and returns the contents.</P>
<H4><A NAME="get_url_strip"> </A>6.11.2.1. <A NAME="get_url_strip">strip</A></H4>
<P>If the strip option is set, strips everything up to &lt;body&gt; and everything after &lt;/body&gt;.</P>
<H4><A NAME="get_url_url"> </A>6.11.2.2. <A NAME="get_url_url">url</A></H4>
<P>Must be a valid URL (including protocol).</P>
<H2><A NAME="load_cart">6.12. load_cart</A></H2>
<P>This tag loads a cart by name from the userdb.</P>
<H3><A NAME="Summary">6.12.1. Summary</A></H3>
<PRE>
    [<B>load_cart</B> nickname]
    [<B>load_cart</B> nickname=&quot;cart-name&quot;]
</PRE>
<P><HR WIDTH="80%" ALIGN="Left">
<STRONG>Positional parameters: </STRONG>The first line shows the usage with positional parameters (given in order). The second line shows usage with named parameters.</P>
<P><HR WIDTH="80%" ALIGN="Left"></P>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#load_cart_nickname">nickname</A>
</TD>
<TD VALIGN='Top'>
Must be an existing nickname.
<UL>
Nickname is constructed from:<UL>
<LI>a name part
<LI>time modified (time the cart was saved by save_cart tag)
<LI>type (c for cart, r for recurring)</UL></UL>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD>
Invalidates cache
</TD>
<TD>
<I>No</I>
</TD>
</TR>
<TR>
<TD>
Macro
</TD>
<TD>
<I>No</I>
</TD>
</TR>
<TR>
<TD>
Has end tag
</TD>
<TD>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [load_cart mycart:990102732:c]
    [load_cart nickname=&quot;mycart:990102732:c&quot;]
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;load_cart( { nickname =&gt; <TT>&quot;mycart:990102732:c&quot;</TT>, } );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;load_cart( <TT>&quot;mycart:990102732:c&quot;</TT> );
</PRE>
<H4><A NAME="See Also">6.12.1.1. See Also</A></H4>
<P><A HREF="#userdb">userdb</A>, <A HREF="#delete_cart">delete_cart</A>, <A HREF="#save_cart">save_cart</A> and pages templates/components/saved_carts_list_small, pages/saved_carts.html for more examples.</P>
<H3><A NAME="Description">6.12.2. Description</A></H3>
<P>Loads a cart with name nickname from the user database. It will be merged with the current cart. Basically the same as [userdb function=get_cart nickname=cartname merge=1].</P>
<H4><A NAME="load_cart_nickname"> </A>6.12.2.1. <A NAME="load_cart_nickname">nickname</A></H4>
<P>Nickname of cart to be loaded. See above.</P>
<H2><A NAME="loc">6.13. loc</A></H2>
<H2><A NAME="rand">6.14. rand</A></H2>
<H2><A NAME="reconfig">6.15. reconfig</A></H2>
<H2><A NAME="reconfig_time">6.16. reconfig_time</A></H2>
<H2><A NAME="reconfig_wait">6.17. reconfig_wait</A></H2>
<H2><A NAME="save_cart">6.18. save_cart</A></H2>
<P>This tag saves the current cart or recurring order in the userdb under a given name.</P>
<H3><A NAME="Summary">6.18.1. Summary</A></H3>
<PRE>
    [<B>save_cart</B> nickname recurring]
    [<B>save_cart</B> nickname=&quot;cart-name&quot; recurring=1]
</PRE>
<P><HR WIDTH="80%" ALIGN="Left">
<STRONG>Positional parameters: </STRONG>The first line shows the usage with positional parameters (given in order). The second line shows usage with named parameters.</P>
<P><HR WIDTH="80%" ALIGN="Left"></P>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#save_cart_nickname">nickname</A>
</TD>
<TD VALIGN='Top'>
Label for the cart.
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#save_cart_recurring">recurring</A>
</TD>
<TD VALIGN='Top'>
Set to true if recurring. Set to false, or omit if cart.
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD>
Invalidates cache
</TD>
<TD>
<I>No</I>
</TD>
</TR>
<TR>
<TD>
Macro
</TD>
<TD>
<I>No</I>
</TD>
</TR>
<TR>
<TD>
Has end tag
</TD>
<TD>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [save_cart mycart]
    [save_cart nickname=mycart recurring=1]
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;save_cart( { nickname =&gt; mycart,
                      recurring =&gt; 1, } );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;save_cart( <TT>&quot;mycart&quot;</TT>, <TT>&quot;1&quot;</TT> );
</PRE>
<H4><A NAME="See Also">6.18.1.1. See Also</A></H4>
<P><A HREF="#userdb">userdb</A>, <A HREF="#delete_cart">delete_cart</A>, <A HREF="#load_cart">load_cart</A> and pages templates/components/saved_carts_list_small, pages/saved_carts.html for more examples.</P>
<H3><A NAME="Description">6.18.2. Description</A></H3>
<P>Saves the current cart with name nickname in the user database. Basically the same as [userdb function=set_cart nickname=cartname]</P>
<H4><A NAME="save_cart_nickname"> </A>6.18.2.1. <A NAME="save_cart_nickname">nickname</A></H4>
<P>Nickname for the current cart to be saved. You can use same nickname for different carts. An index will be added if there are more carts with the same nickname.</P>
<H4><A NAME="save_cart_recurring"> </A>6.18.2.2. <A NAME="save_cart_recurring">recurring</A></H4>
<P>Set to true if recurring. Set to false, or simply omit it, if it is a cart.</P>
<H2><A NAME="summary">6.19. summary</A></H2>
<P>This tag calculates column totals.</P>
<H3><A NAME="Summary">6.19.1. Summary</A></H3>
<PRE>
    [<B>summary</B> amount]
    [<B>summary</B> amount=n.nn <I>other_named_attributes</I>]
</PRE>
<P><HR WIDTH="80%" ALIGN="Left">
<STRONG>Positional parameters: </STRONG>The first line shows the usage with positional parameters (given in order). The second line shows usage with named parameters.</P>
<P><HR WIDTH="80%" ALIGN="Left"></P>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
amount
</TD>
<TD VALIGN='Top'>
Numerical value to be added to previous total
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#summary_currency">currency</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#summary_format">format</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#summary_hide">hide</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>, no hiding
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#summary_name">name</A>
</TD>
<TD VALIGN='Top'>
ONLY0000, internal use only
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#summary_reset">reset</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#summary_total">total</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD>
Invalidates cache
</TD>
<TD>
<I>No</I>
</TD>
</TR>
<TR>
<TD>
Macro
</TD>
<TD>
<I>No</I>
</TD>
</TR>
<TR>
<TD>
Has end tag
</TD>
<TD>
<I>No</I>
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [loop list=&quot;10 20 30.5&quot;]
        [summary amount=&quot;[loop-code]&quot; hide=1]
    [/loop]
    [summary total=1 format=&quot;%.3f&quot;]
    [summary total=1 currency=1]
---
    60.500
    $60.50
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;summary( { amount =&gt; 10.5,
                       hide =&gt; 1, } );

    $Tag-&gt;summary( { amount =&gt; 25,
                       name =&gt; mytotal,
                   currency =&gt; 1, } );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;summary( 10.5, $attribute_hash_reference );
</PRE>
<H4><A NAME="See Also">6.19.1.1. See Also</A></H4>
<P>templates/components/cart, pages/ord/checkout.html for more examples.</P>
<H3><A NAME="Description">6.19.2. Description</A></H3>
<P>The summary tag provides you with an easy way to calculate and display totals. The display of the amounts is fully customizable. You can hide display, or you can show the amounts with the proper currency formatting according to the locale, or you can define your own formatting. Any number of summaries can be kept on a page.</P>
<H4><A NAME="summary_currency"> </A>6.19.2.1. <A NAME="summary_currency">currency</A></H4>
<P>The amount or total will be displayed according to the currency formatting of the current locale if this attribute is set to true (non blank or zero).</P>
<H4><A NAME="summary_format"> </A>6.19.2.2. <A NAME="summary_format">format</A></H4>
<P>You can choose any formatting of the amount you like. Just set the format attribute to the desired formatting string (%s, %.2f etc.). When both, currency and format attributes are set, the format attribute will take precedence. So it doesn't make much sense to set them both at the same time.</P>
<H4><A NAME="summary_hide"> </A>6.19.2.3. <A NAME="summary_hide">hide</A></H4>
<P>Will suppress the display of amount when set to true.</P>
<H4><A NAME="summary_name"> </A>6.19.2.4. <A NAME="summary_name">name</A></H4>
<P>You can calculate as many totals as you like on the same page. Just supply a different label for each summary.</P>
<H4><A NAME="summary_reset"> </A>6.19.2.5. <A NAME="summary_reset">reset</A></H4>
<P>Will erase the total(s) if set to true. Be careful tough. It will reset ALL totals when you have no name attribute supplied. If you have provided a label for the name attribute then it will only reset the total for that particular label. All others won't be touched.</P>
<H4><A NAME="summary_total"> </A>6.19.2.6. <A NAME="summary_total">total</A></H4>
<P>Will show the total instead of the amount if set to true.</P>
<H2><A NAME="table_organize">6.20. table_organize</A></H2>
<P>Takes an unorganized set of table cells and organizes them into rows based on the number of columns.</P>
<H3><A NAME="Summary">6.20.1. Summary</A></H3>
<PRE>
    [<B>table-organize</B> cols* <I>other_named_attributes</I>]
             [loop ....] &lt;td&gt; [loop-tags] &lt;/td&gt; [/loop]
        [/table-organize]

    [<B>table-organize</B> cols=n* <I>other_named_attributes</I>]
             [loop ....] &lt;td&gt; [loop-tags] &lt;/td&gt; [/loop]
        [/table-organize]
</PRE>
<P><HR WIDTH="80%" ALIGN="Left">
<STRONG>Positional parameters: </STRONG>The first line shows the usage with positional parameters (given in order). The second line shows usage with named parameters.</P>
<P><HR WIDTH="80%" ALIGN="Left"></P>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#table_organize_cols">cols</A>
</TD>
<TD VALIGN='Top'>
Number of columns.
</TD>
<TD VALIGN='Top'>
2
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
columns
</TD>
<TD VALIGN='Top'>
Alias for cols.
</TD>
<TD VALIGN='Top'>
2
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#table_organize_caption">caption</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#table_organize_columnize">columnize</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#table_organize_embed">embed</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#table_organize_filler">filler</A>
</TD>
<TD VALIGN='Top'>
&amp;nbsp;
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#table_organize_limit">limit</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#table_organize_pretty">pretty</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#table_organize_rows">rows</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#table_organize_table">table</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#table_organize_td">td</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#table_organize_tr">tr</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD>
Invalidates cache
</TD>
<TD>
<I>No</I>
</TD>
</TR>
<TR>
<TD>
Macro
</TD>
<TD>
<I>No</I>
</TD>
</TR>
<TR>
<TD>
Has end tag
</TD>
<TD>
[/table-organize]
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<P>This example produces a table that (1) alternates rows with background colors &quot;#EEEEEE&quot; and &quot;#FFFFFF&quot;, and (2) aligns the columns right, center, left:</P>
<PRE>
        [table-organize
            cols=3
            pretty=1
            tr.0='bgcolor=&quot;#EEEEEE&quot;'
            tr.1='bgcolor=&quot;#FFFFFF&quot;'
            td.0='align=right'
            td.1='align=center'
            td.2='align=left'
        ]
            [loop list=&quot;1 2 3 1a 2a 3a 1b&quot;] &lt;td&gt; [loop-code] &lt;/td&gt; [/loop]
        [/table-organize]
---
        &lt;tr bgcolor=&quot;#EEEEEE&quot;&gt;
                &lt;td align=right&gt;1&lt;/td&gt;
                &lt;td align=center&gt;2&lt;/td&gt;
                &lt;td align=left&gt;3&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr bgcolor=&quot;#FFFFFF&quot;&gt;
                &lt;td align=right&gt;1a&lt;/td&gt;
                &lt;td align=center&gt;2a&lt;/td&gt;
                &lt;td align=left&gt;3a&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr bgcolor=&quot;#EEEEEE&quot;&gt;
                &lt;td align=right&gt;1b&lt;/td&gt;
                &lt;td align=center&gt;&amp;nbsp;&lt;/td&gt;
                &lt;td align=left&gt;&amp;nbsp;&lt;/td&gt;
        &lt;/tr&gt;
</PRE>
<P>If the attribute columnize=1 is present, the result will look like:</P>
<PRE>
            &lt;tr bgcolor=&quot;#EEEEEE&quot;&gt;
                    &lt;td align=right&gt;1&lt;/td&gt;
                    &lt;td align=center&gt;1a&lt;/td&gt;
                    &lt;td align=left&gt;1b&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr bgcolor=&quot;#FFFFFF&quot;&gt;
                    &lt;td align=right&gt;2&lt;/td&gt;
                    &lt;td align=center&gt;2a&lt;/td&gt;
                    &lt;td align=left&gt;&amp;nbsp;&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr bgcolor=&quot;#EEEEEE&quot;&gt;
                    &lt;td align=right&gt;3&lt;/td&gt;
                    &lt;td align=center&gt;3a&lt;/td&gt;
                    &lt;td align=left&gt;&amp;nbsp;&lt;/td&gt;
            &lt;/tr&gt;
</PRE>
<P>See the source for more ideas on how to extend this tag.</P>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;table_organize( { cols =&gt; 3,
                            pretty =&gt; 1, }, $BODY );
</PRE>
<P>or similarly with positional parameters:</P>
<PRE>
    $Tag-&gt;table_organize( $cols, $attribute_hash_reference, $BODY );
</PRE>
<H4><A NAME="See Also">6.20.1.1. See Also</A></H4>
<P>pages/flypage.html, pages/quantity.html, templates/components/best_horizontal, templates/components/cart, templates/components/cross_horizontal, templates/components/random, templates/components/random_vertical, templates/components/upsell</P>
<H3><A NAME="Description">6.20.2. Description</A></H3>
<P>Takes an unorganized set of table cells and organizes them into rows based on the number of columns; it will also break them into separate tables.</P>
<P>If the number of cells are not on an even modulus of the number of columns, then &quot;filler&quot; cells are pushed on.</P>
<H4><A NAME="table_organize_cols"> </A>6.20.2.1. <A NAME="table_organize_cols">cols (or columns)</A></H4>
<P>Number of columns. This argument defaults to 2 if not present.</P>
<H4><A NAME="table_organize_rows"> </A>6.20.2.2. <A NAME="table_organize_rows">rows</A></H4>
<P>Optional number of rows. Implies &quot;table&quot; parameter.</P>
<H4><A NAME="table_organize_table"> </A>6.20.2.3. <A NAME="table_organize_table">table</A></H4>
<P>If present, will cause a surrounding &lt;TABLE&gt; &lt;/TABLE&gt; pair with the attributes specified in this option.</P>
<H4><A NAME="table_organize_caption"> </A>6.20.2.4. <A NAME="table_organize_caption">caption</A></H4>
<P>Table &lt;CAPTION&gt; container text, if any. Can be an array.</P>
<H4><A NAME="table_organize_td"> </A>6.20.2.5. <A NAME="table_organize_td">td</A></H4>
<P>Attributes for table cells. Can be an array.</P>
<H4><A NAME="table_organize_tr"> </A>6.20.2.6. <A NAME="table_organize_tr">tr</A></H4>
<P>Attributes for table rows. Can be an array.</P>
<H4><A NAME="table_organize_columnize"> </A>6.20.2.7. <A NAME="table_organize_columnize">columnize</A></H4>
<P>Will display cells in (newspaper) column order, i.e. rotated.</P>
<H4><A NAME="table_organize_pretty"> </A>6.20.2.8. <A NAME="table_organize_pretty">pretty</A></H4>
<P>Adds newline and tab characters to provide some reasonable indenting.</P>
<H4><A NAME="table_organize_filler"> </A>6.20.2.9. <A NAME="table_organize_filler">filler</A></H4>
<P>Contents to place in empty cells put on as filler. Defaults to &quot;&amp;nbsp;&quot;.</P>
<H4><A NAME="table_organize_limit"> </A>6.20.2.10. <A NAME="table_organize_limit">limit</A></H4>
<P>Maximum number of cells to use. Truncates extra cells silently.</P>
<H4><A NAME="table_organize_embed"> </A>6.20.2.11. <A NAME="table_organize_embed">embed</A></H4>
<P>If you want to embed other tables inside, make sure they are called with lower case &lt;td&gt; elements, then set the embed tag and make the cells you wish to organize be &lt;TD&gt; elements. To switch that sense, and make the upper-case or mixed case be the ignored cells, set the embed parameter to &quot;lc&quot;.</P>
<PRE>
    [table-organize embed=lc]
                &lt;td&gt;
                        &lt;TABLE&gt;
                                &lt;TR&gt;
                                &lt;TD&gt; something
                                &lt;/TD&gt;
                                &lt;/TR&gt;
                        &lt;/TABLE&gt;
                &lt;/td&gt;
    [/table-organize]
</PRE>
<P>or</P>
<PRE>
    [table-organize embed=uc]
                &lt;TD&gt;
                        &lt;table&gt;
                                &lt;tr&gt;
                                &lt;td&gt; something
                                &lt;/td&gt;
                                &lt;/tr&gt;
                        &lt;/table&gt;
                &lt;/TD&gt;
    [/table-organize]
</PRE>
<P>The &quot;tr&quot;, &quot;td&quot;, and &quot;caption&quot; attributes can be specified with indexes; if they are, then they will alternate according to the modulus.</P>
<P>The &quot;td&quot; option array size should probably always equal the number of columns; if it is bigger, then trailing elements are ignored. If it is smaller, no attribute is used.</P>
<H2><A NAME="title_bar">6.21. title_bar</A></H2>
<P>Creates a quick title bar.</P>
<H3><A NAME="Summary">6.21.1. Summary</A></H3>
<PRE>
    [<B>title-bar</B> width size color]My title[/title-bar]
    [<B>title-bar</B> width=600 size=5 color=&quot;#ff0000&quot;]My title[/title-bar]
</PRE>
<P><HR WIDTH="80%" ALIGN="Left">
<STRONG>Positional parameters: </STRONG>The first line shows the usage with positional parameters (given in order). The second line shows usage with named parameters.</P>
<P><HR WIDTH="80%" ALIGN="Left"></P>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#title_bar_color">color</A>
</TD>
<TD VALIGN='Top'>
Background color the bar.
<UL>
Defaults to<UL>
<LI>variable HEADERBG or
<LI>#444444</UL></UL>
</TD>
<TD VALIGN='Top'>
HEADERBG or #444444
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#title_bar_size">size</A>
</TD>
<TD VALIGN='Top'>
Font size
</TD>
<TD VALIGN='Top'>
6
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#title_bar_width">width</A>
</TD>
<TD VALIGN='Top'>
Width of the title bar
</TD>
<TD VALIGN='Top'>
500
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD>
Invalidates cache
</TD>
<TD>
<I>No</I>
</TD>
</TR>
<TR>
<TD>
Macro
</TD>
<TD>
<I>No</I>
</TD>
</TR>
<TR>
<TD>
Has end tag
</TD>
<TD>
[/title-bar]
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [title-bar 600 5 red]My title[/title-bar]
    [title-bar width=600 size=5 color=&quot;#ff0000&quot;]My title[/title-bar]
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;title_bar( { body =&gt; <TT>&quot;My Title&quot;</TT>, } );

    $Tag-&gt;title_bar( { width =&gt; 400,
                       color =&gt; <TT>&quot;#0000ff&quot;</TT>,
                        body =&gt; <TT>&quot;My title&quot;</TT>, } );
</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;title_bar( 600, 5, <TT>&quot;red&quot;</TT>, <TT>&quot;My title&quot;</TT> );
</PRE>
<H3><A NAME="Description">6.21.2. Description</A></H3>
<P>Quickly adds a title bar to your pages without having to type the html each time. Background color, width of the bar and size of the text can be customized by setting the appropriate parameter. The text color defaults to variable HEADERTEXT or when its not present to white.</P>
<H4><A NAME="title_bar_color"> </A>6.21.2.1. <A NAME="title_bar_color">color</A></H4>
<P>Sets the background color of the bar. You can set the color as 'red', '#ff0000', or 'bgcolor=&quot;#ff0000&quot;'.</P>
<H4><A NAME="title_bar_size"> </A>6.21.2.2. <A NAME="title_bar_size">size</A></H4>
<P>Determines the size of the text. Parameter should be set to a value accepted by the HTML &lt;font&gt; tag size attribute.</P>
<H4><A NAME="title_bar_width"> </A>6.21.2.3. <A NAME="title_bar_width">width</A></H4>
<P>Sets the width of the bar.</P>
<H2><A NAME="ups_query">6.22. ups_query</A></H2>
<H2><A NAME="usertrack">6.23. usertrack</A></H2>
<H2><A NAME="var">6.24. var</A></H2>
<H2><A NAME="xml-generator">6.25. xml-generator</A></H2>
<P>This is a quick and dirty tag that generates XML tags based upon one of two types of data (delimited and session).</P>
<H3><A NAME="Summary">6.25.1. Summary</A></H3>
<PRE>
    [<B>xml-generator</B> type* <I>other_named_attributes</I>][/xml-generator]
    [<B>xml-generator</B> type=value* <I>other_named_attributes</I>][/xml-generator]
    [<B>xml-generator</B> type=value* <I>other_named_attributes</I>][][/xml-generator]

*Optional
</PRE>
<P><HR WIDTH="80%" ALIGN="Left">
<STRONG>Positional parameters: </STRONG>The first line shows the usage with positional parameters (given in order). The second line shows usage with named parameters.</P>
<P><HR WIDTH="80%" ALIGN="Left"></P>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Parameters</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#xml_generator_type">type</A>
</TD>
<TD VALIGN='Top'>
Data type. Delimited or session
</TD>
<TD VALIGN='Top'>
delimited
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Attributes</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Default</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#xml_generator_attributes">attributes</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#xml_generator_dbdump">dbdump</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#xml_generator_delimiter">delimiter</A>
</TD>
<TD VALIGN='Top'>
\t
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#xml_generator_field_names">field_names</A>
</TD>
<TD VALIGN='Top'>
&amp;nbsp;
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#xml_generator_separator">separator</A>
</TD>
<TD VALIGN='Top'>
\n
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#xml_generator_toplevel_tag">toplevel_tag</A>
</TD>
<TD VALIGN='Top'>
'table' for delimited type and 'session' for other type
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#xml_generator_record_tag">record_tag</A>
</TD>
<TD VALIGN='Top'>
record
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#xml_generator_field_tag">field_tag</A>
</TD>
<TD VALIGN='Top'>
field
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#xml_generator_key_name">key_name</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#xml_generator_spacer">spacer</A>
</TD>
<TD VALIGN='Top'>
[\s,]+
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#xml_generator_no_second">no_second</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A HREF="#xml_generator_skip_empty">skip_empty</A>
</TD>
<TD VALIGN='Top'>
<I>none</I>
</TD>
</TR>
</TABLE>

<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD>
<STRONG>Other_Characteristics</STRONG>
</TD>
<TD>
<STRONG>&nbsp;</STRONG>
</TD>
</TR>
<TR>
<TD>
Invalidates cache
</TD>
<TD>
<I>No</I>
</TD>
</TR>
<TR>
<TD>
Macro
</TD>
<TD>
<I>No</I>
</TD>
</TR>
<TR>
<TD>
Has end tag
</TD>
<TD>
[/xml-generator]
</TD>
</TR>
</TABLE>

<P><B>Tag expansion example:</B></P>
<PRE>
    [xml-generator type=delimited
             attributes=&quot;date&quot;
                   date=&quot;[tag time]%d-%b-%Y[/tag]&quot;
           toplevel_tag=products
    ]code       description     price
        [query list=1 sql=&quot;select sku, description, price from products&quot; prefix=xml][xml-code]  [xml-param description] [xml-param price]
        [/query]
    [/xml-generator]
---
    &lt;products date=&quot;18-May-2001&quot;&gt;
            &lt;record key=&quot;os28113&quot;&gt;
                    &lt;code&gt;os28113&lt;/code&gt;
                    &lt;description&gt;The Claw Hand Rake&lt;/description&gt;
                    &lt;price&gt;14.99&lt;/price&gt;
            &lt;/record&gt;
            &lt;record key=&quot;os28006&quot;&gt;
                    &lt;code&gt;os28006&lt;/code&gt;
                    &lt;description&gt;Painters Brush Set&lt;/description&gt;
                    &lt;price&gt;29.99&lt;/price&gt;
            &lt;/record&gt;
            ...
    &lt;/products&gt;
</PRE>
<P><B>ASP-like Perl call:</B></P>
<PRE>
    $Tag-&gt;xml_generator( {type =&gt; delimited,
                      toplevel_tag =&gt; apex,  }, $BODY );

</PRE>
<P>or similarly with positional parameters,</P>
<PRE>
    $Tag-&gt;xml_generator( $type, $attribute_hash_reference, $BODY );
</PRE>
<H3><A NAME="Description">6.25.2. Description</A></H3>
<H4><A NAME="xml_generator_type"> </A>6.25.2.1. <A NAME="xml_generator_type">type</A></H4>
<P>delimited</P>
<P>Accepts a delimited and separated (default is TAB delimiter and newline separator) list of records such as that generated by an '[item-list]', '[sql]', or '[loop search=&quot;&quot;]' ITL tag.</P>
<P>session</P>
<P>When the type is not delimited, it can contain any hash reference into the Interchange session. Examples are:</P>
<PRE>
        values       The form values
        scratch      Scratch values
        errors       Error values
        other        Any other Session key, for example &quot;source&quot; for
                     [data session source]
</PRE>
<P>If the value is a hash, then it will be sent as an XML record with the top level equal to &quot;session&quot;, and a second_level tag equal to the hash name, and keys as separate XML container tags. If the parameter &quot;that is equal to the type&quot; is given, only those fields will be shown. Otherwise the entire hash will be shown. For example, this tag:</P>
<PRE>
        [xml-generator type=&quot;values&quot; values=&quot;fname lname&quot;][/xml-generator]

will generate:

        &lt;session&gt;
                &lt;values&gt;
                        &lt;fname&gt;First&lt;/fname&gt;
                        &lt;lname&gt;Last&lt;/lname&gt;
                &lt;/values&gt;
        &lt;/session&gt;

if it is a scalar, then only the second level will be done:

        [xml-generator type=&quot;cybercash_id&quot;][/xml-generator]

will do the equivalent of:

        &lt;session&gt;
                &lt;cybercash_id&gt;[data session cybercash_id]&lt;/cybercash_id&gt;
        &lt;/session&gt;

So bringing it all together, the following:

        [xml-generator type=&quot;values scratch source&quot;
                       values=&quot;fname lname&quot;
                       scratch=&quot;downloads&quot;][/xml-generator]
will generate:

        &lt;session&gt;
                &lt;values&gt;
                        &lt;fname&gt;First&lt;/fname&gt;
                        &lt;lname&gt;Last&lt;/lname&gt;
                &lt;/values&gt;
                &lt;scratch&gt;
                        &lt;downloads&gt;0&lt;/downloads&gt;
                &lt;/scratch&gt;
                &lt;source&gt;Partner1&lt;/source&gt;
        &lt;/session&gt;
</PRE>
<H4><A NAME="xml_generator_no_second"> </A>6.25.2.2. <A NAME="xml_generator_no_second">no_second</A></H4>
<P>Prevents the second-level tags from being generated. Extending the last example in the &quot;session&quot; type above, this</P>
<PRE>
        [xml-generator  type=&quot;values scratch source&quot;
                        no_second=1
                        values=&quot;fname lname&quot;
                        scratch=&quot;downloads&quot;][/xml-generator]
will generate:

        &lt;session&gt;
                &lt;fname&gt;First&lt;/fname&gt;
                &lt;lname&gt;Last&lt;/lname&gt;
                &lt;downloads&gt;0&lt;/downloads&gt;
                &lt;source&gt;Partner1&lt;/source&gt;
        &lt;/session&gt;
</PRE>
<H4><A NAME="xml_generator_attributes"> </A>6.25.2.3. <A NAME="xml_generator_attributes">attributes</A></H4>
<P>The attributes (if any) to pass on to the top level tag. For instance,</P>
<PRE>
    [xml-generator
          attributes=&quot;date&quot;
                date=&quot;[tag time]%d-%b-%Y[/tag]&quot;
        toplevel_tag=order
    ][/xml-generator]

will generate a toplevel tag pair of:

        &lt;order date=&quot;18-Mar-2001&quot;&gt;
        &lt;/order&gt;
</PRE>
<H4><A NAME="xml_generator_dbdump"> </A>6.25.2.4. <A NAME="xml_generator_dbdump">dbdump</A></H4>
<P>Will dump all tables in the catalog when this attribute is set true. Used attributes are &quot;toplevel_tag&quot;, &quot;record_tag&quot;, &quot;field_tag&quot;, and &quot;skip_empty&quot; or default values ('table', 'record', 'field' respectively).</P>
<PRE>
Output format:
    &lt;database name=&quot;catalogname&quot;&gt;
        &lt;toplevel_tag name=&quot;tablename1&quot;&gt;
            &lt;record_tag key=&quot;value of first field-1&quot;&gt;
                &lt;field_tag name=&quot;fieldname1&quot;&gt;fieldvalue1&lt;/field_tag&gt;
                &lt;field_tag name=&quot;fieldname2&quot;&gt;fieldvalue2&lt;/field_tag&gt;
                        &lt;/record_tag&gt;
            &lt;record_tag key=&quot;value of first field-2&quot;&gt;
                &lt;field_tag name=&quot;fieldname1&quot;&gt;fieldvalue1&lt;/field_tag&gt;
                &lt;field_tag name=&quot;fieldname2&quot;&gt;fieldvalue2&lt;/field_tag&gt;
                        &lt;/record_tag&gt;
                &lt;/toplevel_tag&gt;
        &lt;toplevel_tag name=&quot;tablename2&quot;&gt;
            &lt;record_tag key=&quot;value of first field-1&quot;&gt;
                &lt;field_tag name=&quot;fieldname1&quot;&gt;fieldvalue1&lt;/field_tag&gt;
                &lt;field_tag name=&quot;fieldname2&quot;&gt;fieldvalue2&lt;/field_tag&gt;
                        &lt;/record_tag&gt;
                &lt;/toplevel_tag&gt;
        &lt;/database&gt;
</PRE>
<P><B>Important note:</B> All tables are read into memory. So be warned, this could be a real memory hog.</P>
<P>Ton Verhagen's proposal:</P>
<OL>
<LI>Add option to select tables. E.g. dump_tables=&quot;products cat area&quot; and/or
<LI>Add option to select an output file. E.g. dump_file=&quot;tabledump.XML&quot;. Send output to file line by line.</OL>
<H4><A NAME="xml_generator_delimiter"> </A>6.25.2.5. <A NAME="xml_generator_delimiter">delimiter</A></H4>
<P>Character used as delimiter of fields in delimited data type. Defaults to a tab character.</P>
<H4><A NAME="xml_generator_field_names"> </A>6.25.2.6. <A NAME="xml_generator_field_names">field_names</A></H4>
<P>Space or comma-delimited list of field names to be used for delimited data type. Should be in the same order as in the data list provided (between the tags).</P>
<P>Another way of providing the field names would be:</P>
<PRE>
    [xml-generator .....]fieldname-1    fieldname-2     fieldname-3
        [field value list
         delimited by option delimiter and
         separated by option separator][/xml-generator]
</PRE>
<P><HR WIDTH="80%" ALIGN="Left">
<STRONG>Note: </STRONG>Field name list <B>must</B> be tab delimited.
<HR WIDTH="80%" ALIGN="Left"></P>
<P>Ton Verhagen's humble opinion: This should change in future versions! Use option delimiter instead.</P>
<H4><A NAME="xml_generator_separator"> </A>6.25.2.7. <A NAME="xml_generator_separator">separator</A></H4>
<P>Character used as line separator in list between [xml-separator][xml-separator] tags and in output 'session' data type. Defaults to a newline, &quot;\n&quot;.</P>
<H4><A NAME="xml_generator_toplevel_tag"> </A>6.25.2.8. <A NAME="xml_generator_toplevel_tag">toplevel_tag</A></H4>
<P>The toplevel tag name to use. Defaults to &quot;table&quot; for the 'dbdump mode' and delimited type, and &quot;session&quot; for the other.</P>
<H4><A NAME="xml_generator_record_tag"> </A>6.25.2.9. <A NAME="xml_generator_record_tag">record_tag</A></H4>
<P>Defines the tag name for the record tag. Defaults to 'record'. Used for 'dbdump mode' and delimited type.</P>
<H4><A NAME="xml_generator_field_tag"> </A>6.25.2.10. <A NAME="xml_generator_field_tag">field_tag</A></H4>
<P>Defines the tag name for the field tag. Defaults to 'field'. Only used in 'dbdump mode'.</P>
<H4><A NAME="xml_generator_key_name"> </A>6.25.2.11. <A NAME="xml_generator_key_name">key_name</A></H4>
<P>Only used in delimited data type. Defines fieldname to determine key value in &quot;record_tag&quot;.</P>
<PRE>
    &lt;record_tag key=&quot;value of field with name defined by key_name&quot;&gt; ....
</PRE>
<H4><A NAME="xml_generator_spacer"> </A>6.25.2.12. <A NAME="xml_generator_spacer">spacer</A></H4>
<P>Character used as delimiter in type parameter definition and corresponding attributes. Defaults to '[\s,]+' (one or more whitespace or comma).</P>
<PRE>
    [xml-generator type=&quot;values|scratch&quot;
                 values=&quot;value1|value2&quot;
                scratch=&quot;scratch1|scratch2&quot;
                 spacer=&quot;|&quot;
    ][/xml-generator]
</PRE>
<H4><A NAME="xml_generator_skip_empty"> </A>6.25.2.13. <A NAME="xml_generator_skip_empty">skip_empty</A></H4>
<P>Only used in <A HREF="#xml_generator_dbdump">dbdump</A> mode (dbdump=1). Will skip empty fields if this attribute is set true.</P>
<HR>
<H1><A NAME="Template Parsing Order">A. Template Parsing Order</A></H1>
<H2><A NAME="Standard Parsing">A.1. Standard Parsing</A></H2>
<P>Under normal circumstances, the template page containing tags and HTML is parsed in the following order:</P>
<OL>
<LI>Any content in MV_AUTOLOAD is prepended to the template page.<UL>
<EM></EM></UL>
<BR>
<EM></EM>
<LI>Any <TT>[pragma]</TT> tags anywhere in the text are processed, and the specified pragmas are set.<UL>
<LI>Since <TT>[pragma]</TT> tags are preprocessed before any other content, <A HREF="#attr_reparse">reparse</A> will not catch them, nor will they work if included in variables. Also, the specified pragma will apply to the entire template (not just the section after the tag).</UL><UL>
<LI>If you want to apply a pragma with a variable or only to part of a document, you must use [<A HREF="#tag">tag</A>&nbsp;pragma=&quot;...&quot;] instead.</UL>
<BR>
<EM></EM>
<LI>Variables (macros) are processed in the following order:<OL>
<LI>@@VARNAME@@ global variables
<LI>@_VARNAME_@ local or global variables
<LI>__VARNAME__ local variables</OL>
<BR>
<EM></EM>
<LI>Interchange comments are stripped.<UL>
<EM></EM></UL>
<BR>
<EM></EM>
<LI>False-endtag macros are expanded (e.g., [<A HREF="#page">/page</A>] and [<A HREF="#order">/order</A>]).<UL>
<EM></EM></UL>
<BR>
<EM></EM>
<LI>'&lt;!--[tagname]--&gt;' escapes are converted to [tagname]<UL>
<LI>This can be a convenience for your HTML editor if it has trouble with tags using the standard [tagname] syntax.</UL><UL>
<LI>However, if you want to HTML-comment out an Interchange tag in content that will be fed raw to a browser, you must include whitespace between the HTML comment delimiters and the tag, like this, '&lt;!--&nbsp;&nbsp;[tagname]&nbsp;&nbsp;--&gt;'.</UL>
<BR>
<EM></EM>
<LI>The main tag parser is called.<UL>
<LI>Some tags parse recursively (depending upon <A HREF="#attr_reparse">reparse</A> and <A HREF="#attr_interpolate">interpolate</A> settings, of course).</UL><UL>
<LI>Some tags (e.g., [<A HREF="#loop">loop</A>]) process PREFIX-tags in their contained body text. Hence, the PREFIX-tags are not handled recursively.</UL><UL>
<LI>Some tags are interpreted in the lib/Vend/Parse.pm:start routine. You cannot call them with the '$Tag-&gt;<I>tagname</I>()' syntax. They are:<UL>
<LI>The [<A HREF="#goto">goto</A>] tag. Note also that the [<A HREF="#goto">goto</A>] tag handles the [<A HREF="#label">label</A>] tag.</UL><UL>
<LI>The [<A HREF="#bounce">bounce</A>] tag.</UL></UL>
<BR>
<EM></EM>
<LI>Image paths substitution on the HTML output occurs.<UL>
<EM></EM></UL>
<BR>
<EM></EM></OL>
<H2><A NAME="Nonstandard parsing within the admin interface">A.2. Nonstandard parsing within the admin interface</A></H2>
<P>Parsing of content via the specialized <TT>[regenerate]</TT> usertag included with the administrative interface does not obey the above order. The MV_AUTOLOAD and '&lt;!--[tagname]--&gt;' escapes are skipped. There are some other more subtle differences as well; in the very unlikely event that you need to check this in the source code, compare the 'interpolate_html' and 'cache_html' routines in Interpolate.pm.</P>
<H2><A NAME="Nonstandard parsing of Subtags">A.3. Nonstandard parsing of Subtags</A></H2>
<P>Subtags are parsed within the containing array-list or hash-list context created by the containing tag (see <A HREF="#Looping tags and Sub-tags">Looping tags and Sub-tags</A>).</P>
<UL>
<LI>All subtags at an earlier precedence level are treated before any in the next level.
<LI>Within the same level, tags are processed in the order the appear on the page.
<LI>Any standard tags are processed during 'interpolate' (before) or 'reparse' (after) phases of processing the containing tag.</UL>
<P><HR WIDTH="80%" ALIGN="Left">
<STRONG>Technical note</STRONG></P>
<P>Processing within a hash- or array-list is actually done as a series of global regular expression substitutions on the page. Each substitution replaces one tag with the output of the subroutine(s) associated with it.</P>
<P><HR WIDTH="80%" ALIGN="Left"></P>
<P>In array-list context, subtags are processed in the following order:</P>
<OL>
<LI>Check for PREFIX-<B>line</B> and prepare for it if present (does not process PREFIX-<B>line</B> at this time)
<LI>PREFIX-<B>sub</B> definitions processed
<LI><B>if</B>-PREFIX-<I>*</I> nesting resolved
<LI>PREFIX-<B>alternate</B> processed
<LI><B>if</B>-PREFIX-<B>param</B>  processed
<LI><B>if</B>-PREFIX-<B>pos</B>  processed
<LI>PREFIX-<B>pos</B>  processed
<LI><B>if</B>-PREFIX-<B>field</B>  processed
<LI>PREFIX-<B>line</B>  processed
<LI>PREFIX-<B>increment</B>  processed
<LI>PREFIX-<B>accessories</B>  processed
<LI>PREFIX-<B>options</B>  processed
<LI>PREFIX-<B>code</B>  processed
<LI>PREFIX-<B>description</B>  processed
<LI>PREFIX-<B>field</B>  processed
<LI>PREFIX-<B>price</B>  processed
<LI>PREFIX-<B>change</B>  processed
<LI>PREFIX-<B>calc</B>  processed
<LI>PREFIX-<B>exec</B>  processed
<LI>PREFIX-<B>filter</B>  processed
<LI>PREFIX-<B>last</B>  processed
<LI>PREFIX-<B>next</B>  processed
<LI>User's previous HTML widget SELECTED settings restored
<LI>Reparse standard tags in output of above (if reparse enabled for the containing tag)</OL>
<P>In hash-list context, subtags are processed in the following order:</P>
<OL>
<LI>PREFIX-<B>sub</B> definitions processed
<LI><B>if</B>-PREFIX-<I>*</I> nesting resolved
<LI>PREFIX-<B>alternate</B> processed
<LI>PREFIX-<B>line</B>  processed
<LI><B>if</B>-PREFIX-<B>param</B>  processed
<LI><B>if</B>-PREFIX-<B>field</B>  processed
<LI><B>if</B>-PREFIX-<B>modifier</B>  processed (<B>if</B>-PREFIX-<B>param</B> and <B>if</B>-PREFIX-<B>modifier</B> are functionally identical except for parse order)
<LI>PREFIX-<B>increment</B>  processed
<LI>PREFIX-<B>accessories</B>  processed
<LI>PREFIX-<B>options</B>  processed
<LI>PREFIX-<B>sku</B>  processed
<LI>PREFIX-<B>code</B>  processed
<LI>PREFIX-<B>quantity</B>  processed
<LI>PREFIX-<B>modifier</B>  processed
<LI>PREFIX-<B>param</B>  processed
<LI>PREFIX-<B>quantity-name</B>  processed
<LI>PREFIX-<B>modifier-name</B>  processed
<LI>PREFIX-<B>subtotal</B>  processed
<LI>PREFIX-<B>discount-subtotal</B>  processed
<LI>PREFIX-<B>code</B>  processed again differently (operating on new instances of PREFIX-<B>code</B> in output of above?)
<LI>PREFIX-<B>field</B>  processed
<LI>PREFIX-<B>description</B>  processed
<LI>PREFIX-<B>price</B>  processed
<LI>PREFIX-<B>discount-price</B>  processed
<LI>PREFIX-<B>difference</B>  processed
<LI>PREFIX-<B>discount</B>  processed
<LI>PREFIX-<B>change</B>  processed
<LI>PREFIX-<B>tag</B>  processed (*** CHECK THIS TAG NAME ***)
<LI>PREFIX-<B>calc</B>  processed
<LI>PREFIX-<B>exec</B>  processed
<LI>PREFIX-<B>filter</B>  processed
<LI>PREFIX-<B>last</B>  processed
<LI>PREFIX-<B>next</B>  processed
<LI>User's previous HTML widget SELECTED settings restored
<LI>Reparse standard tags in output of above (if reparse enabled for the containing tag)</OL>
<HR>
<H1><A NAME="Search and Form Variables">B. Search and Form Variables</A></H1>
<H2><A NAME="Variable Names">B.1. Variable Names</A></H2>
<H4><A NAME="dummy_other"> </A>B.1..1. <A NAME="dummy_other">other</A></H4>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Name</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>scan</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Type</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Description</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_all_chars">mv_all_chars</A>
</TD>
<TD VALIGN='Top'>
ac
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Turns on punctuation matching
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_arg">mv_arg[0-9]+</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
A
</TD>
<TD VALIGN='Top'>
Parameters for mv_subroutine (mv_arg0,mv_arg1,...)
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_base_directory">mv_base_directory</A>
</TD>
<TD VALIGN='Top'>
bd
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Sets base directory for search file names
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_begin_string">mv_begin_string</A>
</TD>
<TD VALIGN='Top'>
bs
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Pattern must match beginning of field
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_case">mv_case</A>
</TD>
<TD VALIGN='Top'>
cs
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Turns on case sensitivity
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_cartname">mv_cartname</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
O
</TD>
<TD VALIGN='Top'>
Sets the shopping cart name
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_check">mv_check</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
A
</TD>
<TD VALIGN='Top'>
Any form, sets multiple user variables after update
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_click">mv_click</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
A
</TD>
<TD VALIGN='Top'>
Any form, sets multiple form variables before update
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_click">mv_click</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
XA
</TD>
<TD VALIGN='Top'>
Default mv_click routine, click is mv_click_arg
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_click_NAME">mv_click </A><I>name</I>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
XA
</TD>
<TD VALIGN='Top'>
Routine for a click <I>name</I>, sends click as arg
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_click_arg">mv_click_arg</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
XA
</TD>
<TD VALIGN='Top'>
Argument name in scratch space
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_coordinate">mv_coordinate</A>
</TD>
<TD VALIGN='Top'>
co
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Enables field/spec matching coordination
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_column_op">mv_column_op</A>
</TD>
<TD VALIGN='Top'>
op
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Operation for coordinated search
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_credit_card*">mv_credit_card*</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
O
</TD>
<TD VALIGN='Top'>
Discussed in order security (some are read-only)
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_dict_end">mv_dict_end</A>
</TD>
<TD VALIGN='Top'>
de
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Upper bound for binary search
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_dict_fold">mv_dict_fold</A>
</TD>
<TD VALIGN='Top'>
df
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Non-case sensitive binary search
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_dict_limit">mv_dict_limit</A>
</TD>
<TD VALIGN='Top'>
di
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Sets upper bound based on character position
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_dict_look">mv_dict_look</A>
</TD>
<TD VALIGN='Top'>
dl
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Search specification for binary search
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_dict_order">mv_dict_order</A>
</TD>
<TD VALIGN='Top'>
do
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Sets dictionary order mode
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_doit">mv_doit</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
A
</TD>
<TD VALIGN='Top'>
Sets default action
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_email">mv_email</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
O
</TD>
<TD VALIGN='Top'>
Reply-to address for orders
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_exact_match">mv_exact_match</A>
</TD>
<TD VALIGN='Top'>
em
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Sets word-matching mode
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_failpage">mv_failpage</A>
</TD>
<TD VALIGN='Top'>
fp
</TD>
<TD VALIGN='Top'>
O,S
</TD>
<TD VALIGN='Top'>
Sets page to display on failed order check/search
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_field_file">mv_field_file</A>
</TD>
<TD VALIGN='Top'>
ff
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Sets file to find field names for Glimpse
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_field_names">mv_field_names</A>
</TD>
<TD VALIGN='Top'>
fn
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Sets field names for search, starting at 1
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_first_match">mv_first_match</A>
</TD>
<TD VALIGN='Top'>
fm
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Start displaying search at specified match
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_head_skip">mv_head_skip</A>
</TD>
<TD VALIGN='Top'>
hs
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Sets skipping of header line(s) in index
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_index_delim">mv_index_delim</A>
</TD>
<TD VALIGN='Top'>
id
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Delimiter for search fields (TAB default)
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_matchlimit">mv_matchlimit</A>
</TD>
<TD VALIGN='Top'>
ml
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Sets match page size
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_max_matches">mv_max_matches</A>
</TD>
<TD VALIGN='Top'>
mm
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Sets maximum match return
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_min_string">mv_min_string</A>
</TD>
<TD VALIGN='Top'>
ms
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Sets minimum search spec size
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_negate">mv_negate</A>
</TD>
<TD VALIGN='Top'>
ne
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Records NOT matching will be found
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_nextpage">mv_nextpage</A>
</TD>
<TD VALIGN='Top'>
np
</TD>
<TD VALIGN='Top'>
A
</TD>
<TD VALIGN='Top'>
Sets next page user will go to
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_numeric">mv_numeric</A>
</TD>
<TD VALIGN='Top'>
nu
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Comparison numeric in coordinated search
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_order_group">mv_order_group</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
O
</TD>
<TD VALIGN='Top'>
Allows grouping of master item/sub item
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_order_item">mv_order_item</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
O
</TD>
<TD VALIGN='Top'>
Causes the order of an item
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_order_number">mv_order_number</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
O
</TD>
<TD VALIGN='Top'>
Order number of the last order (read-only)
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_order_quantity">mv_order_quantity</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
O
</TD>
<TD VALIGN='Top'>
Sets the quantity of an ordered item
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_order_profile">mv_order_profile</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
O
</TD>
<TD VALIGN='Top'>
Selects the order check profile
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_order_receipt">mv_order_receipt</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
O
</TD>
<TD VALIGN='Top'>
Sets the receipt displayed
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_order_report">mv_order_report</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
O
</TD>
<TD VALIGN='Top'>
Sets the order report sent
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_order_subject">mv_order_subject</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
O
</TD>
<TD VALIGN='Top'>
Sets the subject line of order email
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_orsearch">mv_orsearch</A>
</TD>
<TD VALIGN='Top'>
os
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Selects AND/OR of search words
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_profile">mv_profile</A>
</TD>
<TD VALIGN='Top'>
mp
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Selects search profile
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_record_delim">mv_record_delim</A>
</TD>
<TD VALIGN='Top'>
dr
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Search index record delimiter
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_return_all">mv_return_all</A>
</TD>
<TD VALIGN='Top'>
ra
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Return all lines found (subject to range search)
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_return_delim">mv_return_delim</A>
</TD>
<TD VALIGN='Top'>
rd
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Return record delimiter
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_return_fields">mv_return_fields</A>
</TD>
<TD VALIGN='Top'>
rf
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Fields to return on a search
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_return_file_name">mv_return_file_name</A>
</TD>
<TD VALIGN='Top'>
rn
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Set return of file name for searches
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_return_spec">mv_return_spec</A>
</TD>
<TD VALIGN='Top'>
rs
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Return the search string as the only result
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_save_session">mv_save_session</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
C
</TD>
<TD VALIGN='Top'>
Set to non-zero to prevent expiration of user session
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_search_field">mv_search_field</A>
</TD>
<TD VALIGN='Top'>
sf
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Sets the fields to be searched
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_search_file">mv_search_file</A>
</TD>
<TD VALIGN='Top'>
fi
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Sets the file(s) to be searched
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_search_line_return">mv_search_line_return</A>
</TD>
<TD VALIGN='Top'>
lr
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Each line is a return code (loop search)
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_search_match_count">mv_search_match_count</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Returns the number of matches found (read-only)
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_search_page">mv_search_page</A>
</TD>
<TD VALIGN='Top'>
sp
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Sets the page for search display
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_searchspec">mv_searchspec</A>
</TD>
<TD VALIGN='Top'>
se
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Search specification
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_searchtype">mv_searchtype</A>
</TD>
<TD VALIGN='Top'>
st
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Sets search type (text, glimpse, db or sql)
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_separate_items">mv_separate_items</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
O
</TD>
<TD VALIGN='Top'>
Sets separate order lines (one per item ordered)
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_session_id">mv_session_id</A>
</TD>
<TD VALIGN='Top'>
id
</TD>
<TD VALIGN='Top'>
A
</TD>
<TD VALIGN='Top'>
Suggests user session id (overridden by cookie)
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_shipmode">mv_shipmode</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
O
</TD>
<TD VALIGN='Top'>
Sets shipping mode for custom shipping
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_sort_field">mv_sort_field</A>
</TD>
<TD VALIGN='Top'>
tf
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Field(s) to sort on
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_sort_option">mv_sort_option</A>
</TD>
<TD VALIGN='Top'>
to
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Options for sort
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_spelling_errors">mv_spelling_errors</A>
</TD>
<TD VALIGN='Top'>
er
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Number of spelling errors for Glimpse
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_substring_match">mv_substring_match</A>
</TD>
<TD VALIGN='Top'>
su
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Turns off word-matching mode
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_successpage">mv_successpage</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
O
</TD>
<TD VALIGN='Top'>
Page to display on successful order check
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_todo">mv_todo</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
A
</TD>
<TD VALIGN='Top'>
Common to all forms, sets form action
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_todo.map">mv_todo.map</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
A
</TD>
<TD VALIGN='Top'>
Contains form imagemap
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_todo.checkout.x">mv_todo.checkout.x</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
O
</TD>
<TD VALIGN='Top'>
Causes checkout action on click of image
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_todo.return.x">mv_todo.return.x</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
O
</TD>
<TD VALIGN='Top'>
Causes return action on click of image
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_todo.submit.x">mv_todo.submit.x</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
O
</TD>
<TD VALIGN='Top'>
Causes submit action on click of image
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_todo.x">mv_todo.x</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
A
</TD>
<TD VALIGN='Top'>
Set by form imagemap
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_todo.y">mv_todo.y</A>
</TD>
<TD VALIGN='Top'>
&nbsp;
</TD>
<TD VALIGN='Top'>
A
</TD>
<TD VALIGN='Top'>
Set by form imagemap
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_unique">mv_unique</A>
</TD>
<TD VALIGN='Top'>
un
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Return unique search results only
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
<A NAME="mv_value">mv_value</A>
</TD>
<TD VALIGN='Top'>
va
</TD>
<TD VALIGN='Top'>
S
</TD>
<TD VALIGN='Top'>
Sets value on one-click search (va=var=value)
</TD>
</TR>
</TABLE>

<H2><A NAME="Abbreviations">B.2. Abbreviations</A></H2>
<P>The two-letter abbreviations are mapped with these letters:</P>
<TABLE CLASS="columns" BORDER>
<TR CLASS="heading">
<TD VALIGN='Top'>
<STRONG>Abbr</STRONG>
</TD>
<TD VALIGN='Top'>
<STRONG>Long name</STRONG>
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
DL
</TD>
<TD VALIGN='Top'>
mv_raw_dict_look
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
MM
</TD>
<TD VALIGN='Top'>
mv_more_matches
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
ac
</TD>
<TD VALIGN='Top'>
mv_all_chars
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
ar
</TD>
<TD VALIGN='Top'>
mv_arg
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
bd
</TD>
<TD VALIGN='Top'>
mv_base_directory
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
bs
</TD>
<TD VALIGN='Top'>
mv_begin_string
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
ck
</TD>
<TD VALIGN='Top'>
mv_cache_key
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
co
</TD>
<TD VALIGN='Top'>
mv_coordinate
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
cs
</TD>
<TD VALIGN='Top'>
mv_case
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
cv
</TD>
<TD VALIGN='Top'>
mv_verbatim_columns
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
de
</TD>
<TD VALIGN='Top'>
mv_dict_end
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
df
</TD>
<TD VALIGN='Top'>
mv_dict_fold
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
di
</TD>
<TD VALIGN='Top'>
mv_dict_limit
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
dl
</TD>
<TD VALIGN='Top'>
mv_dict_look
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
do
</TD>
<TD VALIGN='Top'>
mv_dict_order
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
dr
</TD>
<TD VALIGN='Top'>
mv_record_delim
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
em
</TD>
<TD VALIGN='Top'>
mv_exact_match
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
er
</TD>
<TD VALIGN='Top'>
mv_spelling_errors
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
fi
</TD>
<TD VALIGN='Top'>
mv_search_file
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
fm
</TD>
<TD VALIGN='Top'>
mv_first_match
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
fn
</TD>
<TD VALIGN='Top'>
mv_field_names
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
hs
</TD>
<TD VALIGN='Top'>
mv_head_skip
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
id
</TD>
<TD VALIGN='Top'>
mv_session_id
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
il
</TD>
<TD VALIGN='Top'>
mv_index_delim
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
ix
</TD>
<TD VALIGN='Top'>
mv_index_delim
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
lb
</TD>
<TD VALIGN='Top'>
mv_search_label
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
lo
</TD>
<TD VALIGN='Top'>
mv_list_only
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
lr
</TD>
<TD VALIGN='Top'>
mv_line_return
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
lr
</TD>
<TD VALIGN='Top'>
mv_search_line_return
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
ml
</TD>
<TD VALIGN='Top'>
mv_matchlimit
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
mm
</TD>
<TD VALIGN='Top'>
mv_max_matches
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
mp
</TD>
<TD VALIGN='Top'>
mv_profile
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
ms
</TD>
<TD VALIGN='Top'>
mv_min_string
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
ne
</TD>
<TD VALIGN='Top'>
mv_negate
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
np
</TD>
<TD VALIGN='Top'>
mv_nextpage
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
nu
</TD>
<TD VALIGN='Top'>
mv_numeric
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
op
</TD>
<TD VALIGN='Top'>
mv_column_op
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
os
</TD>
<TD VALIGN='Top'>
mv_orsearch
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
pc
</TD>
<TD VALIGN='Top'>
mv_pc
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
ra
</TD>
<TD VALIGN='Top'>
mv_return_all
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
rd
</TD>
<TD VALIGN='Top'>
mv_return_delim
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
rf
</TD>
<TD VALIGN='Top'>
mv_return_fields
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
rn
</TD>
<TD VALIGN='Top'>
mv_return_file_name
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
rr
</TD>
<TD VALIGN='Top'>
mv_return_reference
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
rs
</TD>
<TD VALIGN='Top'>
mv_return_spec
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
se
</TD>
<TD VALIGN='Top'>
mv_searchspec
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
sf
</TD>
<TD VALIGN='Top'>
mv_search_field
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
si
</TD>
<TD VALIGN='Top'>
mv_search_immediate
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
sp
</TD>
<TD VALIGN='Top'>
mv_search_page
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
sq
</TD>
<TD VALIGN='Top'>
mv_sql_query
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
st
</TD>
<TD VALIGN='Top'>
mv_searchtype
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
su
</TD>
<TD VALIGN='Top'>
mv_substring_match
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
tf
</TD>
<TD VALIGN='Top'>
mv_sort_field
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
to
</TD>
<TD VALIGN='Top'>
mv_sort_option
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
un
</TD>
<TD VALIGN='Top'>
mv_unique
</TD>
</TR>
<TR>
<TD VALIGN='Top'>
va
</TD>
<TD VALIGN='Top'>
mv_value
</TD>
</TR>
</TABLE>

<HR>
<P>Copyright 2001-2002 Red Hat, Inc. Freely redistributable under terms of the GNU General Public License.</P>
</DIV>
<DIV CLASS="footer">
<DIV CLASS="navigate">
<P ALIGN="Center"><A HREF="index.html" TARGET="_top">Documentation Index</A></P>
</DIV>
<HR>
<ADDRESS><SPAN CLASS="doc-id">ictags-1.97</SPAN> <SPAN CLASS="doc-status">(Draft)</SPAN></ADDRESS>
<ADDRESS CLASS="doc-modified">11 August 2002</ADDRESS>
<ADDRESS CLASS="copyright">Copyright &copy;  1996-2002 Red Hat, Inc. <A HREF="mailto:interchange@redhat.com">interchange@redhat.com</A></ADDRESS>
</DIV>

</BODY>
</HTML>
